var Wc=Object.defineProperty;var qc=(e,t,n)=>t in e?Wc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var re=(e,t,n)=>(qc(e,typeof t!="symbol"?t+"":t,n),n);import{r as A,g as bi,R as Kc,j as b}from"./index-6bf6637b.js";const Uc=(e,t=500)=>{const[n,r]=A.useState(e);return A.useEffect(()=>{const o=setTimeout(()=>{r(e)},t);return()=>{clearTimeout(o)}},[e,t]),n};function ie(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=ie(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var Zc={value:()=>{}};function St(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Xt(n)}function Xt(e){this._=e}function Qc(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Xt.prototype=St.prototype={constructor:Xt,on:function(e,t){var n=this._,r=Qc(e+"",n),o,i=-1,s=r.length;if(arguments.length<2){for(;++i<s;)if((o=(e=r[i]).type)&&(o=Jc(n[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<s;)if(o=(e=r[i]).type)n[o]=Fr(n[o],e.name,t);else if(t==null)for(o in n)n[o]=Fr(n[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Xt(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var n=new Array(o),r=0,o,i;r<o;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],r=0,o=i.length;r<o;++r)i[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,i=r.length;o<i;++o)r[o].value.apply(t,n)}};function Jc(e,t){for(var n=0,r=e.length,o;n<r;++n)if((o=e[n]).name===t)return o.value}function Fr(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=Zc,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Kn="http://www.w3.org/1999/xhtml";const Yr={svg:"http://www.w3.org/2000/svg",xhtml:Kn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function cn(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Yr.hasOwnProperty(t)?{space:Yr[t],local:e}:e}function el(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Kn&&t.documentElement.namespaceURI===Kn?t.createElement(e):t.createElementNS(n,e)}}function tl(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Ei(e){var t=cn(e);return(t.local?tl:el)(t)}function nl(){}function pr(e){return e==null?nl:function(){return this.querySelector(e)}}function rl(e){typeof e!="function"&&(e=pr(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=new Array(s),c,l,u=0;u<s;++u)(c=i[u])&&(l=e.call(c,c.__data__,u,i))&&("__data__"in c&&(l.__data__=c.__data__),a[u]=l);return new de(r,this._parents)}function ol(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function il(){return[]}function _i(e){return e==null?il:function(){return this.querySelectorAll(e)}}function sl(e){return function(){return ol(e.apply(this,arguments))}}function al(e){typeof e=="function"?e=sl(e):e=_i(e);for(var t=this._groups,n=t.length,r=[],o=[],i=0;i<n;++i)for(var s=t[i],a=s.length,c,l=0;l<a;++l)(c=s[l])&&(r.push(e.call(c,c.__data__,l,s)),o.push(c));return new de(r,o)}function Ni(e){return function(){return this.matches(e)}}function Ci(e){return function(t){return t.matches(e)}}var cl=Array.prototype.find;function ll(e){return function(){return cl.call(this.children,e)}}function ul(){return this.firstElementChild}function dl(e){return this.select(e==null?ul:ll(typeof e=="function"?e:Ci(e)))}var fl=Array.prototype.filter;function hl(){return Array.from(this.children)}function gl(e){return function(){return fl.call(this.children,e)}}function pl(e){return this.selectAll(e==null?hl:gl(typeof e=="function"?e:Ci(e)))}function ml(e){typeof e!="function"&&(e=Ni(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=[],c,l=0;l<s;++l)(c=i[l])&&e.call(c,c.__data__,l,i)&&a.push(c);return new de(r,this._parents)}function Si(e){return new Array(e.length)}function yl(){return new de(this._enter||this._groups.map(Si),this._parents)}function Kt(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Kt.prototype={constructor:Kt,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function xl(e){return function(){return e}}function wl(e,t,n,r,o,i){for(var s=0,a,c=t.length,l=i.length;s<l;++s)(a=t[s])?(a.__data__=i[s],r[s]=a):n[s]=new Kt(e,i[s]);for(;s<c;++s)(a=t[s])&&(o[s]=a)}function vl(e,t,n,r,o,i,s){var a,c,l=new Map,u=t.length,d=i.length,f=new Array(u),h;for(a=0;a<u;++a)(c=t[a])&&(f[a]=h=s.call(c,c.__data__,a,t)+"",l.has(h)?o[a]=c:l.set(h,c));for(a=0;a<d;++a)h=s.call(e,i[a],a,i)+"",(c=l.get(h))?(r[a]=c,c.__data__=i[a],l.delete(h)):n[a]=new Kt(e,i[a]);for(a=0;a<u;++a)(c=t[a])&&l.get(f[a])===c&&(o[a]=c)}function bl(e){return e.__data__}function El(e,t){if(!arguments.length)return Array.from(this,bl);var n=t?vl:wl,r=this._parents,o=this._groups;typeof e!="function"&&(e=xl(e));for(var i=o.length,s=new Array(i),a=new Array(i),c=new Array(i),l=0;l<i;++l){var u=r[l],d=o[l],f=d.length,h=_l(e.call(u,u&&u.__data__,l,r)),g=h.length,p=a[l]=new Array(g),y=s[l]=new Array(g),m=c[l]=new Array(f);n(u,d,p,y,m,h,t);for(var E=0,x=0,w,C;E<g;++E)if(w=p[E]){for(E>=x&&(x=E+1);!(C=y[x])&&++x<g;);w._next=C||null}}return s=new de(s,r),s._enter=a,s._exit=c,s}function _l(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Nl(){return new de(this._exit||this._groups.map(Si),this._parents)}function Cl(e,t,n){var r=this.enter(),o=this,i=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),n==null?i.remove():n(i),r&&o?r.merge(o).order():o}function Sl(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,i=r.length,s=Math.min(o,i),a=new Array(o),c=0;c<s;++c)for(var l=n[c],u=r[c],d=l.length,f=a[c]=new Array(d),h,g=0;g<d;++g)(h=l[g]||u[g])&&(f[g]=h);for(;c<o;++c)a[c]=n[c];return new de(a,this._parents)}function kl(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],o=r.length-1,i=r[o],s;--o>=0;)(s=r[o])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function Ml(e){e||(e=Il);function t(d,f){return d&&f?e(d.__data__,f.__data__):!d-!f}for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var s=n[i],a=s.length,c=o[i]=new Array(a),l,u=0;u<a;++u)(l=s[u])&&(c[u]=l);c.sort(t)}return new de(o,this._parents).order()}function Il(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function $l(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Al(){return Array.from(this)}function Pl(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length;o<i;++o){var s=r[o];if(s)return s}return null}function Tl(){let e=0;for(const t of this)++e;return e}function Ol(){return!this.node()}function jl(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o=t[n],i=0,s=o.length,a;i<s;++i)(a=o[i])&&e.call(a,a.__data__,i,o);return this}function Ll(e){return function(){this.removeAttribute(e)}}function Rl(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Dl(e,t){return function(){this.setAttribute(e,t)}}function zl(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Bl(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Hl(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Vl(e,t){var n=cn(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?Rl:Ll:typeof t=="function"?n.local?Hl:Bl:n.local?zl:Dl)(n,t))}function ki(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Fl(e){return function(){this.style.removeProperty(e)}}function Yl(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Xl(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Gl(e,t,n){return arguments.length>1?this.each((t==null?Fl:typeof t=="function"?Xl:Yl)(e,t,n??"")):Ue(this.node(),e)}function Ue(e,t){return e.style.getPropertyValue(t)||ki(e).getComputedStyle(e,null).getPropertyValue(t)}function Wl(e){return function(){delete this[e]}}function ql(e,t){return function(){this[e]=t}}function Kl(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Ul(e,t){return arguments.length>1?this.each((t==null?Wl:typeof t=="function"?Kl:ql)(e,t)):this.node()[e]}function Mi(e){return e.trim().split(/^|\s+/)}function mr(e){return e.classList||new Ii(e)}function Ii(e){this._node=e,this._names=Mi(e.getAttribute("class")||"")}Ii.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function $i(e,t){for(var n=mr(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function Ai(e,t){for(var n=mr(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function Zl(e){return function(){$i(this,e)}}function Ql(e){return function(){Ai(this,e)}}function Jl(e,t){return function(){(t.apply(this,arguments)?$i:Ai)(this,e)}}function eu(e,t){var n=Mi(e+"");if(arguments.length<2){for(var r=mr(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof t=="function"?Jl:t?Zl:Ql)(n,t))}function tu(){this.textContent=""}function nu(e){return function(){this.textContent=e}}function ru(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function ou(e){return arguments.length?this.each(e==null?tu:(typeof e=="function"?ru:nu)(e)):this.node().textContent}function iu(){this.innerHTML=""}function su(e){return function(){this.innerHTML=e}}function au(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function cu(e){return arguments.length?this.each(e==null?iu:(typeof e=="function"?au:su)(e)):this.node().innerHTML}function lu(){this.nextSibling&&this.parentNode.appendChild(this)}function uu(){return this.each(lu)}function du(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function fu(){return this.each(du)}function hu(e){var t=typeof e=="function"?e:Ei(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function gu(){return null}function pu(e,t){var n=typeof e=="function"?e:Ei(e),r=t==null?gu:typeof t=="function"?t:pr(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function mu(){var e=this.parentNode;e&&e.removeChild(this)}function yu(){return this.each(mu)}function xu(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function wu(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function vu(e){return this.select(e?wu:xu)}function bu(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Eu(e){return function(t){e.call(this,t,this.__data__)}}function _u(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Nu(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,o=t.length,i;n<o;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++r]=i;++r?t.length=r:delete this.__on}}}function Cu(e,t,n){return function(){var r=this.__on,o,i=Eu(t);if(r){for(var s=0,a=r.length;s<a;++s)if((o=r[s]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=i,o.options=n),o.value=t;return}}this.addEventListener(e.type,i,n),o={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(o):this.__on=[o]}}function Su(e,t,n){var r=_u(e+""),o,i=r.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,l=a.length,u;c<l;++c)for(o=0,u=a[c];o<i;++o)if((s=r[o]).type===u.type&&s.name===u.name)return u.value}return}for(a=t?Cu:Nu,o=0;o<i;++o)this.each(a(r[o],t,n));return this}function Pi(e,t,n){var r=ki(e),o=r.CustomEvent;typeof o=="function"?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function ku(e,t){return function(){return Pi(this,e,t)}}function Mu(e,t){return function(){return Pi(this,e,t.apply(this,arguments))}}function Iu(e,t){return this.each((typeof t=="function"?Mu:ku)(e,t))}function*$u(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length,s;o<i;++o)(s=r[o])&&(yield s)}var Ti=[null];function de(e,t){this._groups=e,this._parents=t}function kt(){return new de([[document.documentElement]],Ti)}function Au(){return this}de.prototype=kt.prototype={constructor:de,select:rl,selectAll:al,selectChild:dl,selectChildren:pl,filter:ml,data:El,enter:yl,exit:Nl,join:Cl,merge:Sl,selection:Au,order:kl,sort:Ml,call:$l,nodes:Al,node:Pl,size:Tl,empty:Ol,each:jl,attr:Vl,style:Gl,property:Ul,classed:eu,text:ou,html:cu,raise:uu,lower:fu,append:hu,insert:pu,remove:yu,clone:vu,datum:bu,on:Su,dispatch:Iu,[Symbol.iterator]:$u};function ue(e){return typeof e=="string"?new de([[document.querySelector(e)]],[document.documentElement]):new de([[e]],Ti)}function Pu(e){let t;for(;t=e.sourceEvent;)e=t;return e}function ge(e,t){if(e=Pu(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const Tu={passive:!1},mt={capture:!0,passive:!1};function Pn(e){e.stopImmediatePropagation()}function qe(e){e.preventDefault(),e.stopImmediatePropagation()}function Oi(e){var t=e.document.documentElement,n=ue(e).on("dragstart.drag",qe,mt);"onselectstart"in t?n.on("selectstart.drag",qe,mt):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function ji(e,t){var n=e.document.documentElement,r=ue(e).on("dragstart.drag",null);t&&(r.on("click.drag",qe,mt),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Ot=e=>()=>e;function Un(e,{sourceEvent:t,subject:n,target:r,identifier:o,active:i,x:s,y:a,dx:c,dy:l,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:u}})}Un.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Ou(e){return!e.ctrlKey&&!e.button}function ju(){return this.parentNode}function Lu(e,t){return t??{x:e.x,y:e.y}}function Ru(){return navigator.maxTouchPoints||"ontouchstart"in this}function Li(){var e=Ou,t=ju,n=Lu,r=Ru,o={},i=St("start","drag","end"),s=0,a,c,l,u,d=0;function f(w){w.on("mousedown.drag",h).filter(r).on("touchstart.drag",y).on("touchmove.drag",m,Tu).on("touchend.drag touchcancel.drag",E).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(w,C){if(!(u||!e.call(this,w,C))){var I=x(this,t.call(this,w,C),w,C,"mouse");I&&(ue(w.view).on("mousemove.drag",g,mt).on("mouseup.drag",p,mt),Oi(w.view),Pn(w),l=!1,a=w.clientX,c=w.clientY,I("start",w))}}function g(w){if(qe(w),!l){var C=w.clientX-a,I=w.clientY-c;l=C*C+I*I>d}o.mouse("drag",w)}function p(w){ue(w.view).on("mousemove.drag mouseup.drag",null),ji(w.view,l),qe(w),o.mouse("end",w)}function y(w,C){if(e.call(this,w,C)){var I=w.changedTouches,N=t.call(this,w,C),T=I.length,O,j;for(O=0;O<T;++O)(j=x(this,N,w,C,I[O].identifier,I[O]))&&(Pn(w),j("start",w,I[O]))}}function m(w){var C=w.changedTouches,I=C.length,N,T;for(N=0;N<I;++N)(T=o[C[N].identifier])&&(qe(w),T("drag",w,C[N]))}function E(w){var C=w.changedTouches,I=C.length,N,T;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),N=0;N<I;++N)(T=o[C[N].identifier])&&(Pn(w),T("end",w,C[N]))}function x(w,C,I,N,T,O){var j=i.copy(),z=ge(O||I,C),R,L,v;if((v=n.call(w,new Un("beforestart",{sourceEvent:I,target:f,identifier:T,active:s,x:z[0],y:z[1],dx:0,dy:0,dispatch:j}),N))!=null)return R=v.x-z[0]||0,L=v.y-z[1]||0,function S(_,P,k){var $=z,M;switch(_){case"start":o[T]=S,M=s++;break;case"end":delete o[T],--s;case"drag":z=ge(k||P,C),M=s;break}j.call(_,w,new Un(_,{sourceEvent:P,subject:v,target:f,identifier:T,active:M,x:z[0]+R,y:z[1]+L,dx:z[0]-$[0],dy:z[1]-$[1],dispatch:j}),N)}}return f.filter=function(w){return arguments.length?(e=typeof w=="function"?w:Ot(!!w),f):e},f.container=function(w){return arguments.length?(t=typeof w=="function"?w:Ot(w),f):t},f.subject=function(w){return arguments.length?(n=typeof w=="function"?w:Ot(w),f):n},f.touchable=function(w){return arguments.length?(r=typeof w=="function"?w:Ot(!!w),f):r},f.on=function(){var w=i.on.apply(i,arguments);return w===i?f:w},f.clickDistance=function(w){return arguments.length?(d=(w=+w)*w,f):Math.sqrt(d)},f}function yr(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Ri(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Mt(){}var yt=.7,Ut=1/yt,Ke="\\s*([+-]?\\d+)\\s*",xt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ve="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Du=/^#([0-9a-f]{3,8})$/,zu=new RegExp(`^rgb\\(${Ke},${Ke},${Ke}\\)$`),Bu=new RegExp(`^rgb\\(${ve},${ve},${ve}\\)$`),Hu=new RegExp(`^rgba\\(${Ke},${Ke},${Ke},${xt}\\)$`),Vu=new RegExp(`^rgba\\(${ve},${ve},${ve},${xt}\\)$`),Fu=new RegExp(`^hsl\\(${xt},${ve},${ve}\\)$`),Yu=new RegExp(`^hsla\\(${xt},${ve},${ve},${xt}\\)$`),Xr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};yr(Mt,wt,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Gr,formatHex:Gr,formatHex8:Xu,formatHsl:Gu,formatRgb:Wr,toString:Wr});function Gr(){return this.rgb().formatHex()}function Xu(){return this.rgb().formatHex8()}function Gu(){return Di(this).formatHsl()}function Wr(){return this.rgb().formatRgb()}function wt(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Du.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?qr(t):n===3?new le(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?jt(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?jt(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=zu.exec(e))?new le(t[1],t[2],t[3],1):(t=Bu.exec(e))?new le(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Hu.exec(e))?jt(t[1],t[2],t[3],t[4]):(t=Vu.exec(e))?jt(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Fu.exec(e))?Zr(t[1],t[2]/100,t[3]/100,1):(t=Yu.exec(e))?Zr(t[1],t[2]/100,t[3]/100,t[4]):Xr.hasOwnProperty(e)?qr(Xr[e]):e==="transparent"?new le(NaN,NaN,NaN,0):null}function qr(e){return new le(e>>16&255,e>>8&255,e&255,1)}function jt(e,t,n,r){return r<=0&&(e=t=n=NaN),new le(e,t,n,r)}function Wu(e){return e instanceof Mt||(e=wt(e)),e?(e=e.rgb(),new le(e.r,e.g,e.b,e.opacity)):new le}function Zn(e,t,n,r){return arguments.length===1?Wu(e):new le(e,t,n,r??1)}function le(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}yr(le,Zn,Ri(Mt,{brighter(e){return e=e==null?Ut:Math.pow(Ut,e),new le(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?yt:Math.pow(yt,e),new le(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new le(ze(this.r),ze(this.g),ze(this.b),Zt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Kr,formatHex:Kr,formatHex8:qu,formatRgb:Ur,toString:Ur}));function Kr(){return`#${De(this.r)}${De(this.g)}${De(this.b)}`}function qu(){return`#${De(this.r)}${De(this.g)}${De(this.b)}${De((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ur(){const e=Zt(this.opacity);return`${e===1?"rgb(":"rgba("}${ze(this.r)}, ${ze(this.g)}, ${ze(this.b)}${e===1?")":`, ${e})`}`}function Zt(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ze(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function De(e){return e=ze(e),(e<16?"0":"")+e.toString(16)}function Zr(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new pe(e,t,n,r)}function Di(e){if(e instanceof pe)return new pe(e.h,e.s,e.l,e.opacity);if(e instanceof Mt||(e=wt(e)),!e)return new pe;if(e instanceof pe)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),i=Math.max(t,n,r),s=NaN,a=i-o,c=(i+o)/2;return a?(t===i?s=(n-r)/a+(n<r)*6:n===i?s=(r-t)/a+2:s=(t-n)/a+4,a/=c<.5?i+o:2-i-o,s*=60):a=c>0&&c<1?0:s,new pe(s,a,c,e.opacity)}function Ku(e,t,n,r){return arguments.length===1?Di(e):new pe(e,t,n,r??1)}function pe(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}yr(pe,Ku,Ri(Mt,{brighter(e){return e=e==null?Ut:Math.pow(Ut,e),new pe(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?yt:Math.pow(yt,e),new pe(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new le(Tn(e>=240?e-240:e+120,o,r),Tn(e,o,r),Tn(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new pe(Qr(this.h),Lt(this.s),Lt(this.l),Zt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Zt(this.opacity);return`${e===1?"hsl(":"hsla("}${Qr(this.h)}, ${Lt(this.s)*100}%, ${Lt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Qr(e){return e=(e||0)%360,e<0?e+360:e}function Lt(e){return Math.max(0,Math.min(1,e||0))}function Tn(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const zi=e=>()=>e;function Uu(e,t){return function(n){return e+n*t}}function Zu(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Qu(e){return(e=+e)==1?Bi:function(t,n){return n-t?Zu(t,n,e):zi(isNaN(t)?n:t)}}function Bi(e,t){var n=t-e;return n?Uu(e,n):zi(isNaN(e)?t:e)}const Jr=function e(t){var n=Qu(t);function r(o,i){var s=n((o=Zn(o)).r,(i=Zn(i)).r),a=n(o.g,i.g),c=n(o.b,i.b),l=Bi(o.opacity,i.opacity);return function(u){return o.r=s(u),o.g=a(u),o.b=c(u),o.opacity=l(u),o+""}}return r.gamma=e,r}(1);function Ae(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Qn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,On=new RegExp(Qn.source,"g");function Ju(e){return function(){return e}}function ed(e){return function(t){return e(t)+""}}function td(e,t){var n=Qn.lastIndex=On.lastIndex=0,r,o,i,s=-1,a=[],c=[];for(e=e+"",t=t+"";(r=Qn.exec(e))&&(o=On.exec(t));)(i=o.index)>n&&(i=t.slice(n,i),a[s]?a[s]+=i:a[++s]=i),(r=r[0])===(o=o[0])?a[s]?a[s]+=o:a[++s]=o:(a[++s]=null,c.push({i:s,x:Ae(r,o)})),n=On.lastIndex;return n<t.length&&(i=t.slice(n),a[s]?a[s]+=i:a[++s]=i),a.length<2?c[0]?ed(c[0].x):Ju(t):(t=c.length,function(l){for(var u=0,d;u<t;++u)a[(d=c[u]).i]=d.x(l);return a.join("")})}var eo=180/Math.PI,Jn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Hi(e,t,n,r,o,i){var s,a,c;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,c/=a),e*r<t*n&&(e=-e,t=-t,c=-c,s=-s),{translateX:o,translateY:i,rotate:Math.atan2(t,e)*eo,skewX:Math.atan(c)*eo,scaleX:s,scaleY:a}}var Rt;function nd(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Jn:Hi(t.a,t.b,t.c,t.d,t.e,t.f)}function rd(e){return e==null||(Rt||(Rt=document.createElementNS("http://www.w3.org/2000/svg","g")),Rt.setAttribute("transform",e),!(e=Rt.transform.baseVal.consolidate()))?Jn:(e=e.matrix,Hi(e.a,e.b,e.c,e.d,e.e,e.f))}function Vi(e,t,n,r){function o(l){return l.length?l.pop()+" ":""}function i(l,u,d,f,h,g){if(l!==d||u!==f){var p=h.push("translate(",null,t,null,n);g.push({i:p-4,x:Ae(l,d)},{i:p-2,x:Ae(u,f)})}else(d||f)&&h.push("translate("+d+t+f+n)}function s(l,u,d,f){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),f.push({i:d.push(o(d)+"rotate(",null,r)-2,x:Ae(l,u)})):u&&d.push(o(d)+"rotate("+u+r)}function a(l,u,d,f){l!==u?f.push({i:d.push(o(d)+"skewX(",null,r)-2,x:Ae(l,u)}):u&&d.push(o(d)+"skewX("+u+r)}function c(l,u,d,f,h,g){if(l!==d||u!==f){var p=h.push(o(h)+"scale(",null,",",null,")");g.push({i:p-4,x:Ae(l,d)},{i:p-2,x:Ae(u,f)})}else(d!==1||f!==1)&&h.push(o(h)+"scale("+d+","+f+")")}return function(l,u){var d=[],f=[];return l=e(l),u=e(u),i(l.translateX,l.translateY,u.translateX,u.translateY,d,f),s(l.rotate,u.rotate,d,f),a(l.skewX,u.skewX,d,f),c(l.scaleX,l.scaleY,u.scaleX,u.scaleY,d,f),l=u=null,function(h){for(var g=-1,p=f.length,y;++g<p;)d[(y=f[g]).i]=y.x(h);return d.join("")}}}var od=Vi(nd,"px, ","px)","deg)"),id=Vi(rd,", ",")",")"),sd=1e-12;function to(e){return((e=Math.exp(e))+1/e)/2}function ad(e){return((e=Math.exp(e))-1/e)/2}function cd(e){return((e=Math.exp(2*e))-1)/(e+1)}const ld=function e(t,n,r){function o(i,s){var a=i[0],c=i[1],l=i[2],u=s[0],d=s[1],f=s[2],h=u-a,g=d-c,p=h*h+g*g,y,m;if(p<sd)m=Math.log(f/l)/t,y=function(N){return[a+N*h,c+N*g,l*Math.exp(t*N*m)]};else{var E=Math.sqrt(p),x=(f*f-l*l+r*p)/(2*l*n*E),w=(f*f-l*l-r*p)/(2*f*n*E),C=Math.log(Math.sqrt(x*x+1)-x),I=Math.log(Math.sqrt(w*w+1)-w);m=(I-C)/t,y=function(N){var T=N*m,O=to(C),j=l/(n*E)*(O*cd(t*T+C)-ad(C));return[a+j*h,c+j*g,l*O/to(t*T+C)]}}return y.duration=m*1e3*t/Math.SQRT2,y}return o.rho=function(i){var s=Math.max(.001,+i),a=s*s,c=a*a;return e(s,a,c)},o}(Math.SQRT2,2,4);var Ze=0,dt=0,lt=0,Fi=1e3,Qt,ft,Jt=0,He=0,ln=0,vt=typeof performance=="object"&&performance.now?performance:Date,Yi=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function xr(){return He||(Yi(ud),He=vt.now()+ln)}function ud(){He=0}function en(){this._call=this._time=this._next=null}en.prototype=wr.prototype={constructor:en,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?xr():+n)+(t==null?0:+t),!this._next&&ft!==this&&(ft?ft._next=this:Qt=this,ft=this),this._call=e,this._time=n,er()},stop:function(){this._call&&(this._call=null,this._time=1/0,er())}};function wr(e,t,n){var r=new en;return r.restart(e,t,n),r}function dd(){xr(),++Ze;for(var e=Qt,t;e;)(t=He-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ze}function no(){He=(Jt=vt.now())+ln,Ze=dt=0;try{dd()}finally{Ze=0,hd(),He=0}}function fd(){var e=vt.now(),t=e-Jt;t>Fi&&(ln-=t,Jt=e)}function hd(){for(var e,t=Qt,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Qt=n);ft=e,er(r)}function er(e){if(!Ze){dt&&(dt=clearTimeout(dt));var t=e-He;t>24?(e<1/0&&(dt=setTimeout(no,e-vt.now()-ln)),lt&&(lt=clearInterval(lt))):(lt||(Jt=vt.now(),lt=setInterval(fd,Fi)),Ze=1,Yi(no))}}function ro(e,t,n){var r=new en;return t=t==null?0:+t,r.restart(o=>{r.stop(),e(o+t)},t,n),r}var gd=St("start","end","cancel","interrupt"),pd=[],Xi=0,oo=1,tr=2,Gt=3,io=4,nr=5,Wt=6;function un(e,t,n,r,o,i){var s=e.__transition;if(!s)e.__transition={};else if(n in s)return;md(e,n,{name:t,index:r,group:o,on:gd,tween:pd,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:Xi})}function vr(e,t){var n=xe(e,t);if(n.state>Xi)throw new Error("too late; already scheduled");return n}function be(e,t){var n=xe(e,t);if(n.state>Gt)throw new Error("too late; already running");return n}function xe(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function md(e,t,n){var r=e.__transition,o;r[t]=n,n.timer=wr(i,0,n.time);function i(l){n.state=oo,n.timer.restart(s,n.delay,n.time),n.delay<=l&&s(l-n.delay)}function s(l){var u,d,f,h;if(n.state!==oo)return c();for(u in r)if(h=r[u],h.name===n.name){if(h.state===Gt)return ro(s);h.state===io?(h.state=Wt,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[u]):+u<t&&(h.state=Wt,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[u])}if(ro(function(){n.state===Gt&&(n.state=io,n.timer.restart(a,n.delay,n.time),a(l))}),n.state=tr,n.on.call("start",e,e.__data__,n.index,n.group),n.state===tr){for(n.state=Gt,o=new Array(f=n.tween.length),u=0,d=-1;u<f;++u)(h=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(o[++d]=h);o.length=d+1}}function a(l){for(var u=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=nr,1),d=-1,f=o.length;++d<f;)o[d].call(e,u);n.state===nr&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=Wt,n.timer.stop(),delete r[t];for(var l in r)return;delete e.__transition}}function qt(e,t){var n=e.__transition,r,o,i=!0,s;if(n){t=t==null?null:t+"";for(s in n){if((r=n[s]).name!==t){i=!1;continue}o=r.state>tr&&r.state<nr,r.state=Wt,r.timer.stop(),r.on.call(o?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[s]}i&&delete e.__transition}}function yd(e){return this.each(function(){qt(this,e)})}function xd(e,t){var n,r;return function(){var o=be(this,e),i=o.tween;if(i!==n){r=n=i;for(var s=0,a=r.length;s<a;++s)if(r[s].name===t){r=r.slice(),r.splice(s,1);break}}o.tween=r}}function wd(e,t,n){var r,o;if(typeof n!="function")throw new Error;return function(){var i=be(this,e),s=i.tween;if(s!==r){o=(r=s).slice();for(var a={name:t,value:n},c=0,l=o.length;c<l;++c)if(o[c].name===t){o[c]=a;break}c===l&&o.push(a)}i.tween=o}}function vd(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=xe(this.node(),n).tween,o=0,i=r.length,s;o<i;++o)if((s=r[o]).name===e)return s.value;return null}return this.each((t==null?xd:wd)(n,e,t))}function br(e,t,n){var r=e._id;return e.each(function(){var o=be(this,r);(o.value||(o.value={}))[t]=n.apply(this,arguments)}),function(o){return xe(o,r).value[t]}}function Gi(e,t){var n;return(typeof t=="number"?Ae:t instanceof wt?Jr:(n=wt(t))?(t=n,Jr):td)(e,t)}function bd(e){return function(){this.removeAttribute(e)}}function Ed(e){return function(){this.removeAttributeNS(e.space,e.local)}}function _d(e,t,n){var r,o=n+"",i;return function(){var s=this.getAttribute(e);return s===o?null:s===r?i:i=t(r=s,n)}}function Nd(e,t,n){var r,o=n+"",i;return function(){var s=this.getAttributeNS(e.space,e.local);return s===o?null:s===r?i:i=t(r=s,n)}}function Cd(e,t,n){var r,o,i;return function(){var s,a=n(this),c;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),c=a+"",s===c?null:s===r&&c===o?i:(o=c,i=t(r=s,a)))}}function Sd(e,t,n){var r,o,i;return function(){var s,a=n(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),c=a+"",s===c?null:s===r&&c===o?i:(o=c,i=t(r=s,a)))}}function kd(e,t){var n=cn(e),r=n==="transform"?id:Gi;return this.attrTween(e,typeof t=="function"?(n.local?Sd:Cd)(n,r,br(this,"attr."+e,t)):t==null?(n.local?Ed:bd)(n):(n.local?Nd:_d)(n,r,t))}function Md(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Id(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function $d(e,t){var n,r;function o(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&Id(e,i)),n}return o._value=t,o}function Ad(e,t){var n,r;function o(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&Md(e,i)),n}return o._value=t,o}function Pd(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=cn(e);return this.tween(n,(r.local?$d:Ad)(r,t))}function Td(e,t){return function(){vr(this,e).delay=+t.apply(this,arguments)}}function Od(e,t){return t=+t,function(){vr(this,e).delay=t}}function jd(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Td:Od)(t,e)):xe(this.node(),t).delay}function Ld(e,t){return function(){be(this,e).duration=+t.apply(this,arguments)}}function Rd(e,t){return t=+t,function(){be(this,e).duration=t}}function Dd(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Ld:Rd)(t,e)):xe(this.node(),t).duration}function zd(e,t){if(typeof t!="function")throw new Error;return function(){be(this,e).ease=t}}function Bd(e){var t=this._id;return arguments.length?this.each(zd(t,e)):xe(this.node(),t).ease}function Hd(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;be(this,e).ease=n}}function Vd(e){if(typeof e!="function")throw new Error;return this.each(Hd(this._id,e))}function Fd(e){typeof e!="function"&&(e=Ni(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=[],c,l=0;l<s;++l)(c=i[l])&&e.call(c,c.__data__,l,i)&&a.push(c);return new Se(r,this._parents,this._name,this._id)}function Yd(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,i=Math.min(r,o),s=new Array(r),a=0;a<i;++a)for(var c=t[a],l=n[a],u=c.length,d=s[a]=new Array(u),f,h=0;h<u;++h)(f=c[h]||l[h])&&(d[h]=f);for(;a<r;++a)s[a]=t[a];return new Se(s,this._parents,this._name,this._id)}function Xd(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Gd(e,t,n){var r,o,i=Xd(t)?vr:be;return function(){var s=i(this,e),a=s.on;a!==r&&(o=(r=a).copy()).on(t,n),s.on=o}}function Wd(e,t){var n=this._id;return arguments.length<2?xe(this.node(),n).on.on(e):this.each(Gd(n,e,t))}function qd(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Kd(){return this.on("end.remove",qd(this._id))}function Ud(e){var t=this._name,n=this._id;typeof e!="function"&&(e=pr(e));for(var r=this._groups,o=r.length,i=new Array(o),s=0;s<o;++s)for(var a=r[s],c=a.length,l=i[s]=new Array(c),u,d,f=0;f<c;++f)(u=a[f])&&(d=e.call(u,u.__data__,f,a))&&("__data__"in u&&(d.__data__=u.__data__),l[f]=d,un(l[f],t,n,f,l,xe(u,n)));return new Se(i,this._parents,t,n)}function Zd(e){var t=this._name,n=this._id;typeof e!="function"&&(e=_i(e));for(var r=this._groups,o=r.length,i=[],s=[],a=0;a<o;++a)for(var c=r[a],l=c.length,u,d=0;d<l;++d)if(u=c[d]){for(var f=e.call(u,u.__data__,d,c),h,g=xe(u,n),p=0,y=f.length;p<y;++p)(h=f[p])&&un(h,t,n,p,f,g);i.push(f),s.push(u)}return new Se(i,s,t,n)}var Qd=kt.prototype.constructor;function Jd(){return new Qd(this._groups,this._parents)}function ef(e,t){var n,r,o;return function(){var i=Ue(this,e),s=(this.style.removeProperty(e),Ue(this,e));return i===s?null:i===n&&s===r?o:o=t(n=i,r=s)}}function Wi(e){return function(){this.style.removeProperty(e)}}function tf(e,t,n){var r,o=n+"",i;return function(){var s=Ue(this,e);return s===o?null:s===r?i:i=t(r=s,n)}}function nf(e,t,n){var r,o,i;return function(){var s=Ue(this,e),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),Ue(this,e))),s===c?null:s===r&&c===o?i:(o=c,i=t(r=s,a))}}function rf(e,t){var n,r,o,i="style."+t,s="end."+i,a;return function(){var c=be(this,e),l=c.on,u=c.value[i]==null?a||(a=Wi(t)):void 0;(l!==n||o!==u)&&(r=(n=l).copy()).on(s,o=u),c.on=r}}function of(e,t,n){var r=(e+="")=="transform"?od:Gi;return t==null?this.styleTween(e,ef(e,r)).on("end.style."+e,Wi(e)):typeof t=="function"?this.styleTween(e,nf(e,r,br(this,"style."+e,t))).each(rf(this._id,e)):this.styleTween(e,tf(e,r,t),n).on("end.style."+e,null)}function sf(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function af(e,t,n){var r,o;function i(){var s=t.apply(this,arguments);return s!==o&&(r=(o=s)&&sf(e,s,n)),r}return i._value=t,i}function cf(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,af(e,t,n??""))}function lf(e){return function(){this.textContent=e}}function uf(e){return function(){var t=e(this);this.textContent=t??""}}function df(e){return this.tween("text",typeof e=="function"?uf(br(this,"text",e)):lf(e==null?"":e+""))}function ff(e){return function(t){this.textContent=e.call(this,t)}}function hf(e){var t,n;function r(){var o=e.apply(this,arguments);return o!==n&&(t=(n=o)&&ff(o)),t}return r._value=e,r}function gf(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,hf(e))}function pf(){for(var e=this._name,t=this._id,n=qi(),r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],a=s.length,c,l=0;l<a;++l)if(c=s[l]){var u=xe(c,t);un(c,e,n,l,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Se(r,this._parents,e,n)}function mf(){var e,t,n=this,r=n._id,o=n.size();return new Promise(function(i,s){var a={value:s},c={value:function(){--o===0&&i()}};n.each(function(){var l=be(this,r),u=l.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),l.on=t}),o===0&&i()})}var yf=0;function Se(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function qi(){return++yf}var Ee=kt.prototype;Se.prototype={constructor:Se,select:Ud,selectAll:Zd,selectChild:Ee.selectChild,selectChildren:Ee.selectChildren,filter:Fd,merge:Yd,selection:Jd,transition:pf,call:Ee.call,nodes:Ee.nodes,node:Ee.node,size:Ee.size,empty:Ee.empty,each:Ee.each,on:Wd,attr:kd,attrTween:Pd,style:of,styleTween:cf,text:df,textTween:gf,remove:Kd,tween:vd,delay:jd,duration:Dd,ease:Bd,easeVarying:Vd,end:mf,[Symbol.iterator]:Ee[Symbol.iterator]};function xf(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var wf={time:null,delay:0,duration:250,ease:xf};function vf(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function bf(e){var t,n;e instanceof Se?(t=e._id,e=e._name):(t=qi(),(n=wf).time=xr(),e=e==null?null:e+"");for(var r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],a=s.length,c,l=0;l<a;++l)(c=s[l])&&un(c,e,t,l,s,n||vf(c,t));return new Se(r,this._parents,e,t)}kt.prototype.interrupt=yd;kt.prototype.transition=bf;const Dt=e=>()=>e;function Ef(e,{sourceEvent:t,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function Ne(e,t,n){this.k=e,this.x=t,this.y=n}Ne.prototype={constructor:Ne,scale:function(e){return e===1?this:new Ne(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Ne(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var dn=new Ne(1,0,0);Ki.prototype=Ne.prototype;function Ki(e){for(;!e.__zoom;)if(!(e=e.parentNode))return dn;return e.__zoom}function jn(e){e.stopImmediatePropagation()}function ut(e){e.preventDefault(),e.stopImmediatePropagation()}function _f(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Nf(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function so(){return this.__zoom||dn}function Cf(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Sf(){return navigator.maxTouchPoints||"ontouchstart"in this}function kf(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function Ui(){var e=_f,t=Nf,n=kf,r=Cf,o=Sf,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,c=ld,l=St("start","zoom","end"),u,d,f,h=500,g=150,p=0,y=10;function m(v){v.property("__zoom",so).on("wheel.zoom",T,{passive:!1}).on("mousedown.zoom",O).on("dblclick.zoom",j).filter(o).on("touchstart.zoom",z).on("touchmove.zoom",R).on("touchend.zoom touchcancel.zoom",L).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}m.transform=function(v,S,_,P){var k=v.selection?v.selection():v;k.property("__zoom",so),v!==k?C(v,S,_,P):k.interrupt().each(function(){I(this,arguments).event(P).start().zoom(null,typeof S=="function"?S.apply(this,arguments):S).end()})},m.scaleBy=function(v,S,_,P){m.scaleTo(v,function(){var k=this.__zoom.k,$=typeof S=="function"?S.apply(this,arguments):S;return k*$},_,P)},m.scaleTo=function(v,S,_,P){m.transform(v,function(){var k=t.apply(this,arguments),$=this.__zoom,M=_==null?w(k):typeof _=="function"?_.apply(this,arguments):_,D=$.invert(M),B=typeof S=="function"?S.apply(this,arguments):S;return n(x(E($,B),M,D),k,s)},_,P)},m.translateBy=function(v,S,_,P){m.transform(v,function(){return n(this.__zoom.translate(typeof S=="function"?S.apply(this,arguments):S,typeof _=="function"?_.apply(this,arguments):_),t.apply(this,arguments),s)},null,P)},m.translateTo=function(v,S,_,P,k){m.transform(v,function(){var $=t.apply(this,arguments),M=this.__zoom,D=P==null?w($):typeof P=="function"?P.apply(this,arguments):P;return n(dn.translate(D[0],D[1]).scale(M.k).translate(typeof S=="function"?-S.apply(this,arguments):-S,typeof _=="function"?-_.apply(this,arguments):-_),$,s)},P,k)};function E(v,S){return S=Math.max(i[0],Math.min(i[1],S)),S===v.k?v:new Ne(S,v.x,v.y)}function x(v,S,_){var P=S[0]-_[0]*v.k,k=S[1]-_[1]*v.k;return P===v.x&&k===v.y?v:new Ne(v.k,P,k)}function w(v){return[(+v[0][0]+ +v[1][0])/2,(+v[0][1]+ +v[1][1])/2]}function C(v,S,_,P){v.on("start.zoom",function(){I(this,arguments).event(P).start()}).on("interrupt.zoom end.zoom",function(){I(this,arguments).event(P).end()}).tween("zoom",function(){var k=this,$=arguments,M=I(k,$).event(P),D=t.apply(k,$),B=_==null?w(D):typeof _=="function"?_.apply(k,$):_,X=Math.max(D[1][0]-D[0][0],D[1][1]-D[0][1]),F=k.__zoom,H=typeof S=="function"?S.apply(k,$):S,G=c(F.invert(B).concat(X/F.k),H.invert(B).concat(X/H.k));return function(V){if(V===1)V=H;else{var W=G(V),K=X/W[2];V=new Ne(K,B[0]-W[0]*K,B[1]-W[1]*K)}M.zoom(null,V)}})}function I(v,S,_){return!_&&v.__zooming||new N(v,S)}function N(v,S){this.that=v,this.args=S,this.active=0,this.sourceEvent=null,this.extent=t.apply(v,S),this.taps=0}N.prototype={event:function(v){return v&&(this.sourceEvent=v),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(v,S){return this.mouse&&v!=="mouse"&&(this.mouse[1]=S.invert(this.mouse[0])),this.touch0&&v!=="touch"&&(this.touch0[1]=S.invert(this.touch0[0])),this.touch1&&v!=="touch"&&(this.touch1[1]=S.invert(this.touch1[0])),this.that.__zoom=S,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(v){var S=ue(this.that).datum();l.call(v,this.that,new Ef(v,{sourceEvent:this.sourceEvent,target:m,type:v,transform:this.that.__zoom,dispatch:l}),S)}};function T(v,...S){if(!e.apply(this,arguments))return;var _=I(this,S).event(v),P=this.__zoom,k=Math.max(i[0],Math.min(i[1],P.k*Math.pow(2,r.apply(this,arguments)))),$=ge(v);if(_.wheel)(_.mouse[0][0]!==$[0]||_.mouse[0][1]!==$[1])&&(_.mouse[1]=P.invert(_.mouse[0]=$)),clearTimeout(_.wheel);else{if(P.k===k)return;_.mouse=[$,P.invert($)],qt(this),_.start()}ut(v),_.wheel=setTimeout(M,g),_.zoom("mouse",n(x(E(P,k),_.mouse[0],_.mouse[1]),_.extent,s));function M(){_.wheel=null,_.end()}}function O(v,...S){if(f||!e.apply(this,arguments))return;var _=v.currentTarget,P=I(this,S,!0).event(v),k=ue(v.view).on("mousemove.zoom",B,!0).on("mouseup.zoom",X,!0),$=ge(v,_),M=v.clientX,D=v.clientY;Oi(v.view),jn(v),P.mouse=[$,this.__zoom.invert($)],qt(this),P.start();function B(F){if(ut(F),!P.moved){var H=F.clientX-M,G=F.clientY-D;P.moved=H*H+G*G>p}P.event(F).zoom("mouse",n(x(P.that.__zoom,P.mouse[0]=ge(F,_),P.mouse[1]),P.extent,s))}function X(F){k.on("mousemove.zoom mouseup.zoom",null),ji(F.view,P.moved),ut(F),P.event(F).end()}}function j(v,...S){if(e.apply(this,arguments)){var _=this.__zoom,P=ge(v.changedTouches?v.changedTouches[0]:v,this),k=_.invert(P),$=_.k*(v.shiftKey?.5:2),M=n(x(E(_,$),P,k),t.apply(this,S),s);ut(v),a>0?ue(this).transition().duration(a).call(C,M,P,v):ue(this).call(m.transform,M,P,v)}}function z(v,...S){if(e.apply(this,arguments)){var _=v.touches,P=_.length,k=I(this,S,v.changedTouches.length===P).event(v),$,M,D,B;for(jn(v),M=0;M<P;++M)D=_[M],B=ge(D,this),B=[B,this.__zoom.invert(B),D.identifier],k.touch0?!k.touch1&&k.touch0[2]!==B[2]&&(k.touch1=B,k.taps=0):(k.touch0=B,$=!0,k.taps=1+!!u);u&&(u=clearTimeout(u)),$&&(k.taps<2&&(d=B[0],u=setTimeout(function(){u=null},h)),qt(this),k.start())}}function R(v,...S){if(this.__zooming){var _=I(this,S).event(v),P=v.changedTouches,k=P.length,$,M,D,B;for(ut(v),$=0;$<k;++$)M=P[$],D=ge(M,this),_.touch0&&_.touch0[2]===M.identifier?_.touch0[0]=D:_.touch1&&_.touch1[2]===M.identifier&&(_.touch1[0]=D);if(M=_.that.__zoom,_.touch1){var X=_.touch0[0],F=_.touch0[1],H=_.touch1[0],G=_.touch1[1],V=(V=H[0]-X[0])*V+(V=H[1]-X[1])*V,W=(W=G[0]-F[0])*W+(W=G[1]-F[1])*W;M=E(M,Math.sqrt(V/W)),D=[(X[0]+H[0])/2,(X[1]+H[1])/2],B=[(F[0]+G[0])/2,(F[1]+G[1])/2]}else if(_.touch0)D=_.touch0[0],B=_.touch0[1];else return;_.zoom("touch",n(x(M,D,B),_.extent,s))}}function L(v,...S){if(this.__zooming){var _=I(this,S).event(v),P=v.changedTouches,k=P.length,$,M;for(jn(v),f&&clearTimeout(f),f=setTimeout(function(){f=null},h),$=0;$<k;++$)M=P[$],_.touch0&&_.touch0[2]===M.identifier?delete _.touch0:_.touch1&&_.touch1[2]===M.identifier&&delete _.touch1;if(_.touch1&&!_.touch0&&(_.touch0=_.touch1,delete _.touch1),_.touch0)_.touch0[1]=this.__zoom.invert(_.touch0[0]);else if(_.end(),_.taps===2&&(M=ge(M,this),Math.hypot(d[0]-M[0],d[1]-M[1])<y)){var D=ue(this).on("dblclick.zoom");D&&D.apply(this,arguments)}}}return m.wheelDelta=function(v){return arguments.length?(r=typeof v=="function"?v:Dt(+v),m):r},m.filter=function(v){return arguments.length?(e=typeof v=="function"?v:Dt(!!v),m):e},m.touchable=function(v){return arguments.length?(o=typeof v=="function"?v:Dt(!!v),m):o},m.extent=function(v){return arguments.length?(t=typeof v=="function"?v:Dt([[+v[0][0],+v[0][1]],[+v[1][0],+v[1][1]]]),m):t},m.scaleExtent=function(v){return arguments.length?(i[0]=+v[0],i[1]=+v[1],m):[i[0],i[1]]},m.translateExtent=function(v){return arguments.length?(s[0][0]=+v[0][0],s[1][0]=+v[1][0],s[0][1]=+v[0][1],s[1][1]=+v[1][1],m):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},m.constrain=function(v){return arguments.length?(n=v,m):n},m.duration=function(v){return arguments.length?(a=+v,m):a},m.interpolate=function(v){return arguments.length?(c=v,m):c},m.on=function(){var v=l.on.apply(l,arguments);return v===l?m:v},m.clickDistance=function(v){return arguments.length?(p=(v=+v)*v,m):Math.sqrt(p)},m.tapDistance=function(v){return arguments.length?(y=+v,m):y},m}const ke={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID."},bt=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Zi=["Enter"," ","Escape"];var Ve;(function(e){e.Strict="strict",e.Loose="loose"})(Ve||(Ve={}));var Be;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Be||(Be={}));var Et;(function(e){e.Partial="partial",e.Full="full"})(Et||(Et={}));const Qi={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var Pe;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Pe||(Pe={}));var tn;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(tn||(tn={}));var Y;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(Y||(Y={}));const ao={[Y.Left]:Y.Right,[Y.Right]:Y.Left,[Y.Top]:Y.Bottom,[Y.Bottom]:Y.Top};function Ji(e){return e===null?null:e?"valid":"invalid"}const es=e=>"id"in e&&"source"in e&&"target"in e,Mf=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Er=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),It=(e,t=[0,0])=>{const{width:n,height:r}=Me(e),o=e.origin??t,i=n*o[0],s=r*o[1];return{x:e.position.x-i,y:e.position.y-s}},If=(e,t={nodeOrigin:[0,0],nodeLookup:void 0})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,o)=>{const i=typeof o=="string";let s=!t.nodeLookup&&!i?o:void 0;t.nodeLookup&&(s=i?t.nodeLookup.get(o):Er(o)?o:t.nodeLookup.get(o.id));const a=s?nn(s,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return fn(r,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return hn(n)},$t=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(r=>{if(t.filter===void 0||t.filter(r)){const o=nn(r);n=fn(n,o)}}),hn(n)},ts=(e,t,[n,r,o]=[0,0,1],i=!1,s=!1)=>{const a={...At(t,[n,r,o]),width:t.width/o,height:t.height/o},c=[];for(const l of e.values()){const{measured:u,selectable:d=!0,hidden:f=!1}=l;if(s&&!d||f)continue;const h=u.width??l.width??l.initialWidth??null,g=u.height??l.height??l.initialHeight??null,p=_t(a,Je(l)),y=(h??0)*(g??0),m=i&&p>0;(!l.internals.handleBounds||m||p>=y||l.dragging)&&c.push(l)}return c},$f=(e,t)=>{const n=new Set;return e.forEach(r=>{n.add(r.id)}),t.filter(r=>n.has(r.source)||n.has(r.target))};function rr(e,t){const n=new Map,r=t!=null&&t.nodes?new Set(t.nodes.map(o=>o.id)):null;return e.forEach(o=>{o.measured.width&&o.measured.height&&((t==null?void 0:t.includeHiddenNodes)||!o.hidden)&&(!r||r.has(o.id))&&n.set(o.id,o)}),n}async function or({nodes:e,width:t,height:n,panZoom:r,minZoom:o,maxZoom:i},s){if(e.size===0)return Promise.resolve(!1);const a=$t(e),c=_r(a,t,n,(s==null?void 0:s.minZoom)??o,(s==null?void 0:s.maxZoom)??i,(s==null?void 0:s.padding)??.1);return await r.setViewport(c,{duration:s==null?void 0:s.duration}),Promise.resolve(!0)}function ns({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:o,onError:i}){const s=n.get(e),a=s.parentId?n.get(s.parentId):void 0,{x:c,y:l}=a?a.internals.positionAbsolute:{x:0,y:0},u=s.origin??r;let d=o;if(s.extent==="parent"&&!s.expandParent)if(!a)i==null||i("005",ke.error005());else{const h=a.measured.width,g=a.measured.height;h&&g&&(d=[[c,l],[c+h,l+g]])}else a&&et(s.extent)&&(d=[[s.extent[0][0]+c,s.extent[0][1]+l],[s.extent[1][0]+c,s.extent[1][1]+l]]);const f=et(d)?Fe(t,d,s.measured):t;return{position:{x:f.x-c+s.measured.width*u[0],y:f.y-l+s.measured.height*u[1]},positionAbsolute:f}}async function Af({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:o}){const i=new Set(e.map(f=>f.id)),s=[];for(const f of n){if(f.deletable===!1)continue;const h=i.has(f.id),g=!h&&f.parentId&&s.find(p=>p.id===f.parentId);(h||g)&&s.push(f)}const a=new Set(t.map(f=>f.id)),c=r.filter(f=>f.deletable!==!1),u=$f(s,c);for(const f of c)a.has(f.id)&&!u.find(g=>g.id===f.id)&&u.push(f);if(!o)return{edges:u,nodes:s};const d=await o({nodes:s,edges:u});return typeof d=="boolean"?d?{edges:u,nodes:s}:{edges:[],nodes:[]}:d}const Qe=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Fe=(e={x:0,y:0},t,n)=>({x:Qe(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:Qe(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function rs(e,t,n){const{width:r,height:o}=Me(n),{x:i,y:s}=n.internals.positionAbsolute;return Fe(e,[[i,s],[i+r,s+o]],t)}const co=(e,t,n)=>e<t?Qe(Math.abs(e-t),1,t)/t:e>n?-Qe(Math.abs(e-n),1,t)/t:0,os=(e,t,n=15,r=40)=>{const o=co(e.x,r,t.width-r)*n,i=co(e.y,r,t.height-r)*n;return[o,i]},fn=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),ir=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),hn=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),Je=(e,t=[0,0])=>{var o,i;const{x:n,y:r}=Er(e)?e.internals.positionAbsolute:It(e,t);return{x:n,y:r,width:((o=e.measured)==null?void 0:o.width)??e.width??e.initialWidth??0,height:((i=e.measured)==null?void 0:i.height)??e.height??e.initialHeight??0}},nn=(e,t=[0,0])=>{var o,i;const{x:n,y:r}=Er(e)?e.internals.positionAbsolute:It(e,t);return{x:n,y:r,x2:n+(((o=e.measured)==null?void 0:o.width)??e.width??e.initialWidth??0),y2:r+(((i=e.measured)==null?void 0:i.height)??e.height??e.initialHeight??0)}},is=(e,t)=>hn(fn(ir(e),ir(t))),_t=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},lo=e=>me(e.width)&&me(e.height)&&me(e.x)&&me(e.y),me=e=>!isNaN(e)&&isFinite(e),Pf=(e,t)=>{},gn=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),At=({x:e,y:t},[n,r,o],i=!1,s=[1,1])=>{const a={x:(e-n)/o,y:(t-r)/o};return i?gn(a,s):a},ss=({x:e,y:t},[n,r,o])=>({x:e*o+n,y:t*o+r}),_r=(e,t,n,r,o,i)=>{const s=t/(e.width*(1+i)),a=n/(e.height*(1+i)),c=Math.min(s,a),l=Qe(c,r,o),u=e.x+e.width/2,d=e.y+e.height/2,f=t/2-u*l,h=n/2-d*l;return{x:f,y:h,zoom:l}},rn=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function et(e){return e!==void 0&&e!=="parent"}function Me(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function as(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function cs(e,t={width:0,height:0},n,r,o){const i={...e},s=r.get(n);if(s){const a=s.origin||o;i.x+=s.internals.positionAbsolute.x-(t.width??0)*a[0],i.y+=s.internals.positionAbsolute.y-(t.height??0)*a[1]}return i}function uo(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function gt(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:o}){const{x:i,y:s}=Ce(e),a=At({x:i-((o==null?void 0:o.left)??0),y:s-((o==null?void 0:o.top)??0)},r),{x:c,y:l}=n?gn(a,t):a;return{xSnapped:c,ySnapped:l,...a}}const pn=e=>({width:e.offsetWidth,height:e.offsetHeight}),ls=e=>{var t;return((t=e==null?void 0:e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},Tf=["INPUT","SELECT","TEXTAREA"];function sr(e){var r,o;const t=((o=(r=e.composedPath)==null?void 0:r.call(e))==null?void 0:o[0])||e.target;return(t==null?void 0:t.nodeType)!==1?!1:Tf.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const us=e=>"clientX"in e,Ce=(e,t)=>{var i,s;const n=us(e),r=n?e.clientX:(i=e.touches)==null?void 0:i[0].clientX,o=n?e.clientY:(s=e.touches)==null?void 0:s[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:o-((t==null?void 0:t.top)??0)}},fo=(e,t,n,r,o)=>{const i=t.querySelectorAll(`.${e}`);return!i||!i.length?null:Array.from(i).map(s=>{const a=s.getBoundingClientRect();return{id:s.getAttribute("data-handleid"),type:e,nodeId:o,position:s.getAttribute("data-handlepos"),x:(a.left-n.left)/r,y:(a.top-n.top)/r,...pn(s)}})};function ds({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:o,sourceControlY:i,targetControlX:s,targetControlY:a}){const c=e*.125+o*.375+s*.375+n*.125,l=t*.125+i*.375+a*.375+r*.125,u=Math.abs(c-e),d=Math.abs(l-t);return[c,l,u,d]}function zt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function ho({pos:e,x1:t,y1:n,x2:r,y2:o,c:i}){switch(e){case Y.Left:return[t-zt(t-r,i),n];case Y.Right:return[t+zt(r-t,i),n];case Y.Top:return[t,n-zt(n-o,i)];case Y.Bottom:return[t,n+zt(o-n,i)]}}function Nr({sourceX:e,sourceY:t,sourcePosition:n=Y.Bottom,targetX:r,targetY:o,targetPosition:i=Y.Top,curvature:s=.25}){const[a,c]=ho({pos:n,x1:e,y1:t,x2:r,y2:o,c:s}),[l,u]=ho({pos:i,x1:r,y1:o,x2:e,y2:t,c:s}),[d,f,h,g]=ds({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:a,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${e},${t} C${a},${c} ${l},${u} ${r},${o}`,d,f,h,g]}function fs({sourceX:e,sourceY:t,targetX:n,targetY:r}){const o=Math.abs(n-e)/2,i=n<e?n+o:n-o,s=Math.abs(r-t)/2,a=r<t?r+s:r-s;return[i,a,o,s]}function Of({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r=0,elevateOnSelect:o=!1}){if(!o)return r;const i=n||t.selected||e.selected,s=Math.max(e.internals.z||0,t.internals.z||0,1e3);return r+(i?s:0)}function jf({sourceNode:e,targetNode:t,width:n,height:r,transform:o}){const i=fn(nn(e),nn(t));i.x===i.x2&&(i.x2+=1),i.y===i.y2&&(i.y2+=1);const s={x:-o[0]/o[2],y:-o[1]/o[2],width:n/o[2],height:r/o[2]};return _t(s,hn(i))>0}const Lf=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,Rf=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Df=(e,t)=>{if(!e.source||!e.target)return t;let n;return es(e)?n={...e}:n={...e,id:Lf(e)},Rf(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function hs({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[o,i,s,a]=fs({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,o,i,s,a]}const go={[Y.Left]:{x:-1,y:0},[Y.Right]:{x:1,y:0},[Y.Top]:{x:0,y:-1},[Y.Bottom]:{x:0,y:1}},zf=({source:e,sourcePosition:t=Y.Bottom,target:n})=>t===Y.Left||t===Y.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},po=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Bf({source:e,sourcePosition:t=Y.Bottom,target:n,targetPosition:r=Y.Top,center:o,offset:i}){const s=go[t],a=go[r],c={x:e.x+s.x*i,y:e.y+s.y*i},l={x:n.x+a.x*i,y:n.y+a.y*i},u=zf({source:c,sourcePosition:t,target:l}),d=u.x!==0?"x":"y",f=u[d];let h=[],g,p;const y={x:0,y:0},m={x:0,y:0},[E,x,w,C]=fs({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(s[d]*a[d]===-1){g=o.x??E,p=o.y??x;const N=[{x:g,y:c.y},{x:g,y:l.y}],T=[{x:c.x,y:p},{x:l.x,y:p}];s[d]===f?h=d==="x"?N:T:h=d==="x"?T:N}else{const N=[{x:c.x,y:l.y}],T=[{x:l.x,y:c.y}];if(d==="x"?h=s.x===f?T:N:h=s.y===f?N:T,t===r){const L=Math.abs(e[d]-n[d]);if(L<=i){const v=Math.min(i-1,i-L);s[d]===f?y[d]=(c[d]>e[d]?-1:1)*v:m[d]=(l[d]>n[d]?-1:1)*v}}if(t!==r){const L=d==="x"?"y":"x",v=s[d]===a[L],S=c[L]>l[L],_=c[L]<l[L];(s[d]===1&&(!v&&S||v&&_)||s[d]!==1&&(!v&&_||v&&S))&&(h=d==="x"?N:T)}const O={x:c.x+y.x,y:c.y+y.y},j={x:l.x+m.x,y:l.y+m.y},z=Math.max(Math.abs(O.x-h[0].x),Math.abs(j.x-h[0].x)),R=Math.max(Math.abs(O.y-h[0].y),Math.abs(j.y-h[0].y));z>=R?(g=(O.x+j.x)/2,p=h[0].y):(g=h[0].x,p=(O.y+j.y)/2)}return[[e,{x:c.x+y.x,y:c.y+y.y},...h,{x:l.x+m.x,y:l.y+m.y},n],g,p,w,C]}function Hf(e,t,n,r){const o=Math.min(po(e,t)/2,po(t,n)/2,r),{x:i,y:s}=t;if(e.x===i&&i===n.x||e.y===s&&s===n.y)return`L${i} ${s}`;if(e.y===s){const l=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${i+o*l},${s}Q ${i},${s} ${i},${s+o*u}`}const a=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${i},${s+o*c}Q ${i},${s} ${i+o*a},${s}`}function ar({sourceX:e,sourceY:t,sourcePosition:n=Y.Bottom,targetX:r,targetY:o,targetPosition:i=Y.Top,borderRadius:s=5,centerX:a,centerY:c,offset:l=20}){const[u,d,f,h,g]=Bf({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:o},targetPosition:i,center:{x:a,y:c},offset:l});return[u.reduce((y,m,E)=>{let x="";return E>0&&E<u.length-1?x=Hf(u[E-1],m,u[E+1],s):x=`${E===0?"M":"L"}${m.x} ${m.y}`,y+=x,y},""),d,f,h,g]}function mo(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function Vf(e){var d;const{sourceNode:t,targetNode:n}=e;if(!mo(t)||!mo(n))return null;const r=t.internals.handleBounds||yo(t.handles),o=n.internals.handleBounds||yo(n.handles),i=xo((r==null?void 0:r.source)??[],e.sourceHandle),s=xo(e.connectionMode===Ve.Strict?(o==null?void 0:o.target)??[]:((o==null?void 0:o.target)??[]).concat((o==null?void 0:o.source)??[]),e.targetHandle);if(!i||!s)return(d=e.onError)==null||d.call(e,"008",ke.error008(i?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const a=(i==null?void 0:i.position)||Y.Bottom,c=(s==null?void 0:s.position)||Y.Top,l=Nt(t,i,a),u=Nt(n,s,c);return{sourceX:l.x,sourceY:l.y,targetX:u.x,targetY:u.y,sourcePosition:a,targetPosition:c}}function yo(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,r.type==="source"?t.push(r):r.type==="target"&&n.push(r);return{source:t,target:n}}function Nt(e,t,n=Y.Left,r=!1){const o=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,i=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:s,height:a}=t??Me(e);if(r)return{x:o+s/2,y:i+a/2};switch((t==null?void 0:t.position)??n){case Y.Top:return{x:o+s/2,y:i};case Y.Right:return{x:o+s,y:i+a/2};case Y.Bottom:return{x:o+s/2,y:i+a};case Y.Left:return{x:o,y:i+a/2}}}function xo(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function cr(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`:""}function Ff(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:o}){const i=new Set;return e.reduce((s,a)=>([a.markerStart||r,a.markerEnd||o].forEach(c=>{if(c&&typeof c=="object"){const l=cr(c,t);i.has(l)||(s.push({id:l,color:c.color||n,...c}),i.add(l))}}),s),[]).sort((s,a)=>s.id.localeCompare(a.id))}const Cr={nodeOrigin:[0,0],nodeExtent:bt,elevateNodesOnSelect:!0,defaults:{}},Yf={...Cr,checkEquality:!0};function Sr(e,t){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}function Xf(e,t,n){const r=Sr(Cr,n);for(const o of e.values())if(o.parentId)kr(o,e,t,r);else{const i=It(o,r.nodeOrigin),s=et(o.extent)?o.extent:r.nodeExtent,a=Fe(i,s,Me(o));o.internals.positionAbsolute=a}}function lr(e,t,n,r){var a,c;const o=Sr(Yf,r),i=new Map(t),s=o!=null&&o.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const l of e){let u=i.get(l.id);if(o.checkEquality&&l===(u==null?void 0:u.internals.userNode))t.set(l.id,u);else{const d=It(l,o.nodeOrigin),f=et(l.extent)?l.extent:o.nodeExtent,h=Fe(d,f,Me(l));u={...o.defaults,...l,measured:{width:(a=l.measured)==null?void 0:a.width,height:(c=l.measured)==null?void 0:c.height},internals:{positionAbsolute:h,handleBounds:l.measured?u==null?void 0:u.internals.handleBounds:void 0,z:gs(l,s),userNode:l}},t.set(l.id,u)}l.parentId&&kr(u,t,n,r)}}function Gf(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function kr(e,t,n,r){const{elevateNodesOnSelect:o,nodeOrigin:i,nodeExtent:s}=Sr(Cr,r),a=e.parentId,c=t.get(a);if(!c){console.warn(`Parent node ${a} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}Gf(e,n);const l=o?1e3:0,{x:u,y:d,z:f}=Wf(e,c,i,s,l),{positionAbsolute:h}=e.internals,g=u!==h.x||d!==h.y;(g||f!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:g?{x:u,y:d}:h,z:f}})}function gs(e,t){return(me(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function Wf(e,t,n,r,o){const{x:i,y:s}=t.internals.positionAbsolute,a=Me(e),c=It(e,n),l=et(e.extent)?Fe(c,e.extent,a):c;let u=Fe({x:i+l.x,y:s+l.y},r,a);e.extent==="parent"&&(u=rs(u,a,t));const d=gs(e,o),f=t.internals.z??0;return{x:u.x,y:u.y,z:f>d?f:d}}function Mr(e,t,n,r=[0,0]){var s;const o=[],i=new Map;for(const a of e){const c=t.get(a.parentId);if(!c)continue;const l=((s=i.get(a.parentId))==null?void 0:s.expandedRect)??Je(c),u=is(l,a.rect);i.set(a.parentId,{expandedRect:u,parent:c})}return i.size>0&&i.forEach(({expandedRect:a,parent:c},l)=>{var x;const u=c.internals.positionAbsolute,d=Me(c),f=c.origin??r,h=a.x<u.x?Math.round(Math.abs(u.x-a.x)):0,g=a.y<u.y?Math.round(Math.abs(u.y-a.y)):0,p=Math.max(d.width,Math.round(a.width)),y=Math.max(d.height,Math.round(a.height)),m=(p-d.width)*f[0],E=(y-d.height)*f[1];(h>0||g>0||m||E)&&(o.push({id:l,type:"position",position:{x:c.position.x-h+m,y:c.position.y-g+E}}),(x=n.get(l))==null||x.forEach(w=>{e.some(C=>C.id===w.id)||o.push({id:w.id,type:"position",position:{x:w.position.x+h,y:w.position.y+g}})})),(d.width<a.width||d.height<a.height||h||g)&&o.push({id:l,type:"dimensions",setAttributes:!0,dimensions:{width:p+(h?f[0]*h-m:0),height:y+(g?f[1]*g-E:0)}})}),o}function qf(e,t,n,r,o,i){const s=r==null?void 0:r.querySelector(".xyflow__viewport");let a=!1;if(!s)return{changes:[],updatedInternals:a};const c=[],l=window.getComputedStyle(s),{m22:u}=new window.DOMMatrixReadOnly(l.transform),d=[];for(const f of e.values()){const h=t.get(f.id);if(!h)continue;if(h.hidden){t.set(h.id,{...h,internals:{...h.internals,handleBounds:void 0}}),a=!0;continue}const g=pn(f.nodeElement),p=h.measured.width!==g.width||h.measured.height!==g.height;if(!!(g.width&&g.height&&(p||!h.internals.handleBounds||f.force))){const m=f.nodeElement.getBoundingClientRect(),E=et(h.extent)?h.extent:i;let{positionAbsolute:x}=h.internals;h.parentId&&h.extent==="parent"?x=rs(x,g,t.get(h.parentId)):E&&(x=Fe(x,E,g));const w={...h,measured:g,internals:{...h.internals,positionAbsolute:x,handleBounds:{source:fo("source",f.nodeElement,m,u,h.id),target:fo("target",f.nodeElement,m,u,h.id)}}};t.set(h.id,w),h.parentId&&kr(w,t,n,{nodeOrigin:o}),a=!0,p&&(c.push({id:h.id,type:"dimensions",dimensions:g}),h.expandParent&&h.parentId&&d.push({id:h.id,parentId:h.parentId,rect:Je(w,o)}))}}if(d.length>0){const f=Mr(d,t,n,o);c.push(...f)}return{changes:c,updatedInternals:a}}async function Kf({delta:e,panZoom:t,transform:n,translateExtent:r,width:o,height:i}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const s=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[o,i]],r),a=!!s&&(s.x!==n[0]||s.y!==n[1]||s.k!==n[2]);return Promise.resolve(a)}function wo(e,t,n,r,o,i){let s=o;const a=r.get(s)||new Map;r.set(s,a.set(n,t)),s=`${o}-${e}`;const c=r.get(s)||new Map;if(r.set(s,c.set(n,t)),i){s=`${o}-${e}-${i}`;const l=r.get(s)||new Map;r.set(s,l.set(n,t))}}function ps(e,t,n){e.clear(),t.clear();for(const r of n){const{source:o,target:i,sourceHandle:s=null,targetHandle:a=null}=r,c={edgeId:r.id,source:o,target:i,sourceHandle:s,targetHandle:a},l=`${o}-${s}--${i}-${a}`,u=`${i}-${a}--${o}-${s}`;wo("source",c,u,e,o,s),wo("target",c,l,e,i,a),t.set(r.id,r)}}function ms(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:ms(n,t):!1}function vo(e,t,n){var o;let r=e;do{if((o=r==null?void 0:r.matches)!=null&&o.call(r,t))return!0;if(r===n)return!1;r=r==null?void 0:r.parentElement}while(r);return!1}function Uf(e,t,n,r){const o=new Map;for(const[i,s]of e)if((s.selected||s.id===r)&&(!s.parentId||!ms(s,e))&&(s.draggable||t&&typeof s.draggable>"u")){const a=e.get(i);a&&o.set(i,{id:i,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return o}function Ln({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){var s,a,c;const o=[];for(const[l,u]of t){const d=(s=n.get(l))==null?void 0:s.internals.userNode;d&&o.push({...d,position:u.position,dragging:r})}if(!e)return[o[0],o];const i=(a=n.get(e))==null?void 0:a.internals.userNode;return[i?{...i,position:((c=t.get(e))==null?void 0:c.position)||i.position,dragging:r}:o[0],o]}function Zf({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:o}){let i={x:null,y:null},s=0,a=new Map,c=!1,l={x:0,y:0},u=null,d=!1,f=null,h=!1;function g({noDragClassName:y,handleSelector:m,domNode:E,isSelectable:x,nodeId:w,nodeClickDistance:C=0}){f=ue(E);function I({x:j,y:z},R){const{nodeLookup:L,nodeExtent:v,snapGrid:S,snapToGrid:_,nodeOrigin:P,onNodeDrag:k,onSelectionDrag:$,onError:M,updateNodePositions:D}=t();i={x:j,y:z};let B=!1,X={x:0,y:0,x2:0,y2:0};if(a.size>1&&v){const F=$t(a);X=ir(F)}for(const[F,H]of a){if(!L.has(F))continue;let G={x:j-H.distance.x,y:z-H.distance.y};_&&(G=gn(G,S));let V=[[v[0][0],v[0][1]],[v[1][0],v[1][1]]];if(a.size>1&&v&&!H.extent){const{positionAbsolute:J}=H.internals,U=J.x-X.x+v[0][0],q=J.x+H.measured.width-X.x2+v[1][0],Q=J.y-X.y+v[0][1],ee=J.y+H.measured.height-X.y2+v[1][1];V=[[U,Q],[q,ee]]}const{position:W,positionAbsolute:K}=ns({nodeId:F,nextPosition:G,nodeLookup:L,nodeExtent:V,nodeOrigin:P,onError:M});B=B||H.position.x!==W.x||H.position.y!==W.y,H.position=W,H.internals.positionAbsolute=K}if(B&&(D(a,!0),R&&(r||k||!w&&$))){const[F,H]=Ln({nodeId:w,dragItems:a,nodeLookup:L});r==null||r(R,a,F,H),k==null||k(R,F,H),w||$==null||$(R,H)}}async function N(){if(!u)return;const{transform:j,panBy:z,autoPanSpeed:R,autoPanOnNodeDrag:L}=t();if(!L){c=!1,cancelAnimationFrame(s);return}const[v,S]=os(l,u,R);(v!==0||S!==0)&&(i.x=(i.x??0)-v/j[2],i.y=(i.y??0)-S/j[2],await z({x:v,y:S})&&I(i,null)),s=requestAnimationFrame(N)}function T(j){var B;const{nodeLookup:z,multiSelectionActive:R,nodesDraggable:L,transform:v,snapGrid:S,snapToGrid:_,selectNodesOnDrag:P,onNodeDragStart:k,onSelectionDragStart:$,unselectNodesAndEdges:M}=t();d=!0,(!P||!x)&&!R&&w&&((B=z.get(w))!=null&&B.selected||M()),x&&P&&w&&(e==null||e(w));const D=gt(j.sourceEvent,{transform:v,snapGrid:S,snapToGrid:_,containerBounds:u});if(i=D,a=Uf(z,L,D,w),a.size>0&&(n||k||!w&&$)){const[X,F]=Ln({nodeId:w,dragItems:a,nodeLookup:z});n==null||n(j.sourceEvent,a,X,F),k==null||k(j.sourceEvent,X,F),w||$==null||$(j.sourceEvent,F)}}const O=Li().clickDistance(C).on("start",j=>{const{domNode:z,nodeDragThreshold:R,transform:L,snapGrid:v,snapToGrid:S}=t();u=(z==null?void 0:z.getBoundingClientRect())||null,h=!1,R===0&&T(j),i=gt(j.sourceEvent,{transform:L,snapGrid:v,snapToGrid:S,containerBounds:u}),l=Ce(j.sourceEvent,u)}).on("drag",j=>{const{autoPanOnNodeDrag:z,transform:R,snapGrid:L,snapToGrid:v,nodeDragThreshold:S,nodeLookup:_}=t(),P=gt(j.sourceEvent,{transform:R,snapGrid:L,snapToGrid:v,containerBounds:u});if((j.sourceEvent.type==="touchmove"&&j.sourceEvent.touches.length>1||w&&!_.has(w))&&(h=!0),!h){if(!c&&z&&d&&(c=!0,N()),!d){const k=P.xSnapped-(i.x??0),$=P.ySnapped-(i.y??0);Math.sqrt(k*k+$*$)>S&&T(j)}(i.x!==P.xSnapped||i.y!==P.ySnapped)&&a&&d&&(l=Ce(j.sourceEvent,u),I(P,j.sourceEvent))}}).on("end",j=>{if(!(!d||h)&&(c=!1,d=!1,cancelAnimationFrame(s),a.size>0)){const{nodeLookup:z,updateNodePositions:R,onNodeDragStop:L,onSelectionDragStop:v}=t();if(R(a,!1),o||L||!w&&v){const[S,_]=Ln({nodeId:w,dragItems:a,nodeLookup:z,dragging:!1});o==null||o(j.sourceEvent,a,S,_),L==null||L(j.sourceEvent,S,_),w||v==null||v(j.sourceEvent,_)}}}).filter(j=>{const z=j.target;return!j.button&&(!y||!vo(z,`.${y}`,E))&&(!m||vo(z,m,E))});f.call(O)}function p(){f==null||f.on(".drag",null)}return{update:g,destroy:p}}function Qf(e,t,n){const r=[],o={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const i of t.values())_t(o,Je(i))>0&&r.push(i);return r}const Jf=250;function eh(e,t,n,r){var a,c;let o=[],i=1/0;const s=Qf(e,n,t+Jf);for(const l of s){const u=[...((a=l.internals.handleBounds)==null?void 0:a.source)??[],...((c=l.internals.handleBounds)==null?void 0:c.target)??[]];for(const d of u){if(r.nodeId===d.nodeId&&r.type===d.type&&r.id===d.id)continue;const{x:f,y:h}=Nt(l,d,d.position,!0),g=Math.sqrt(Math.pow(f-e.x,2)+Math.pow(h-e.y,2));g>t||(g<i?(o=[{...d,x:f,y:h}],i=g):g===i&&o.push({...d,x:f,y:h}))}}if(!o.length)return null;if(o.length>1){const l=r.type==="source"?"target":"source";return o.find(u=>u.type===l)??o[0]}return o[0]}function ys(e,t,n,r,o,i=!1){var l,u,d;const s=r.get(e);if(!s)return null;const a=o==="strict"?(l=s.internals.handleBounds)==null?void 0:l[t]:[...((u=s.internals.handleBounds)==null?void 0:u.source)??[],...((d=s.internals.handleBounds)==null?void 0:d.target)??[]],c=(n?a==null?void 0:a.find(f=>f.id===n):a==null?void 0:a[0])??null;return c&&i?{...c,...Nt(s,c,c.position,!0)}:c}function xs(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function th(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const ws=()=>!0;function nh(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:o,edgeUpdaterType:i,isTarget:s,domNode:a,nodeLookup:c,lib:l,autoPanOnConnect:u,flowId:d,panBy:f,cancelConnection:h,onConnectStart:g,onConnect:p,onConnectEnd:y,isValidConnection:m=ws,onReconnectEnd:E,updateConnection:x,getTransform:w,getFromHandle:C,autoPanSpeed:I}){const N=ls(e.target);let T=0,O;const{x:j,y:z}=Ce(e),R=N==null?void 0:N.elementFromPoint(j,z),L=xs(i,R),v=a==null?void 0:a.getBoundingClientRect();if(!v||!L)return;const S=ys(o,L,r,c,t);if(!S)return;let _=Ce(e,v),P=!1,k=null,$=!1,M=null;function D(){if(!u||!v)return;const[K,J]=os(_,v,I);f({x:K,y:J}),T=requestAnimationFrame(D)}const B={...S,nodeId:o,type:L,position:S.position},X=c.get(o),H={inProgress:!0,isValid:null,from:Nt(X,B,Y.Left,!0),fromHandle:B,fromPosition:B.position,fromNode:X,to:_,toHandle:null,toPosition:ao[B.position],toNode:null};x(H);let G=H;g==null||g(e,{nodeId:o,handleId:r,handleType:L});function V(K){if(!C()||!B){W(K);return}const J=w();_=Ce(K,v),O=eh(At(_,J,!1,[1,1]),n,c,B),P||(D(),P=!0);const U=vs(K,{handle:O,connectionMode:t,fromNodeId:o,fromHandleId:r,fromType:s?"target":"source",isValidConnection:m,doc:N,lib:l,flowId:d,nodeLookup:c});M=U.handleDomNode,k=U.connection,$=th(!!O,U.isValid);const q={...G,isValid:$,to:O&&$?ss({x:O.x,y:O.y},J):_,toHandle:U.toHandle,toPosition:$&&U.toHandle?U.toHandle.position:ao[B.position],toNode:U.toHandle?c.get(U.toHandle.nodeId):null};$&&O&&G.toHandle&&q.toHandle&&G.toHandle.type===q.toHandle.type&&G.toHandle.nodeId===q.toHandle.nodeId&&G.toHandle.id===q.toHandle.id&&G.to.x===q.to.x&&G.to.y===q.to.y||(x(q),G=q)}function W(K){(O||M)&&k&&$&&(p==null||p(k));const{inProgress:J,...U}=G,q={...U,toPosition:G.toHandle?G.toPosition:null};y==null||y(K,q),i&&(E==null||E(K,q)),h(),cancelAnimationFrame(T),P=!1,$=!1,k=null,M=null,N.removeEventListener("mousemove",V),N.removeEventListener("mouseup",W),N.removeEventListener("touchmove",V),N.removeEventListener("touchend",W)}N.addEventListener("mousemove",V),N.addEventListener("mouseup",W),N.addEventListener("touchmove",V),N.addEventListener("touchend",W)}function vs(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:o,fromType:i,doc:s,lib:a,flowId:c,isValidConnection:l=ws,nodeLookup:u}){const d=i==="target",f=t?s.querySelector(`.${a}-flow__handle[data-id="${c}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:h,y:g}=Ce(e),p=s.elementFromPoint(h,g),y=p!=null&&p.classList.contains(`${a}-flow__handle`)?p:f,m={handleDomNode:y,isValid:!1,connection:null,toHandle:null};if(y){const E=xs(void 0,y),x=y.getAttribute("data-nodeid"),w=y.getAttribute("data-handleid"),C=y.classList.contains("connectable"),I=y.classList.contains("connectableend");if(!x||!E)return m;const N={source:d?x:r,sourceHandle:d?w:o,target:d?r:x,targetHandle:d?o:w};m.connection=N;const O=C&&I&&(n===Ve.Strict?d&&E==="source"||!d&&E==="target":x!==r||w!==o);m.isValid=O&&l(N),m.toHandle=ys(x,E,w,u,n,!1)}return m}const ur={onPointerDown:nh,isValid:vs};function rh({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const o=ue(e);function i({translateExtent:a,width:c,height:l,zoomStep:u=10,pannable:d=!0,zoomable:f=!0,inversePan:h=!1}){const g=x=>{const w=n();if(x.sourceEvent.type!=="wheel"||!t)return;const C=-x.sourceEvent.deltaY*(x.sourceEvent.deltaMode===1?.05:x.sourceEvent.deltaMode?1:.002)*u,I=w[2]*Math.pow(2,C);t.scaleTo(I)};let p=[0,0];const y=x=>{(x.sourceEvent.type==="mousedown"||x.sourceEvent.type==="touchstart")&&(p=[x.sourceEvent.clientX??x.sourceEvent.touches[0].clientX,x.sourceEvent.clientY??x.sourceEvent.touches[0].clientY])},m=x=>{const w=n();if(x.sourceEvent.type!=="mousemove"&&x.sourceEvent.type!=="touchmove"||!t)return;const C=[x.sourceEvent.clientX??x.sourceEvent.touches[0].clientX,x.sourceEvent.clientY??x.sourceEvent.touches[0].clientY],I=[C[0]-p[0],C[1]-p[1]];p=C;const N=r()*Math.max(w[2],Math.log(w[2]))*(h?-1:1),T={x:w[0]-I[0]*N,y:w[1]-I[1]*N},O=[[0,0],[c,l]];t.setViewportConstrained({x:T.x,y:T.y,zoom:w[2]},O,a)},E=Ui().on("start",y).on("zoom",d?m:null).on("zoom.wheel",f?g:null);o.call(E,{})}function s(){o.on("zoom",null)}return{update:i,destroy:s,pointer:ge}}const oh=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,mn=e=>({x:e.x,y:e.y,zoom:e.k}),Rn=({x:e,y:t,zoom:n})=>dn.translate(e,t).scale(n),Ge=(e,t)=>e.target.closest(`.${t}`),bs=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Dn=(e,t=0,n=()=>{})=>{const r=typeof t=="number"&&t>0;return r||n(),r?e.transition().duration(t).on("end",n):e},Es=e=>{const t=e.ctrlKey&&rn()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function ih({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:o,panOnScrollSpeed:i,zoomOnPinch:s,onPanZoomStart:a,onPanZoom:c,onPanZoomEnd:l}){return u=>{if(Ge(u,t))return!1;u.preventDefault(),u.stopImmediatePropagation();const d=n.property("__zoom").k||1;if(u.ctrlKey&&s){const y=ge(u),m=Es(u),E=d*Math.pow(2,m);r.scaleTo(n,E,y,u);return}const f=u.deltaMode===1?20:1;let h=o===Be.Vertical?0:u.deltaX*f,g=o===Be.Horizontal?0:u.deltaY*f;!rn()&&u.shiftKey&&o!==Be.Vertical&&(h=u.deltaY*f,g=0),r.translateBy(n,-(h/d)*i,-(g/d)*i,{internal:!0});const p=mn(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,a==null||a(u,p)),e.isPanScrolling&&(c==null||c(u,p),e.panScrollTimeout=setTimeout(()=>{l==null||l(u,p),e.isPanScrolling=!1},150))}}function sh({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,o){if(!t&&r.type==="wheel"&&!r.ctrlKey||Ge(r,e))return null;r.preventDefault(),n.call(this,r,o)}}function ah({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{var i,s,a;if((i=r.sourceEvent)!=null&&i.internal)return;const o=mn(r.transform);e.mouseButton=((s=r.sourceEvent)==null?void 0:s.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=o,((a=r.sourceEvent)==null?void 0:a.type)==="mousedown"&&t(!0),n&&(n==null||n(r.sourceEvent,o))}}function ch({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:o}){return i=>{var s,a;e.usedRightMouseButton=!!(n&&bs(t,e.mouseButton??0)),(s=i.sourceEvent)!=null&&s.sync||r([i.transform.x,i.transform.y,i.transform.k]),o&&!((a=i.sourceEvent)!=null&&a.internal)&&(o==null||o(i.sourceEvent,mn(i.transform)))}}function lh({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:o,onPaneContextMenu:i}){return s=>{var a;if(!((a=s.sourceEvent)!=null&&a.internal)&&(e.isZoomingOrPanning=!1,i&&bs(t,e.mouseButton??0)&&!e.usedRightMouseButton&&s.sourceEvent&&i(s.sourceEvent),e.usedRightMouseButton=!1,r(!1),o&&oh(e.prevViewport,s.transform))){const c=mn(s.transform);e.prevViewport=c,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{o==null||o(s.sourceEvent,c)},n?150:0)}}}function uh({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:o,zoomOnDoubleClick:i,userSelectionActive:s,noWheelClassName:a,noPanClassName:c,lib:l}){return u=>{var g;const d=e||t,f=n&&u.ctrlKey;if(u.button===1&&u.type==="mousedown"&&(Ge(u,`${l}-flow__node`)||Ge(u,`${l}-flow__edge`)))return!0;if(!r&&!d&&!o&&!i&&!n||s||Ge(u,a)&&u.type==="wheel"||Ge(u,c)&&(u.type!=="wheel"||o&&u.type==="wheel"&&!e)||!n&&u.ctrlKey&&u.type==="wheel")return!1;if(!n&&u.type==="touchstart"&&((g=u.touches)==null?void 0:g.length)>1)return u.preventDefault(),!1;if(!d&&!o&&!f&&u.type==="wheel"||!r&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(r)&&!r.includes(u.button)&&u.type==="mousedown")return!1;const h=Array.isArray(r)&&r.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||u.type==="wheel")&&h}}function dh({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:r,translateExtent:o,viewport:i,onPanZoom:s,onPanZoomStart:a,onPanZoomEnd:c,onDraggingChange:l}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},d=e.getBoundingClientRect(),f=Ui().clickDistance(!me(r)||r<0?0:r).scaleExtent([t,n]).translateExtent(o),h=ue(e).call(f);x({x:i.x,y:i.y,zoom:Qe(i.zoom,t,n)},[[0,0],[d.width,d.height]],o);const g=h.on("wheel.zoom"),p=h.on("dblclick.zoom");f.wheelDelta(Es);function y(R,L){return h?new Promise(v=>{f==null||f.transform(Dn(h,L==null?void 0:L.duration,()=>v(!0)),R)}):Promise.resolve(!1)}function m({noWheelClassName:R,noPanClassName:L,onPaneContextMenu:v,userSelectionActive:S,panOnScroll:_,panOnDrag:P,panOnScrollMode:k,panOnScrollSpeed:$,preventScrolling:M,zoomOnPinch:D,zoomOnScroll:B,zoomOnDoubleClick:X,zoomActivationKeyPressed:F,lib:H,onTransformChange:G}){S&&!u.isZoomingOrPanning&&E();const W=_&&!F&&!S?ih({zoomPanValues:u,noWheelClassName:R,d3Selection:h,d3Zoom:f,panOnScrollMode:k,panOnScrollSpeed:$,zoomOnPinch:D,onPanZoomStart:a,onPanZoom:s,onPanZoomEnd:c}):sh({noWheelClassName:R,preventScrolling:M,d3ZoomHandler:g});if(h.on("wheel.zoom",W,{passive:!1}),!S){const J=ah({zoomPanValues:u,onDraggingChange:l,onPanZoomStart:a});f.on("start",J);const U=ch({zoomPanValues:u,panOnDrag:P,onPaneContextMenu:!!v,onPanZoom:s,onTransformChange:G});f.on("zoom",U);const q=lh({zoomPanValues:u,panOnDrag:P,panOnScroll:_,onPaneContextMenu:v,onPanZoomEnd:c,onDraggingChange:l});f.on("end",q)}const K=uh({zoomActivationKeyPressed:F,panOnDrag:P,zoomOnScroll:B,panOnScroll:_,zoomOnDoubleClick:X,zoomOnPinch:D,userSelectionActive:S,noPanClassName:L,noWheelClassName:R,lib:H});f.filter(K),X?h.on("dblclick.zoom",p):h.on("dblclick.zoom",null)}function E(){f.on("zoom",null)}async function x(R,L,v){const S=Rn(R),_=f==null?void 0:f.constrain()(S,L,v);return _&&await y(_),new Promise(P=>P(_))}async function w(R,L){const v=Rn(R);return await y(v,L),new Promise(S=>S(v))}function C(R){if(h){const L=Rn(R),v=h.property("__zoom");(v.k!==R.zoom||v.x!==R.x||v.y!==R.y)&&(f==null||f.transform(h,L,null,{sync:!0}))}}function I(){const R=h?Ki(h.node()):{x:0,y:0,k:1};return{x:R.x,y:R.y,zoom:R.k}}function N(R,L){return h?new Promise(v=>{f==null||f.scaleTo(Dn(h,L==null?void 0:L.duration,()=>v(!0)),R)}):Promise.resolve(!1)}function T(R,L){return h?new Promise(v=>{f==null||f.scaleBy(Dn(h,L==null?void 0:L.duration,()=>v(!0)),R)}):Promise.resolve(!1)}function O(R){f==null||f.scaleExtent(R)}function j(R){f==null||f.translateExtent(R)}function z(R){const L=!me(R)||R<0?0:R;f==null||f.clickDistance(L)}return{update:m,destroy:E,setViewport:w,setViewportConstrained:x,getViewport:I,scaleTo:N,scaleBy:T,setScaleExtent:O,setTranslateExtent:j,syncViewport:C,setClickDistance:z}}var pt;(function(e){e.Line="line",e.Handle="handle"})(pt||(pt={}));function fh({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:o,affectsY:i}){const s=e-t,a=n-r,c=[s>0?1:s<0?-1:0,a>0?1:a<0?-1:0];return s&&o&&(c[0]=c[0]*-1),a&&i&&(c[1]=c[1]*-1),c}function hh(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),r=e.includes("left"),o=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:r,affectsY:o}}function Ie(e,t){return Math.max(0,t-e)}function $e(e,t){return Math.max(0,e-t)}function Bt(e,t,n){return Math.max(0,t-e,e-n)}function bo(e,t){return e?!t:t}function gh(e,t,n,r,o,i,s,a){let{affectsX:c,affectsY:l}=t;const{isHorizontal:u,isVertical:d}=t,f=u&&d,{xSnapped:h,ySnapped:g}=n,{minWidth:p,maxWidth:y,minHeight:m,maxHeight:E}=r,{x,y:w,width:C,height:I,aspectRatio:N}=e;let T=Math.floor(u?h-e.pointerX:0),O=Math.floor(d?g-e.pointerY:0);const j=C+(c?-T:T),z=I+(l?-O:O),R=-i[0]*C,L=-i[1]*I;let v=Bt(j,p,y),S=Bt(z,m,E);if(s){let k=0,$=0;c&&T<0?k=Ie(x+T+R,s[0][0]):!c&&T>0&&(k=$e(x+j+R,s[1][0])),l&&O<0?$=Ie(w+O+L,s[0][1]):!l&&O>0&&($=$e(w+z+L,s[1][1])),v=Math.max(v,k),S=Math.max(S,$)}if(a){let k=0,$=0;c&&T>0?k=$e(x+T,a[0][0]):!c&&T<0&&(k=Ie(x+j,a[1][0])),l&&O>0?$=$e(w+O,a[0][1]):!l&&O<0&&($=Ie(w+z,a[1][1])),v=Math.max(v,k),S=Math.max(S,$)}if(o){if(u){const k=Bt(j/N,m,E)*N;if(v=Math.max(v,k),s){let $=0;!c&&!l||c&&!l&&f?$=$e(w+L+j/N,s[1][1])*N:$=Ie(w+L+(c?T:-T)/N,s[0][1])*N,v=Math.max(v,$)}if(a){let $=0;!c&&!l||c&&!l&&f?$=Ie(w+j/N,a[1][1])*N:$=$e(w+(c?T:-T)/N,a[0][1])*N,v=Math.max(v,$)}}if(d){const k=Bt(z*N,p,y)/N;if(S=Math.max(S,k),s){let $=0;!c&&!l||l&&!c&&f?$=$e(x+z*N+R,s[1][0])/N:$=Ie(x+(l?O:-O)*N+R,s[0][0])/N,S=Math.max(S,$)}if(a){let $=0;!c&&!l||l&&!c&&f?$=Ie(x+z*N,a[1][0])/N:$=$e(x+(l?O:-O)*N,a[0][0])/N,S=Math.max(S,$)}}}O=O+(O<0?S:-S),T=T+(T<0?v:-v),o&&(f?j>z*N?O=(bo(c,l)?-T:T)/N:T=(bo(c,l)?-O:O)*N:u?(O=T/N,l=c):(T=O*N,c=l));const _=c?x+T:x,P=l?w+O:w;return{width:C+(c?-T:T),height:I+(l?-O:O),x:i[0]*T*(c?-1:1)+_,y:i[1]*O*(l?-1:1)+P}}const _s={width:0,height:0,x:0,y:0},ph={..._s,pointerX:0,pointerY:0,aspectRatio:1};function mh(e){return[[0,0],[e.measured.width,e.measured.height]]}function yh(e,t,n){const r=t.position.x+e.position.x,o=t.position.y+e.position.y,i=e.measured.width??0,s=e.measured.height??0,a=n[0]*i,c=n[1]*s;return[[r-a,o-c],[r+i-a,o+s-c]]}function xh({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:o}){const i=ue(e);function s({controlPosition:c,boundaries:l,keepAspectRatio:u,onResizeStart:d,onResize:f,onResizeEnd:h,shouldResize:g}){let p={..._s},y={...ph};const m=hh(c);let E,x=null,w=[],C,I,N;const T=Li().on("start",O=>{const{nodeLookup:j,transform:z,snapGrid:R,snapToGrid:L,nodeOrigin:v,paneDomNode:S}=n();if(E=j.get(t),!E)return;x=(S==null?void 0:S.getBoundingClientRect())??null;const{xSnapped:_,ySnapped:P}=gt(O.sourceEvent,{transform:z,snapGrid:R,snapToGrid:L,containerBounds:x});p={width:E.measured.width??0,height:E.measured.height??0,x:E.position.x??0,y:E.position.y??0},y={...p,pointerX:_,pointerY:P,aspectRatio:p.width/p.height},C=void 0,E.parentId&&(E.extent==="parent"||E.expandParent)&&(C=j.get(E.parentId),I=C&&E.extent==="parent"?mh(C):void 0),w=[],N=void 0;for(const[k,$]of j)if($.parentId===t&&(w.push({id:k,position:{...$.position},extent:$.extent}),$.extent==="parent"||$.expandParent)){const M=yh($,E,$.origin??v);N?N=[[Math.min(M[0][0],N[0][0]),Math.min(M[0][1],N[0][1])],[Math.max(M[1][0],N[1][0]),Math.max(M[1][1],N[1][1])]]:N=M}d==null||d(O,{...p})}).on("drag",O=>{const{transform:j,snapGrid:z,snapToGrid:R,nodeOrigin:L}=n(),v=gt(O.sourceEvent,{transform:j,snapGrid:z,snapToGrid:R,containerBounds:x}),S=[];if(!E)return;const{x:_,y:P,width:k,height:$}=p,M={},D=E.origin??L,{width:B,height:X,x:F,y:H}=gh(y,m,v,l,u,D,I,N),G=B!==k,V=X!==$,W=F!==_&&G,K=H!==P&&V;if(!W&&!K&&!G&&!V)return;if((W||K||D[0]===1||D[1]===1)&&(M.x=W?F:p.x,M.y=K?H:p.y,p.x=M.x,p.y=M.y,w.length>0)){const Q=F-_,ee=H-P;for(const se of w)se.position={x:se.position.x-Q+D[0]*(B-k),y:se.position.y-ee+D[1]*(X-$)},S.push(se)}if((G||V)&&(M.width=G?B:p.width,M.height=V?X:p.height,p.width=M.width,p.height=M.height),C&&E.expandParent){const Q=D[0]*(M.width??0);M.x&&M.x<Q&&(p.x=Q,y.x=y.x-(M.x-Q));const ee=D[1]*(M.height??0);M.y&&M.y<ee&&(p.y=ee,y.y=y.y-(M.y-ee))}const J=fh({width:p.width,prevWidth:k,height:p.height,prevHeight:$,affectsX:m.affectsX,affectsY:m.affectsY}),U={...p,direction:J};(g==null?void 0:g(O,U))!==!1&&(f==null||f(O,U),r(M,S))}).on("end",O=>{h==null||h(O,{...p}),o==null||o()});i.call(T)}function a(){i.on(".drag",null)}return{update:s,destroy:a}}var Ns={exports:{}},Cs={},Ss={exports:{}},ks={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tt=A;function wh(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var vh=typeof Object.is=="function"?Object.is:wh,bh=tt.useState,Eh=tt.useEffect,_h=tt.useLayoutEffect,Nh=tt.useDebugValue;function Ch(e,t){var n=t(),r=bh({inst:{value:n,getSnapshot:t}}),o=r[0].inst,i=r[1];return _h(function(){o.value=n,o.getSnapshot=t,zn(o)&&i({inst:o})},[e,n,t]),Eh(function(){return zn(o)&&i({inst:o}),e(function(){zn(o)&&i({inst:o})})},[e]),Nh(n),n}function zn(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!vh(e,n)}catch{return!0}}function Sh(e,t){return t()}var kh=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Sh:Ch;ks.useSyncExternalStore=tt.useSyncExternalStore!==void 0?tt.useSyncExternalStore:kh;Ss.exports=ks;var Mh=Ss.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yn=A,Ih=Mh;function $h(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ah=typeof Object.is=="function"?Object.is:$h,Ph=Ih.useSyncExternalStore,Th=yn.useRef,Oh=yn.useEffect,jh=yn.useMemo,Lh=yn.useDebugValue;Cs.useSyncExternalStoreWithSelector=function(e,t,n,r,o){var i=Th(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=jh(function(){function c(h){if(!l){if(l=!0,u=h,h=r(h),o!==void 0&&s.hasValue){var g=s.value;if(o(g,h))return d=g}return d=h}if(g=d,Ah(u,h))return g;var p=r(h);return o!==void 0&&o(g,p)?(u=h,g):(u=h,d=p)}var l=!1,u,d,f=n===void 0?null:n;return[function(){return c(t())},f===null?void 0:function(){return c(f())}]},[t,n,r,o]);var a=Ph(e,i[0],i[1]);return Oh(function(){s.hasValue=!0,s.value=a},[a]),Lh(a),a};Ns.exports=Cs;var Rh=Ns.exports;const Dh=bi(Rh),Eo=e=>{let t;const n=new Set,r=(u,d)=>{const f=typeof u=="function"?u(t):u;if(!Object.is(f,t)){const h=t;t=d??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(g=>g(t,h))}},o=()=>t,c={setState:r,getState:o,getInitialState:()=>l,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{n.clear()}},l=t=e(r,o,c);return c},zh=e=>e?Eo(e):Eo,{useDebugValue:Bh}=Kc,{useSyncExternalStoreWithSelector:Hh}=Dh,Vh=e=>e;function Ms(e,t=Vh,n){const r=Hh(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Bh(r),r}const _o=(e,t)=>{const n=zh(e),r=(o,i=t)=>Ms(n,o,i);return Object.assign(r,n),r},Fh=(e,t)=>e?_o(e,t):_o;function te(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,o]of e)if(!Object.is(o,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}const xn=A.createContext(null),Yh=xn.Provider,Is=ke.error001();function Z(e,t){const n=A.useContext(xn);if(n===null)throw new Error(Is);return Ms(n,e,t)}function ne(){const e=A.useContext(xn);if(e===null)throw new Error(Is);return A.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const No={display:"none"},Xh={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},$s="react-flow__node-desc",As="react-flow__edge-desc",Gh="react-flow__aria-live",Wh=e=>e.ariaLiveMessage;function qh({rfId:e}){const t=Z(Wh);return b.jsx("div",{id:`${Gh}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Xh,children:t})}function Kh({rfId:e,disableKeyboardA11y:t}){return b.jsxs(b.Fragment,{children:[b.jsxs("div",{id:`${$s}-${e}`,style:No,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),b.jsx("div",{id:`${As}-${e}`,style:No,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&b.jsx(qh,{rfId:e})]})}const Uh=e=>e.userSelectionActive?"none":"all",wn=A.forwardRef(({position:e="top-left",children:t,className:n,style:r,...o},i)=>{const s=Z(Uh),a=`${e}`.split("-");return b.jsx("div",{className:ie(["react-flow__panel",n,...a]),style:{...r,pointerEvents:s},ref:i,...o,children:t})});wn.displayName="Panel";function Zh({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:b.jsx(wn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:b.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const Qh=e=>{const t=[],n=[];for(const[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(const[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},Ht=e=>e.id;function Jh(e,t){return te(e.selectedNodes.map(Ht),t.selectedNodes.map(Ht))&&te(e.selectedEdges.map(Ht),t.selectedEdges.map(Ht))}function eg({onSelectionChange:e}){const t=ne(),{selectedNodes:n,selectedEdges:r}=Z(Qh,Jh);return A.useEffect(()=>{const o={nodes:n,edges:r};e==null||e(o),t.getState().onSelectionChangeHandlers.forEach(i=>i(o))},[n,r,e]),null}const tg=e=>!!e.onSelectionChangeHandlers;function ng({onSelectionChange:e}){const t=Z(tg);return e||t?b.jsx(eg,{onSelectionChange:e}):null}const Ps=[0,0],rg={x:0,y:0,zoom:1},og=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance"],Co=[...og,"rfId"],ig=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),So={translateExtent:bt,nodeOrigin:Ps,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function sg(e){const{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:o,setTranslateExtent:i,setNodeExtent:s,reset:a,setDefaultNodesAndEdges:c,setPaneClickDistance:l}=Z(ig,te),u=ne();A.useEffect(()=>(c(e.defaultNodes,e.defaultEdges),()=>{d.current=So,a()}),[]);const d=A.useRef(So);return A.useEffect(()=>{for(const f of Co){const h=e[f],g=d.current[f];h!==g&&(typeof e[f]>"u"||(f==="nodes"?t(h):f==="edges"?n(h):f==="minZoom"?r(h):f==="maxZoom"?o(h):f==="translateExtent"?i(h):f==="nodeExtent"?s(h):f==="paneClickDistance"?l(h):f==="fitView"?u.setState({fitViewOnInit:h}):f==="fitViewOptions"?u.setState({fitViewOnInitOptions:h}):u.setState({[f]:h})))}d.current=e},Co.map(f=>e[f])),null}function ko(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function ag(e){var r;const[t,n]=A.useState(e==="system"?null:e);return A.useEffect(()=>{if(e!=="system"){n(e);return}const o=ko(),i=()=>n(o!=null&&o.matches?"dark":"light");return i(),o==null||o.addEventListener("change",i),()=>{o==null||o.removeEventListener("change",i)}},[e]),t!==null?t:(r=ko())!=null&&r.matches?"dark":"light"}const Mo=typeof document<"u"?document:null;function Ct(e=null,t={target:Mo,actInsideInputWithModifier:!0}){const[n,r]=A.useState(!1),o=A.useRef(!1),i=A.useRef(new Set([])),[s,a]=A.useMemo(()=>{if(e!==null){const l=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.replace("+",`
`).replace(`

`,`
+`).split(`
`)),u=l.reduce((d,f)=>d.concat(...f),[]);return[l,u]}return[[],[]]},[e]);return A.useEffect(()=>{const c=(t==null?void 0:t.target)||Mo;if(e!==null){const l=f=>{if(o.current=f.ctrlKey||f.metaKey||f.shiftKey,(!o.current||o.current&&!t.actInsideInputWithModifier)&&sr(f))return!1;const g=$o(f.code,a);i.current.add(f[g]),Io(s,i.current,!1)&&(f.preventDefault(),r(!0))},u=f=>{if((!o.current||o.current&&!t.actInsideInputWithModifier)&&sr(f))return!1;const g=$o(f.code,a);Io(s,i.current,!0)?(r(!1),i.current.clear()):i.current.delete(f[g]),f.key==="Meta"&&i.current.clear(),o.current=!1},d=()=>{i.current.clear(),r(!1)};return c==null||c.addEventListener("keydown",l),c==null||c.addEventListener("keyup",u),window.addEventListener("blur",d),window.addEventListener("contextmenu",d),()=>{c==null||c.removeEventListener("keydown",l),c==null||c.removeEventListener("keyup",u),window.removeEventListener("blur",d),window.removeEventListener("contextmenu",d)}}},[e,r]),n}function Io(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(o=>t.has(o)))}function $o(e,t){return t.includes(e)?"code":"key"}const cg=()=>{const e=ne();return A.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:r}=e.getState();return r?r.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[r,o,i],panZoom:s}=e.getState();return s?(await s.setViewport({x:t.x??r,y:t.y??o,zoom:t.zoom??i},{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},fitView:t=>{const{nodeLookup:n,minZoom:r,maxZoom:o,panZoom:i,domNode:s}=e.getState();if(!i||!s)return Promise.resolve(!1);const a=rr(n,t),{width:c,height:l}=pn(s);return or({nodes:a,width:c,height:l,minZoom:r,maxZoom:o,panZoom:i},t)},setCenter:async(t,n,r)=>{const{width:o,height:i,maxZoom:s,panZoom:a}=e.getState(),c=typeof(r==null?void 0:r.zoom)<"u"?r.zoom:s,l=o/2-t*c,u=i/2-n*c;return a?(await a.setViewport({x:l,y:u,zoom:c},{duration:r==null?void 0:r.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitBounds:async(t,n)=>{const{width:r,height:o,minZoom:i,maxZoom:s,panZoom:a}=e.getState(),c=_r(t,r,o,i,s,(n==null?void 0:n.padding)??.1);return a?(await a.setViewport(c,{duration:n==null?void 0:n.duration}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:r,snapGrid:o,snapToGrid:i,domNode:s}=e.getState();if(!s)return t;const{x:a,y:c}=s.getBoundingClientRect(),l={x:t.x-a,y:t.y-c},u=n.snapGrid??o,d=n.snapToGrid??i;return At(l,r,d,u)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:o,y:i}=r.getBoundingClientRect(),s=ss(t,n);return{x:s.x+o,y:s.y+i}}}),[])};function Ts(e,t){const n=[],r=new Map,o=[];for(const i of e)if(i.type==="add"){o.push(i);continue}else if(i.type==="remove"||i.type==="replace")r.set(i.id,[i]);else{const s=r.get(i.id);s?s.push(i):r.set(i.id,[i])}for(const i of t){const s=r.get(i.id);if(!s){n.push(i);continue}if(s[0].type==="remove")continue;if(s[0].type==="replace"){n.push({...s[0].item});continue}const a={...i};for(const c of s)lg(c,a);n.push(a)}return o.length&&o.forEach(i=>{i.index!==void 0?n.splice(i.index,0,{...i.item}):n.push({...i.item})}),n}function lg(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&(t.width=e.dimensions.width,t.height=e.dimensions.height)),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Os(e,t){return Ts(e,t)}function js(e,t){return Ts(e,t)}function Re(e,t){return{id:e,type:"select",selected:t}}function We(e,t=new Set,n=!1){const r=[];for(const[o,i]of e){const s=t.has(o);!(i.selected===void 0&&!s)&&i.selected!==s&&(n&&(i.selected=s),r.push(Re(i.id,s)))}return r}function Ao({items:e=[],lookup:t}){var o;const n=[],r=new Map(e.map(i=>[i.id,i]));for(const[i,s]of e.entries()){const a=t.get(s.id),c=((o=a==null?void 0:a.internals)==null?void 0:o.userNode)??a;c!==void 0&&c!==s&&n.push({id:s.id,item:s,type:"replace"}),c===void 0&&n.push({item:s,type:"add",index:i})}for(const[i]of t)r.get(i)===void 0&&n.push({id:i,type:"remove"});return n}function Po(e){return{id:e.id,type:"remove"}}const To=e=>Mf(e),ug=e=>es(e);function Ls(e){return A.forwardRef(e)}const dg=typeof window<"u"?A.useLayoutEffect:A.useEffect;function Oo(e){const[t,n]=A.useState(BigInt(0)),[r]=A.useState(()=>fg(()=>n(o=>o+BigInt(1))));return dg(()=>{const o=r.get();o.length&&(e(o),r.reset())},[t]),r}function fg(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const Rs=A.createContext(null);function hg({children:e}){const t=ne(),n=A.useCallback(a=>{const{nodes:c=[],setNodes:l,hasDefaultNodes:u,onNodesChange:d,nodeLookup:f}=t.getState();let h=c;for(const g of a)h=typeof g=="function"?g(h):g;u?l(h):d&&d(Ao({items:h,lookup:f}))},[]),r=Oo(n),o=A.useCallback(a=>{const{edges:c=[],setEdges:l,hasDefaultEdges:u,onEdgesChange:d,edgeLookup:f}=t.getState();let h=c;for(const g of a)h=typeof g=="function"?g(h):g;u?l(h):d&&d(Ao({items:h,lookup:f}))},[]),i=Oo(o),s=A.useMemo(()=>({nodeQueue:r,edgeQueue:i}),[]);return b.jsx(Rs.Provider,{value:s,children:e})}function gg(){const e=A.useContext(Rs);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const pg=e=>!!e.panZoom;function vn(){const e=cg(),t=ne(),n=gg(),r=Z(pg),o=A.useMemo(()=>{const i=d=>t.getState().nodeLookup.get(d),s=d=>{n.nodeQueue.push(d)},a=d=>{n.edgeQueue.push(d)},c=d=>{var m,E;const{nodeLookup:f,nodeOrigin:h}=t.getState(),g=To(d)?d:f.get(d.id),p=g.parentId?cs(g.position,g.measured,g.parentId,f,h):g.position,y={...g,position:p,width:((m=g.measured)==null?void 0:m.width)??g.width,height:((E=g.measured)==null?void 0:E.height)??g.height};return Je(y)},l=(d,f,h={replace:!1})=>{s(g=>g.map(p=>{if(p.id===d){const y=typeof f=="function"?f(p):f;return h.replace&&To(y)?y:{...p,...y}}return p}))},u=(d,f,h={replace:!1})=>{a(g=>g.map(p=>{if(p.id===d){const y=typeof f=="function"?f(p):f;return h.replace&&ug(y)?y:{...p,...y}}return p}))};return{getNodes:()=>t.getState().nodes.map(d=>({...d})),getNode:d=>{var f;return(f=i(d))==null?void 0:f.internals.userNode},getInternalNode:i,getEdges:()=>{const{edges:d=[]}=t.getState();return d.map(f=>({...f}))},getEdge:d=>t.getState().edgeLookup.get(d),setNodes:s,setEdges:a,addNodes:d=>{const f=Array.isArray(d)?d:[d];n.nodeQueue.push(h=>[...h,...f])},addEdges:d=>{const f=Array.isArray(d)?d:[d];n.edgeQueue.push(h=>[...h,...f])},toObject:()=>{const{nodes:d=[],edges:f=[],transform:h}=t.getState(),[g,p,y]=h;return{nodes:d.map(m=>({...m})),edges:f.map(m=>({...m})),viewport:{x:g,y:p,zoom:y}}},deleteElements:async({nodes:d=[],edges:f=[]})=>{const{nodes:h,edges:g,onNodesDelete:p,onEdgesDelete:y,triggerNodeChanges:m,triggerEdgeChanges:E,onDelete:x,onBeforeDelete:w}=t.getState(),{nodes:C,edges:I}=await Af({nodesToRemove:d,edgesToRemove:f,nodes:h,edges:g,onBeforeDelete:w}),N=I.length>0,T=C.length>0;if(N){const O=I.map(Po);y==null||y(I),E(O)}if(T){const O=C.map(Po);p==null||p(C),m(O)}return(T||N)&&(x==null||x({nodes:C,edges:I})),{deletedNodes:C,deletedEdges:I}},getIntersectingNodes:(d,f=!0,h)=>{const g=lo(d),p=g?d:c(d),y=h!==void 0;return p?(h||t.getState().nodes).filter(m=>{const E=t.getState().nodeLookup.get(m.id);if(E&&!g&&(m.id===d.id||!E.internals.positionAbsolute))return!1;const x=Je(y?m:E),w=_t(x,p);return f&&w>0||w>=p.width*p.height}):[]},isNodeIntersecting:(d,f,h=!0)=>{const p=lo(d)?d:c(d);if(!p)return!1;const y=_t(p,f);return h&&y>0||y>=p.width*p.height},updateNode:l,updateNodeData:(d,f,h={replace:!1})=>{l(d,g=>{const p=typeof f=="function"?f(g):f;return h.replace?{...g,data:p}:{...g,data:{...g.data,...p}}},h)},updateEdge:u,updateEdgeData:(d,f,h={replace:!1})=>{u(d,g=>{const p=typeof f=="function"?f(g):f;return h.replace?{...g,data:p}:{...g,data:{...g.data,...p}}},h)},getNodesBounds:d=>{const{nodeLookup:f,nodeOrigin:h}=t.getState();return If(d,{nodeLookup:f,nodeOrigin:h})},getHandleConnections:({type:d,id:f,nodeId:h})=>{var g;return Array.from(((g=t.getState().connectionLookup.get(`${h}-${d}${f?`-${f}`:""}`))==null?void 0:g.values())??[])},getNodeConnections:({type:d,handleId:f,nodeId:h})=>{var g;return Array.from(((g=t.getState().connectionLookup.get(`${h}${d?f?`-${d}-${f}`:`-${d}`:""}`))==null?void 0:g.values())??[])}}},[]);return A.useMemo(()=>({...o,...e,viewportInitialized:r}),[r])}const jo=e=>e.selected,mg={actInsideInputWithModifier:!1},yg=typeof window<"u"?window:void 0;function xg({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=ne(),{deleteElements:r}=vn(),o=Ct(e,mg),i=Ct(t,{target:yg});A.useEffect(()=>{if(o){const{edges:s,nodes:a}=n.getState();r({nodes:a.filter(jo),edges:s.filter(jo)}),n.setState({nodesSelectionActive:!1})}},[o]),A.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])}function wg(e){const t=ne();A.useEffect(()=>{const n=()=>{var o,i;if(!e.current)return!1;const r=pn(e.current);(r.height===0||r.width===0)&&((i=(o=t.getState()).onError)==null||i.call(o,"004",ke.error004())),t.setState({width:r.width||500,height:r.height||500})};if(e.current){n(),window.addEventListener("resize",n);const r=new ResizeObserver(()=>n());return r.observe(e.current),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}}},[])}const bn={position:"absolute",width:"100%",height:"100%",top:0,left:0},vg=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function bg({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:o=.5,panOnScrollMode:i=Be.Free,zoomOnDoubleClick:s=!0,panOnDrag:a=!0,defaultViewport:c,translateExtent:l,minZoom:u,maxZoom:d,zoomActivationKeyCode:f,preventScrolling:h=!0,children:g,noWheelClassName:p,noPanClassName:y,onViewportChange:m,isControlledViewport:E,paneClickDistance:x}){const w=ne(),C=A.useRef(null),{userSelectionActive:I,lib:N}=Z(vg,te),T=Ct(f),O=A.useRef();wg(C);const j=A.useCallback(z=>{m==null||m({x:z[0],y:z[1],zoom:z[2]}),E||w.setState({transform:z})},[m,E]);return A.useEffect(()=>{if(C.current){O.current=dh({domNode:C.current,minZoom:u,maxZoom:d,translateExtent:l,viewport:c,paneClickDistance:x,onDraggingChange:v=>w.setState({paneDragging:v}),onPanZoomStart:(v,S)=>{const{onViewportChangeStart:_,onMoveStart:P}=w.getState();P==null||P(v,S),_==null||_(S)},onPanZoom:(v,S)=>{const{onViewportChange:_,onMove:P}=w.getState();P==null||P(v,S),_==null||_(S)},onPanZoomEnd:(v,S)=>{const{onViewportChangeEnd:_,onMoveEnd:P}=w.getState();P==null||P(v,S),_==null||_(S)}});const{x:z,y:R,zoom:L}=O.current.getViewport();return w.setState({panZoom:O.current,transform:[z,R,L],domNode:C.current.closest(".react-flow")}),()=>{var v;(v=O.current)==null||v.destroy()}}},[]),A.useEffect(()=>{var z;(z=O.current)==null||z.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:o,panOnScrollMode:i,zoomOnDoubleClick:s,panOnDrag:a,zoomActivationKeyPressed:T,preventScrolling:h,noPanClassName:y,userSelectionActive:I,noWheelClassName:p,lib:N,onTransformChange:j})},[e,t,n,r,o,i,s,a,T,h,y,I,p,N,j]),b.jsx("div",{className:"react-flow__renderer",ref:C,style:bn,children:g})}const Eg=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function _g(){const{userSelectionActive:e,userSelectionRect:t}=Z(Eg,te);return e&&t?b.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const Bn=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},Ng=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging});function Cg({isSelecting:e,selectionKeyPressed:t,selectionMode:n=Et.Full,panOnDrag:r,selectionOnDrag:o,onSelectionStart:i,onSelectionEnd:s,onPaneClick:a,onPaneContextMenu:c,onPaneScroll:l,onPaneMouseEnter:u,onPaneMouseMove:d,onPaneMouseLeave:f,children:h}){const g=ne(),{userSelectionActive:p,elementsSelectable:y,dragging:m}=Z(Ng,te),E=y&&(e||p),x=A.useRef(null),w=A.useRef(),C=A.useRef(new Set),I=A.useRef(new Set),N=A.useRef(!1),T=A.useRef(!1),O=_=>{if(N.current){N.current=!1;return}a==null||a(_),g.getState().resetSelectedElements(),g.setState({nodesSelectionActive:!1})},j=_=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){_.preventDefault();return}c==null||c(_)},z=l?_=>l(_):void 0,R=_=>{var D,B;const{resetSelectedElements:P,domNode:k}=g.getState();if(w.current=k==null?void 0:k.getBoundingClientRect(),!y||!e||_.button!==0||_.target!==x.current||!w.current)return;(B=(D=_.target)==null?void 0:D.setPointerCapture)==null||B.call(D,_.pointerId),T.current=!0,N.current=!1;const{x:$,y:M}=Ce(_.nativeEvent,w.current);P(),g.setState({userSelectionRect:{width:0,height:0,startX:$,startY:M,x:$,y:M}}),i==null||i(_)},L=_=>{const{userSelectionRect:P,transform:k,nodeLookup:$,edgeLookup:M,connectionLookup:D,triggerNodeChanges:B,triggerEdgeChanges:X,defaultEdgeOptions:F}=g.getState();if(!w.current||!P)return;N.current=!0;const{x:H,y:G}=Ce(_.nativeEvent,w.current),{startX:V,startY:W}=P,K={startX:V,startY:W,x:H<V?H:V,y:G<W?G:W,width:Math.abs(H-V),height:Math.abs(G-W)},J=C.current,U=I.current;C.current=new Set(ts($,K,k,n===Et.Partial,!0).map(Q=>Q.id)),I.current=new Set;const q=(F==null?void 0:F.selectable)??!0;for(const Q of C.current){const ee=D.get(Q);if(ee)for(const{edgeId:se}of ee.values()){const he=M.get(se);he&&(he.selectable??q)&&I.current.add(se)}}if(!uo(J,C.current)){const Q=We($,C.current,!0);B(Q)}if(!uo(U,I.current)){const Q=We(M,I.current);X(Q)}g.setState({userSelectionRect:K,userSelectionActive:!0,nodesSelectionActive:!1})},v=_=>{var k,$;if(_.button!==0||!T.current)return;($=(k=_.target)==null?void 0:k.releasePointerCapture)==null||$.call(k,_.pointerId);const{userSelectionRect:P}=g.getState();!p&&P&&_.target===x.current&&(O==null||O(_)),g.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:C.current.size>0}),s==null||s(_),(t||o)&&(N.current=!1),T.current=!1},S=r===!0||Array.isArray(r)&&r.includes(0);return b.jsxs("div",{className:ie(["react-flow__pane",{draggable:S,dragging:m,selection:e}]),onClick:E?void 0:Bn(O,x),onContextMenu:Bn(j,x),onWheel:Bn(z,x),onPointerEnter:E?void 0:u,onPointerDown:E?R:d,onPointerMove:E?L:d,onPointerUp:E?v:void 0,onPointerLeave:f,ref:x,style:bn,children:[h,b.jsx(_g,{})]})}function dr({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:o,unselectNodesAndEdges:i,multiSelectionActive:s,nodeLookup:a,onError:c}=t.getState(),l=a.get(e);if(!l){c==null||c("012",ke.error012(e));return}t.setState({nodesSelectionActive:!1}),l.selected?(n||l.selected&&s)&&(i({nodes:[l],edges:[]}),requestAnimationFrame(()=>{var u;return(u=r==null?void 0:r.current)==null?void 0:u.blur()})):o([e])}function Ds({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:o,isSelectable:i,nodeClickDistance:s}){const a=ne(),[c,l]=A.useState(!1),u=A.useRef();return A.useEffect(()=>{u.current=Zf({getStoreItems:()=>a.getState(),onNodeMouseDown:d=>{dr({id:d,store:a,nodeRef:e})},onDragStart:()=>{l(!0)},onDragStop:()=>{l(!1)}})},[]),A.useEffect(()=>{var d,f;if(t)(d=u.current)==null||d.destroy();else if(e.current)return(f=u.current)==null||f.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:i,nodeId:o,nodeClickDistance:s}),()=>{var h;(h=u.current)==null||h.destroy()}},[n,r,t,i,e,o]),c}const Sg=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function zs(){const e=ne();return A.useCallback(n=>{const{nodeExtent:r,snapToGrid:o,snapGrid:i,nodesDraggable:s,onError:a,updateNodePositions:c,nodeLookup:l,nodeOrigin:u}=e.getState(),d=new Map,f=Sg(s),h=o?i[0]:5,g=o?i[1]:5,p=n.direction.x*h*n.factor,y=n.direction.y*g*n.factor;for(const[,m]of l){if(!f(m))continue;let E={x:m.internals.positionAbsolute.x+p,y:m.internals.positionAbsolute.y+y};o&&(E=gn(E,i));const{position:x,positionAbsolute:w}=ns({nodeId:m.id,nextPosition:E,nodeLookup:l,nodeExtent:r,nodeOrigin:u,onError:a});m.position=x,m.internals.positionAbsolute=w,d.set(m.id,m)}c(d)},[])}const Ir=A.createContext(null),kg=Ir.Provider;Ir.Consumer;const Bs=()=>A.useContext(Ir),Mg=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),Ig=(e,t,n)=>r=>{const{connectionClickStartHandle:o,connectionMode:i,connection:s}=r,{fromHandle:a,toHandle:c,isValid:l}=s,u=(c==null?void 0:c.nodeId)===e&&(c==null?void 0:c.id)===t&&(c==null?void 0:c.type)===n;return{connectingFrom:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.id)===t&&(a==null?void 0:a.type)===n,connectingTo:u,clickConnecting:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.id)===t&&(o==null?void 0:o.type)===n,isPossibleEndHandle:i===Ve.Strict?(a==null?void 0:a.type)!==n:e!==(a==null?void 0:a.nodeId)||t!==(a==null?void 0:a.id),connectionInProcess:!!a,valid:u&&l}};function $g({type:e="source",position:t=Y.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:o=!0,isConnectableEnd:i=!0,id:s,onConnect:a,children:c,className:l,onMouseDown:u,onTouchStart:d,...f},h){var v,S;const g=s||null,p=e==="target",y=ne(),m=Bs(),{connectOnClick:E,noPanClassName:x,rfId:w}=Z(Mg,te),{connectingFrom:C,connectingTo:I,clickConnecting:N,isPossibleEndHandle:T,connectionInProcess:O,valid:j}=Z(Ig(m,g,e),te);m||(S=(v=y.getState()).onError)==null||S.call(v,"010",ke.error010());const z=_=>{const{defaultEdgeOptions:P,onConnect:k,hasDefaultEdges:$}=y.getState(),M={...P,..._};if($){const{edges:D,setEdges:B}=y.getState();B(Df(M,D))}k==null||k(M),a==null||a(M)},R=_=>{if(!m)return;const P=us(_.nativeEvent);if(o&&(P&&_.button===0||!P)){const k=y.getState();ur.onPointerDown(_.nativeEvent,{autoPanOnConnect:k.autoPanOnConnect,connectionMode:k.connectionMode,connectionRadius:k.connectionRadius,domNode:k.domNode,nodeLookup:k.nodeLookup,lib:k.lib,isTarget:p,handleId:g,nodeId:m,flowId:k.rfId,panBy:k.panBy,cancelConnection:k.cancelConnection,onConnectStart:k.onConnectStart,onConnectEnd:k.onConnectEnd,updateConnection:k.updateConnection,onConnect:z,isValidConnection:n||k.isValidConnection,getTransform:()=>y.getState().transform,getFromHandle:()=>y.getState().connection.fromHandle,autoPanSpeed:k.autoPanSpeed})}P?u==null||u(_):d==null||d(_)},L=_=>{const{onClickConnectStart:P,onClickConnectEnd:k,connectionClickStartHandle:$,connectionMode:M,isValidConnection:D,lib:B,rfId:X,nodeLookup:F,connection:H}=y.getState();if(!m||!$&&!o)return;if(!$){P==null||P(_.nativeEvent,{nodeId:m,handleId:g,handleType:e}),y.setState({connectionClickStartHandle:{nodeId:m,type:e,id:g}});return}const G=ls(_.target),V=n||D,{connection:W,isValid:K}=ur.isValid(_.nativeEvent,{handle:{nodeId:m,id:g,type:e},connectionMode:M,fromNodeId:$.nodeId,fromHandleId:$.id||null,fromType:$.type,isValidConnection:V,flowId:X,doc:G,lib:B,nodeLookup:F});K&&W&&z(W);const J=structuredClone(H);delete J.inProgress,J.toPosition=J.toHandle?J.toHandle.position:null,k==null||k(_,J),y.setState({connectionClickStartHandle:null})};return b.jsx("div",{"data-handleid":g,"data-nodeid":m,"data-handlepos":t,"data-id":`${w}-${m}-${g}-${e}`,className:ie(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",x,l,{source:!p,target:p,connectable:r,connectablestart:o,connectableend:i,clickconnecting:N,connectingfrom:C,connectingto:I,valid:j,connectionindicator:r&&(!O||T)&&(O?i:o)}]),onMouseDown:R,onTouchStart:R,onClick:E?L:void 0,ref:h,...f,children:c})}const nt=A.memo(Ls($g));function Ag({data:e,isConnectable:t,sourcePosition:n=Y.Bottom}){return b.jsxs(b.Fragment,{children:[e==null?void 0:e.label,b.jsx(nt,{type:"source",position:n,isConnectable:t})]})}function Pg({data:e,isConnectable:t,targetPosition:n=Y.Top,sourcePosition:r=Y.Bottom}){return b.jsxs(b.Fragment,{children:[b.jsx(nt,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,b.jsx(nt,{type:"source",position:r,isConnectable:t})]})}function Tg(){return null}function Og({data:e,isConnectable:t,targetPosition:n=Y.Top}){return b.jsxs(b.Fragment,{children:[b.jsx(nt,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const on={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Lo={input:Ag,default:Pg,output:Og,group:Tg};function jg(e){var t,n,r,o;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((r=e.style)==null?void 0:r.width),height:e.height??((o=e.style)==null?void 0:o.height)}}const Lg=e=>{const{width:t,height:n,x:r,y:o}=$t(e.nodeLookup,{filter:i=>!!i.selected});return{width:me(t)?t:null,height:me(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${o}px)`}};function Rg({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=ne(),{width:o,height:i,transformString:s,userSelectionActive:a}=Z(Lg,te),c=zs(),l=A.useRef(null);if(A.useEffect(()=>{var f;n||(f=l.current)==null||f.focus({preventScroll:!0})},[n]),Ds({nodeRef:l}),a||!o||!i)return null;const u=e?f=>{const h=r.getState().nodes.filter(g=>g.selected);e(f,h)}:void 0,d=f=>{Object.prototype.hasOwnProperty.call(on,f.key)&&(f.preventDefault(),c({direction:on[f.key],factor:f.shiftKey?4:1}))};return b.jsx("div",{className:ie(["react-flow__nodesselection","react-flow__container",t]),style:{transform:s},children:b.jsx("div",{ref:l,className:"react-flow__nodesselection-rect",onContextMenu:u,tabIndex:n?void 0:-1,onKeyDown:n?void 0:d,style:{width:o,height:i}})})}const Ro=typeof window<"u"?window:void 0,Dg=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function Hs({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:s,paneClickDistance:a,deleteKeyCode:c,selectionKeyCode:l,selectionOnDrag:u,selectionMode:d,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:g,panActivationKeyCode:p,zoomActivationKeyCode:y,elementsSelectable:m,zoomOnScroll:E,zoomOnPinch:x,panOnScroll:w,panOnScrollSpeed:C,panOnScrollMode:I,zoomOnDoubleClick:N,panOnDrag:T,defaultViewport:O,translateExtent:j,minZoom:z,maxZoom:R,preventScrolling:L,onSelectionContextMenu:v,noWheelClassName:S,noPanClassName:_,disableKeyboardA11y:P,onViewportChange:k,isControlledViewport:$}){const{nodesSelectionActive:M,userSelectionActive:D}=Z(Dg),B=Ct(l,{target:Ro}),X=Ct(p,{target:Ro}),F=X||T,H=X||w,G=u&&F!==!0,V=B||D||G;return xg({deleteKeyCode:c,multiSelectionKeyCode:g}),b.jsx(bg,{onPaneContextMenu:i,elementsSelectable:m,zoomOnScroll:E,zoomOnPinch:x,panOnScroll:H,panOnScrollSpeed:C,panOnScrollMode:I,zoomOnDoubleClick:N,panOnDrag:!B&&F,defaultViewport:O,translateExtent:j,minZoom:z,maxZoom:R,zoomActivationKeyCode:y,preventScrolling:L,noWheelClassName:S,noPanClassName:_,onViewportChange:k,isControlledViewport:$,paneClickDistance:a,children:b.jsxs(Cg,{onSelectionStart:f,onSelectionEnd:h,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:s,panOnDrag:F,isSelecting:!!V,selectionMode:d,selectionKeyPressed:B,selectionOnDrag:G,children:[e,M&&b.jsx(Rg,{onSelectionContextMenu:v,noPanClassName:_,disableKeyboardA11y:P})]})})}Hs.displayName="FlowRenderer";const zg=A.memo(Hs),Bg=e=>t=>e?ts(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function Hg(e){return Z(A.useCallback(Bg(e),[e]),te)}const Vg=e=>e.updateNodeInternals;function Fg(){const e=Z(Vg),[t]=A.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const r=new Map;n.forEach(o=>{const i=o.target.getAttribute("data-id");r.set(i,{id:i,nodeElement:o.target,force:!0})}),e(r)}));return A.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function Yg({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){const o=ne(),i=A.useRef(null),s=A.useRef(null),a=A.useRef(e.sourcePosition),c=A.useRef(e.targetPosition),l=A.useRef(t),u=n&&!!e.internals.handleBounds;return A.useEffect(()=>{i.current&&!e.hidden&&(!u||s.current!==i.current)&&(s.current&&(r==null||r.unobserve(s.current)),r==null||r.observe(i.current),s.current=i.current)},[u,e.hidden]),A.useEffect(()=>()=>{s.current&&(r==null||r.unobserve(s.current),s.current=null)},[]),A.useEffect(()=>{if(i.current){const d=l.current!==t,f=a.current!==e.sourcePosition,h=c.current!==e.targetPosition;(d||f||h)&&(l.current=t,a.current=e.sourcePosition,c.current=e.targetPosition,o.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:i.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),i}function Xg({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:o,onContextMenu:i,onDoubleClick:s,nodesDraggable:a,elementsSelectable:c,nodesConnectable:l,nodesFocusable:u,resizeObserver:d,noDragClassName:f,noPanClassName:h,disableKeyboardA11y:g,rfId:p,nodeTypes:y,nodeClickDistance:m,onError:E}){const{node:x,internals:w,isParent:C}=Z(V=>{const W=V.nodeLookup.get(e),K=V.parentLookup.has(e);return{node:W,internals:W.internals,isParent:K}},te);let I=x.type||"default",N=(y==null?void 0:y[I])||Lo[I];N===void 0&&(E==null||E("003",ke.error003(I)),I="default",N=Lo.default);const T=!!(x.draggable||a&&typeof x.draggable>"u"),O=!!(x.selectable||c&&typeof x.selectable>"u"),j=!!(x.connectable||l&&typeof x.connectable>"u"),z=!!(x.focusable||u&&typeof x.focusable>"u"),R=ne(),L=as(x),v=Yg({node:x,nodeType:I,hasDimensions:L,resizeObserver:d}),S=Ds({nodeRef:v,disabled:x.hidden||!T,noDragClassName:f,handleSelector:x.dragHandle,nodeId:e,isSelectable:O,nodeClickDistance:m}),_=zs();if(x.hidden)return null;const P=Me(x),k=jg(x),$=O||T||t||n||r||o,M=n?V=>n(V,{...w.userNode}):void 0,D=r?V=>r(V,{...w.userNode}):void 0,B=o?V=>o(V,{...w.userNode}):void 0,X=i?V=>i(V,{...w.userNode}):void 0,F=s?V=>s(V,{...w.userNode}):void 0,H=V=>{const{selectNodesOnDrag:W,nodeDragThreshold:K}=R.getState();O&&(!W||!T||K>0)&&dr({id:e,store:R,nodeRef:v}),t&&t(V,{...w.userNode})},G=V=>{if(!(sr(V.nativeEvent)||g))if(Zi.includes(V.key)&&O){const W=V.key==="Escape";dr({id:e,store:R,unselect:W,nodeRef:v})}else T&&x.selected&&Object.prototype.hasOwnProperty.call(on,V.key)&&(V.preventDefault(),R.setState({ariaLiveMessage:`Moved selected node ${V.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~w.positionAbsolute.x}, y: ${~~w.positionAbsolute.y}`}),_({direction:on[V.key],factor:V.shiftKey?4:1}))};return b.jsx("div",{className:ie(["react-flow__node",`react-flow__node-${I}`,{[h]:T},x.className,{selected:x.selected,selectable:O,parent:C,draggable:T,dragging:S}]),ref:v,style:{zIndex:w.z,transform:`translate(${w.positionAbsolute.x}px,${w.positionAbsolute.y}px)`,pointerEvents:$?"all":"none",visibility:L?"visible":"hidden",...x.style,...k},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:M,onMouseMove:D,onMouseLeave:B,onContextMenu:X,onClick:H,onDoubleClick:F,onKeyDown:z?G:void 0,tabIndex:z?0:void 0,role:z?"button":void 0,"aria-describedby":g?void 0:`${$s}-${p}`,"aria-label":x.ariaLabel,children:b.jsx(kg,{value:e,children:b.jsx(N,{id:e,data:x.data,type:I,positionAbsoluteX:w.positionAbsolute.x,positionAbsoluteY:w.positionAbsolute.y,selected:x.selected??!1,selectable:O,draggable:T,deletable:x.deletable??!0,isConnectable:j,sourcePosition:x.sourcePosition,targetPosition:x.targetPosition,dragging:S,dragHandle:x.dragHandle,zIndex:w.z,parentId:x.parentId,...P})})})}const Gg=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function Vs(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,onError:i}=Z(Gg,te),s=Hg(e.onlyRenderVisibleElements),a=Fg();return b.jsx("div",{className:"react-flow__nodes",style:bn,children:s.map(c=>b.jsx(Xg,{id:c,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,nodeClickDistance:e.nodeClickDistance,onError:i},c))})}Vs.displayName="NodeRenderer";const Wg=A.memo(Vs);function qg(e){return Z(A.useCallback(n=>{if(!e)return n.edges.map(o=>o.id);const r=[];if(n.width&&n.height)for(const o of n.edges){const i=n.nodeLookup.get(o.source),s=n.nodeLookup.get(o.target);i&&s&&jf({sourceNode:i,targetNode:s,width:n.width,height:n.height,transform:n.transform})&&r.push(o.id)}return r},[e]),te)}const Kg=({color:e="none",strokeWidth:t=1})=>b.jsx("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),Ug=({color:e="none",strokeWidth:t=1})=>b.jsx("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Do={[tn.Arrow]:Kg,[tn.ArrowClosed]:Ug};function Zg(e){const t=ne();return A.useMemo(()=>{var o,i;return Object.prototype.hasOwnProperty.call(Do,e)?Do[e]:((i=(o=t.getState()).onError)==null||i.call(o,"009",ke.error009(e)),null)},[e])}const Qg=({id:e,type:t,color:n,width:r=12.5,height:o=12.5,markerUnits:i="strokeWidth",strokeWidth:s,orient:a="auto-start-reverse"})=>{const c=Zg(t);return c?b.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${o}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:a,refX:"0",refY:"0",children:b.jsx(c,{color:n,strokeWidth:s})}):null},Fs=({defaultColor:e,rfId:t})=>{const n=Z(i=>i.edges),r=Z(i=>i.defaultEdgeOptions),o=A.useMemo(()=>Ff(n,{id:t,defaultColor:e,defaultMarkerStart:r==null?void 0:r.markerStart,defaultMarkerEnd:r==null?void 0:r.markerEnd}),[n,r,t,e]);return o.length?b.jsx("svg",{className:"react-flow__marker",children:b.jsx("defs",{children:o.map(i=>b.jsx(Qg,{id:i.id,type:i.type,color:i.color,width:i.width,height:i.height,markerUnits:i.markerUnits,strokeWidth:i.strokeWidth,orient:i.orient},i.id))})}):null};Fs.displayName="MarkerDefinitions";var Jg=A.memo(Fs);function Ys({x:e,y:t,label:n,labelStyle:r={},labelShowBg:o=!0,labelBgStyle:i={},labelBgPadding:s=[2,4],labelBgBorderRadius:a=2,children:c,className:l,...u}){const[d,f]=A.useState({x:1,y:0,width:0,height:0}),h=ie(["react-flow__edge-textwrapper",l]),g=A.useRef(null);return A.useEffect(()=>{if(g.current){const p=g.current.getBBox();f({x:p.x,y:p.y,width:p.width,height:p.height})}},[n]),typeof n>"u"||!n?null:b.jsxs("g",{transform:`translate(${e-d.width/2} ${t-d.height/2})`,className:h,visibility:d.width?"visible":"hidden",...u,children:[o&&b.jsx("rect",{width:d.width+2*s[0],x:-s[0],y:-s[1],height:d.height+2*s[1],className:"react-flow__edge-textbg",style:i,rx:a,ry:a}),b.jsx("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:g,style:r,children:n}),c]})}Ys.displayName="EdgeText";const ep=A.memo(Ys);function En({path:e,labelX:t,labelY:n,label:r,labelStyle:o,labelShowBg:i,labelBgStyle:s,labelBgPadding:a,labelBgBorderRadius:c,interactionWidth:l=20,...u}){return b.jsxs(b.Fragment,{children:[b.jsx("path",{...u,d:e,fill:"none",className:ie(["react-flow__edge-path",u.className])}),l&&b.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:l,className:"react-flow__edge-interaction"}),r&&me(t)&&me(n)?b.jsx(ep,{x:t,y:n,label:r,labelStyle:o,labelShowBg:i,labelBgStyle:s,labelBgPadding:a,labelBgBorderRadius:c}):null]})}function zo({pos:e,x1:t,y1:n,x2:r,y2:o}){return e===Y.Left||e===Y.Right?[.5*(t+r),n]:[t,.5*(n+o)]}function Xs({sourceX:e,sourceY:t,sourcePosition:n=Y.Bottom,targetX:r,targetY:o,targetPosition:i=Y.Top}){const[s,a]=zo({pos:n,x1:e,y1:t,x2:r,y2:o}),[c,l]=zo({pos:i,x1:r,y1:o,x2:e,y2:t}),[u,d,f,h]=ds({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:s,sourceControlY:a,targetControlX:c,targetControlY:l});return[`M${e},${t} C${s},${a} ${c},${l} ${r},${o}`,u,d,f,h]}function Gs(e){return A.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:i,sourcePosition:s=Y.Bottom,targetPosition:a=Y.Top,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:g,markerEnd:p,markerStart:y,interactionWidth:m})=>{const[E,x,w]=Xs({sourceX:n,sourceY:r,sourcePosition:s,targetX:o,targetY:i,targetPosition:a}),C=e.isInternal?void 0:t;return b.jsx(En,{id:C,path:E,labelX:x,labelY:w,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:g,markerEnd:p,markerStart:y,interactionWidth:m})})}const tp=Gs({isInternal:!1}),Ws=Gs({isInternal:!0});tp.displayName="SimpleBezierEdge";Ws.displayName="SimpleBezierEdgeInternal";function qs(e){return A.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:i,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,sourcePosition:h=Y.Bottom,targetPosition:g=Y.Top,markerEnd:p,markerStart:y,pathOptions:m,interactionWidth:E})=>{const[x,w,C]=ar({sourceX:n,sourceY:r,sourcePosition:h,targetX:o,targetY:i,targetPosition:g,borderRadius:m==null?void 0:m.borderRadius,offset:m==null?void 0:m.offset}),I=e.isInternal?void 0:t;return b.jsx(En,{id:I,path:x,labelX:w,labelY:C,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:p,markerStart:y,interactionWidth:E})})}const Ks=qs({isInternal:!1}),Us=qs({isInternal:!0});Ks.displayName="SmoothStepEdge";Us.displayName="SmoothStepEdgeInternal";function Zs(e){return A.memo(({id:t,...n})=>{var o;const r=e.isInternal?void 0:t;return b.jsx(Ks,{...n,id:r,pathOptions:A.useMemo(()=>{var i;return{borderRadius:0,offset:(i=n.pathOptions)==null?void 0:i.offset}},[(o=n.pathOptions)==null?void 0:o.offset])})})}const np=Zs({isInternal:!1}),Qs=Zs({isInternal:!0});np.displayName="StepEdge";Qs.displayName="StepEdgeInternal";function Js(e){return A.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:i,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:g,interactionWidth:p})=>{const[y,m,E]=hs({sourceX:n,sourceY:r,targetX:o,targetY:i}),x=e.isInternal?void 0:t;return b.jsx(En,{id:x,path:y,labelX:m,labelY:E,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:g,interactionWidth:p})})}const rp=Js({isInternal:!1}),ea=Js({isInternal:!0});rp.displayName="StraightEdge";ea.displayName="StraightEdgeInternal";function ta(e){return A.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:i,sourcePosition:s=Y.Bottom,targetPosition:a=Y.Top,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:g,markerEnd:p,markerStart:y,pathOptions:m,interactionWidth:E})=>{const[x,w,C]=Nr({sourceX:n,sourceY:r,sourcePosition:s,targetX:o,targetY:i,targetPosition:a,curvature:m==null?void 0:m.curvature}),I=e.isInternal?void 0:t;return b.jsx(En,{id:I,path:x,labelX:w,labelY:C,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:g,markerEnd:p,markerStart:y,interactionWidth:E})})}const op=ta({isInternal:!1}),na=ta({isInternal:!0});op.displayName="BezierEdge";na.displayName="BezierEdgeInternal";const Bo={default:na,straight:ea,step:Qs,smoothstep:Us,simplebezier:Ws},Ho={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},ip=(e,t,n)=>n===Y.Left?e-t:n===Y.Right?e+t:e,sp=(e,t,n)=>n===Y.Top?e-t:n===Y.Bottom?e+t:e,Vo="react-flow__edgeupdater";function Fo({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:o,onMouseEnter:i,onMouseOut:s,type:a}){return b.jsx("circle",{onMouseDown:o,onMouseEnter:i,onMouseOut:s,className:ie([Vo,`${Vo}-${a}`]),cx:ip(t,r,e),cy:sp(n,r,e),r,stroke:"transparent",fill:"transparent"})}function ap({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:o,targetX:i,targetY:s,sourcePosition:a,targetPosition:c,onReconnect:l,onReconnectStart:u,onReconnectEnd:d,setReconnecting:f,setUpdateHover:h}){const g=ne(),p=(w,C)=>{if(w.button!==0)return;const{autoPanOnConnect:I,domNode:N,isValidConnection:T,connectionMode:O,connectionRadius:j,lib:z,onConnectStart:R,onConnectEnd:L,cancelConnection:v,nodeLookup:S,rfId:_,panBy:P,updateConnection:k}=g.getState(),$=C.type==="target";f(!0),u==null||u(w,n,C.type);const M=(B,X)=>{f(!1),d==null||d(B,n,C.type,X)},D=B=>l==null?void 0:l(n,B);ur.onPointerDown(w.nativeEvent,{autoPanOnConnect:I,connectionMode:O,connectionRadius:j,domNode:N,handleId:C.id,nodeId:C.nodeId,nodeLookup:S,isTarget:$,edgeUpdaterType:C.type,lib:z,flowId:_,cancelConnection:v,panBy:P,isValidConnection:T,onConnect:D,onConnectStart:R,onConnectEnd:L,onReconnectEnd:M,updateConnection:k,getTransform:()=>g.getState().transform,getFromHandle:()=>g.getState().connection.fromHandle})},y=w=>p(w,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),m=w=>p(w,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),E=()=>h(!0),x=()=>h(!1);return b.jsxs(b.Fragment,{children:[(e===!0||e==="source")&&b.jsx(Fo,{position:a,centerX:r,centerY:o,radius:t,onMouseDown:y,onMouseEnter:E,onMouseOut:x,type:"source"}),(e===!0||e==="target")&&b.jsx(Fo,{position:c,centerX:i,centerY:s,radius:t,onMouseDown:m,onMouseEnter:E,onMouseOut:x,type:"target"})]})}function cp({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:r,onClick:o,onDoubleClick:i,onContextMenu:s,onMouseEnter:a,onMouseMove:c,onMouseLeave:l,reconnectRadius:u,onReconnect:d,onReconnectStart:f,onReconnectEnd:h,rfId:g,edgeTypes:p,noPanClassName:y,onError:m,disableKeyboardA11y:E}){let x=Z(q=>q.edgeLookup.get(e));const w=Z(q=>q.defaultEdgeOptions);x=w?{...w,...x}:x;let C=x.type||"default",I=(p==null?void 0:p[C])||Bo[C];I===void 0&&(m==null||m("011",ke.error011(C)),C="default",I=Bo.default);const N=!!(x.focusable||t&&typeof x.focusable>"u"),T=typeof d<"u"&&(x.reconnectable||n&&typeof x.reconnectable>"u"),O=!!(x.selectable||r&&typeof x.selectable>"u"),j=A.useRef(null),[z,R]=A.useState(!1),[L,v]=A.useState(!1),S=ne(),{zIndex:_,sourceX:P,sourceY:k,targetX:$,targetY:M,sourcePosition:D,targetPosition:B}=Z(A.useCallback(q=>{const Q=q.nodeLookup.get(x.source),ee=q.nodeLookup.get(x.target);if(!Q||!ee)return{zIndex:x.zIndex,...Ho};const se=Vf({id:e,sourceNode:Q,targetNode:ee,sourceHandle:x.sourceHandle||null,targetHandle:x.targetHandle||null,connectionMode:q.connectionMode,onError:m});return{zIndex:Of({selected:x.selected,zIndex:x.zIndex,sourceNode:Q,targetNode:ee,elevateOnSelect:q.elevateEdgesOnSelect}),...se||Ho}},[x.source,x.target,x.sourceHandle,x.targetHandle,x.selected,x.zIndex]),te),X=A.useMemo(()=>x.markerStart?`url('#${cr(x.markerStart,g)}')`:void 0,[x.markerStart,g]),F=A.useMemo(()=>x.markerEnd?`url('#${cr(x.markerEnd,g)}')`:void 0,[x.markerEnd,g]);if(x.hidden||P===null||k===null||$===null||M===null)return null;const H=q=>{var he;const{addSelectedEdges:Q,unselectNodesAndEdges:ee,multiSelectionActive:se}=S.getState();O&&(S.setState({nodesSelectionActive:!1}),x.selected&&se?(ee({nodes:[],edges:[x]}),(he=j.current)==null||he.blur()):Q([e])),o&&o(q,x)},G=i?q=>{i(q,{...x})}:void 0,V=s?q=>{s(q,{...x})}:void 0,W=a?q=>{a(q,{...x})}:void 0,K=c?q=>{c(q,{...x})}:void 0,J=l?q=>{l(q,{...x})}:void 0,U=q=>{var Q;if(!E&&Zi.includes(q.key)&&O){const{unselectNodesAndEdges:ee,addSelectedEdges:se}=S.getState();q.key==="Escape"?((Q=j.current)==null||Q.blur(),ee({edges:[x]})):se([e])}};return b.jsx("svg",{style:{zIndex:_},children:b.jsxs("g",{className:ie(["react-flow__edge",`react-flow__edge-${C}`,x.className,y,{selected:x.selected,animated:x.animated,inactive:!O&&!o,updating:z,selectable:O}]),onClick:H,onDoubleClick:G,onContextMenu:V,onMouseEnter:W,onMouseMove:K,onMouseLeave:J,onKeyDown:N?U:void 0,tabIndex:N?0:void 0,role:N?"button":"img","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":x.ariaLabel===null?void 0:x.ariaLabel||`Edge from ${x.source} to ${x.target}`,"aria-describedby":N?`${As}-${g}`:void 0,ref:j,children:[!L&&b.jsx(I,{id:e,source:x.source,target:x.target,type:x.type,selected:x.selected,animated:x.animated,selectable:O,deletable:x.deletable??!0,label:x.label,labelStyle:x.labelStyle,labelShowBg:x.labelShowBg,labelBgStyle:x.labelBgStyle,labelBgPadding:x.labelBgPadding,labelBgBorderRadius:x.labelBgBorderRadius,sourceX:P,sourceY:k,targetX:$,targetY:M,sourcePosition:D,targetPosition:B,data:x.data,style:x.style,sourceHandleId:x.sourceHandle,targetHandleId:x.targetHandle,markerStart:X,markerEnd:F,pathOptions:"pathOptions"in x?x.pathOptions:void 0,interactionWidth:x.interactionWidth}),T&&b.jsx(ap,{edge:x,isReconnectable:T,reconnectRadius:u,onReconnect:d,onReconnectStart:f,onReconnectEnd:h,sourceX:P,sourceY:k,targetX:$,targetY:M,sourcePosition:D,targetPosition:B,setUpdateHover:R,setReconnecting:v})]})})}const lp=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function ra({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:o,onReconnect:i,onEdgeContextMenu:s,onEdgeMouseEnter:a,onEdgeMouseMove:c,onEdgeMouseLeave:l,onEdgeClick:u,reconnectRadius:d,onEdgeDoubleClick:f,onReconnectStart:h,onReconnectEnd:g,disableKeyboardA11y:p}){const{edgesFocusable:y,edgesReconnectable:m,elementsSelectable:E,onError:x}=Z(lp,te),w=qg(t);return b.jsxs("div",{className:"react-flow__edges",children:[b.jsx(Jg,{defaultColor:e,rfId:n}),w.map(C=>b.jsx(cp,{id:C,edgesFocusable:y,edgesReconnectable:m,elementsSelectable:E,noPanClassName:o,onReconnect:i,onContextMenu:s,onMouseEnter:a,onMouseMove:c,onMouseLeave:l,onClick:u,reconnectRadius:d,onDoubleClick:f,onReconnectStart:h,onReconnectEnd:g,rfId:n,onError:x,edgeTypes:r,disableKeyboardA11y:p},C))]})}ra.displayName="EdgeRenderer";const up=A.memo(ra),dp=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function fp({children:e}){const t=Z(dp);return b.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function hp(e){const t=vn(),n=A.useRef(!1);A.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const gp=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function pp(e){const t=Z(gp),n=ne();return A.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function Yo(e){return e.connection.inProgress?{...e.connection,to:At(e.connection.to,e.transform)}:{...e.connection}}function mp(e){return e?n=>{const r=Yo(n);return e(r)}:Yo}function yp(e){const t=mp(e);return Z(t,te)}const xp=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function wp({containerStyle:e,style:t,type:n,component:r}){const{nodesConnectable:o,width:i,height:s,isValid:a,inProgress:c}=Z(xp,te);return!(i&&o&&c)?null:b.jsx("svg",{style:e,width:i,height:s,className:"react-flow__connectionline react-flow__container",children:b.jsx("g",{className:ie(["react-flow__connection",Ji(a)]),children:b.jsx(oa,{style:t,type:n,CustomComponent:r,isValid:a})})})}const oa=({style:e,type:t=Pe.Bezier,CustomComponent:n,isValid:r})=>{const{inProgress:o,from:i,fromNode:s,fromHandle:a,fromPosition:c,to:l,toNode:u,toHandle:d,toPosition:f}=yp();if(!o)return;if(n)return b.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:s,fromHandle:a,fromX:i.x,fromY:i.y,toX:l.x,toY:l.y,fromPosition:c,toPosition:f,connectionStatus:Ji(r),toNode:u,toHandle:d});let h="";const g={sourceX:i.x,sourceY:i.y,sourcePosition:c,targetX:l.x,targetY:l.y,targetPosition:f};switch(t){case Pe.Bezier:[h]=Nr(g);break;case Pe.SimpleBezier:[h]=Xs(g);break;case Pe.Step:[h]=ar({...g,borderRadius:0});break;case Pe.SmoothStep:[h]=ar(g);break;default:[h]=hs(g)}return b.jsx("path",{d:h,fill:"none",className:"react-flow__connection-path",style:e})};oa.displayName="ConnectionLine";const vp={};function Xo(e=vp){A.useRef(e),ne(),A.useEffect(()=>{},[e])}function bp(){ne(),A.useRef(!1),A.useEffect(()=>{},[])}function ia({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:o,onNodeDoubleClick:i,onEdgeDoubleClick:s,onNodeMouseEnter:a,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,onSelectionContextMenu:d,onSelectionStart:f,onSelectionEnd:h,connectionLineType:g,connectionLineStyle:p,connectionLineComponent:y,connectionLineContainerStyle:m,selectionKeyCode:E,selectionOnDrag:x,selectionMode:w,multiSelectionKeyCode:C,panActivationKeyCode:I,zoomActivationKeyCode:N,deleteKeyCode:T,onlyRenderVisibleElements:O,elementsSelectable:j,defaultViewport:z,translateExtent:R,minZoom:L,maxZoom:v,preventScrolling:S,defaultMarkerColor:_,zoomOnScroll:P,zoomOnPinch:k,panOnScroll:$,panOnScrollSpeed:M,panOnScrollMode:D,zoomOnDoubleClick:B,panOnDrag:X,onPaneClick:F,onPaneMouseEnter:H,onPaneMouseMove:G,onPaneMouseLeave:V,onPaneScroll:W,onPaneContextMenu:K,paneClickDistance:J,nodeClickDistance:U,onEdgeContextMenu:q,onEdgeMouseEnter:Q,onEdgeMouseMove:ee,onEdgeMouseLeave:se,reconnectRadius:he,onReconnect:Cn,onReconnectStart:Sn,onReconnectEnd:kn,noDragClassName:ot,noWheelClassName:Mn,noPanClassName:it,disableKeyboardA11y:st,nodeExtent:In,rfId:at,viewport:ct,onViewportChange:Pt}){return Xo(e),Xo(t),bp(),hp(n),pp(ct),b.jsx(zg,{onPaneClick:F,onPaneMouseEnter:H,onPaneMouseMove:G,onPaneMouseLeave:V,onPaneContextMenu:K,onPaneScroll:W,paneClickDistance:J,deleteKeyCode:T,selectionKeyCode:E,selectionOnDrag:x,selectionMode:w,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:C,panActivationKeyCode:I,zoomActivationKeyCode:N,elementsSelectable:j,zoomOnScroll:P,zoomOnPinch:k,zoomOnDoubleClick:B,panOnScroll:$,panOnScrollSpeed:M,panOnScrollMode:D,panOnDrag:X,defaultViewport:z,translateExtent:R,minZoom:L,maxZoom:v,onSelectionContextMenu:d,preventScrolling:S,noDragClassName:ot,noWheelClassName:Mn,noPanClassName:it,disableKeyboardA11y:st,onViewportChange:Pt,isControlledViewport:!!ct,children:b.jsxs(fp,{children:[b.jsx(up,{edgeTypes:t,onEdgeClick:o,onEdgeDoubleClick:s,onReconnect:Cn,onReconnectStart:Sn,onReconnectEnd:kn,onlyRenderVisibleElements:O,onEdgeContextMenu:q,onEdgeMouseEnter:Q,onEdgeMouseMove:ee,onEdgeMouseLeave:se,reconnectRadius:he,defaultMarkerColor:_,noPanClassName:it,disableKeyboardA11y:st,rfId:at}),b.jsx(wp,{style:p,type:g,component:y,containerStyle:m}),b.jsx("div",{className:"react-flow__edgelabel-renderer"}),b.jsx(Wg,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:i,onNodeMouseEnter:a,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,nodeClickDistance:U,onlyRenderVisibleElements:O,noPanClassName:it,noDragClassName:ot,disableKeyboardA11y:st,nodeExtent:In,rfId:at}),b.jsx("div",{className:"react-flow__viewport-portal"})]})})}ia.displayName="GraphView";const Ep=A.memo(ia),Go=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:i,fitView:s,nodeOrigin:a,nodeExtent:c}={})=>{const l=new Map,u=new Map,d=new Map,f=new Map,h=r??t??[],g=n??e??[],p=a??[0,0],y=c??bt;ps(d,f,h),lr(g,l,u,{nodeOrigin:p,nodeExtent:y,elevateNodesOnSelect:!1});let m=[0,0,1];if(s&&o&&i){const E=$t(l,{filter:I=>!!((I.width||I.initialWidth)&&(I.height||I.initialHeight))}),{x,y:w,zoom:C}=_r(E,o,i,.5,2,.1);m=[x,w,C]}return{rfId:"1",width:0,height:0,transform:m,nodes:g,nodeLookup:l,parentLookup:u,edges:h,edgeLookup:f,connectionLookup:d,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:.5,maxZoom:2,translateExtent:bt,nodeExtent:y,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Ve.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:p,nodeDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,fitViewOnInit:!1,fitViewDone:!1,fitViewOnInitOptions:void 0,selectNodesOnDrag:!0,multiSelectionActive:!1,connection:{...Qi},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanSpeed:15,connectionRadius:20,onError:Pf,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1}},_p=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:i,fitView:s,nodeOrigin:a,nodeExtent:c})=>Fh((l,u)=>({...Go({nodes:e,edges:t,width:o,height:i,fitView:s,nodeOrigin:a,nodeExtent:c,defaultNodes:n,defaultEdges:r}),setNodes:d=>{const{nodeLookup:f,parentLookup:h,nodeOrigin:g,elevateNodesOnSelect:p}=u();lr(d,f,h,{nodeOrigin:g,nodeExtent:c,elevateNodesOnSelect:p,checkEquality:!0}),l({nodes:d})},setEdges:d=>{const{connectionLookup:f,edgeLookup:h}=u();ps(f,h,d),l({edges:d})},setDefaultNodesAndEdges:(d,f)=>{if(d){const{setNodes:h}=u();h(d),l({hasDefaultNodes:!0})}if(f){const{setEdges:h}=u();h(f),l({hasDefaultEdges:!0})}},updateNodeInternals:(d,f={triggerFitView:!0})=>{const{triggerNodeChanges:h,nodeLookup:g,parentLookup:p,fitViewOnInit:y,fitViewDone:m,fitViewOnInitOptions:E,domNode:x,nodeOrigin:w,nodeExtent:C,debug:I,fitViewSync:N}=u(),{changes:T,updatedInternals:O}=qf(d,g,p,x,w,C);if(O){if(Xf(g,p,{nodeOrigin:w,nodeExtent:C}),f.triggerFitView){let j=m;!m&&y&&(j=N({...E,nodes:E==null?void 0:E.nodes})),l({fitViewDone:j})}else l({});(T==null?void 0:T.length)>0&&(I&&console.log("React Flow: trigger node changes",T),h==null||h(T))}},updateNodePositions:(d,f=!1)=>{const h=[],g=[];for(const[p,y]of d){const m=!!(y!=null&&y.expandParent&&(y!=null&&y.parentId)&&(y!=null&&y.position)),E={id:p,type:"position",position:m?{x:Math.max(0,y.position.x),y:Math.max(0,y.position.y)}:y.position,dragging:f};m&&h.push({id:p,parentId:y.parentId,rect:{...y.internals.positionAbsolute,width:y.measured.width,height:y.measured.height}}),g.push(E)}if(h.length>0){const{nodeLookup:p,parentLookup:y,nodeOrigin:m}=u(),E=Mr(h,p,y,m);g.push(...E)}u().triggerNodeChanges(g)},triggerNodeChanges:d=>{const{onNodesChange:f,setNodes:h,nodes:g,hasDefaultNodes:p,debug:y}=u();if(d!=null&&d.length){if(p){const m=Os(d,g);h(m)}y&&console.log("React Flow: trigger node changes",d),f==null||f(d)}},triggerEdgeChanges:d=>{const{onEdgesChange:f,setEdges:h,edges:g,hasDefaultEdges:p,debug:y}=u();if(d!=null&&d.length){if(p){const m=js(d,g);h(m)}y&&console.log("React Flow: trigger edge changes",d),f==null||f(d)}},addSelectedNodes:d=>{const{multiSelectionActive:f,edgeLookup:h,nodeLookup:g,triggerNodeChanges:p,triggerEdgeChanges:y}=u();if(f){const m=d.map(E=>Re(E,!0));p(m);return}p(We(g,new Set([...d]),!0)),y(We(h))},addSelectedEdges:d=>{const{multiSelectionActive:f,edgeLookup:h,nodeLookup:g,triggerNodeChanges:p,triggerEdgeChanges:y}=u();if(f){const m=d.map(E=>Re(E,!0));y(m);return}y(We(h,new Set([...d]))),p(We(g,new Set,!0))},unselectNodesAndEdges:({nodes:d,edges:f}={})=>{const{edges:h,nodes:g,nodeLookup:p,triggerNodeChanges:y,triggerEdgeChanges:m}=u(),E=d||g,x=f||h,w=E.map(I=>{const N=p.get(I.id);return N&&(N.selected=!1),Re(I.id,!1)}),C=x.map(I=>Re(I.id,!1));y(w),m(C)},setMinZoom:d=>{const{panZoom:f,maxZoom:h}=u();f==null||f.setScaleExtent([d,h]),l({minZoom:d})},setMaxZoom:d=>{const{panZoom:f,minZoom:h}=u();f==null||f.setScaleExtent([h,d]),l({maxZoom:d})},setTranslateExtent:d=>{var f;(f=u().panZoom)==null||f.setTranslateExtent(d),l({translateExtent:d})},setPaneClickDistance:d=>{var f;(f=u().panZoom)==null||f.setClickDistance(d)},resetSelectedElements:()=>{const{edges:d,nodes:f,triggerNodeChanges:h,triggerEdgeChanges:g}=u(),p=f.reduce((m,E)=>E.selected?[...m,Re(E.id,!1)]:m,[]),y=d.reduce((m,E)=>E.selected?[...m,Re(E.id,!1)]:m,[]);h(p),g(y)},setNodeExtent:d=>{const{nodes:f,nodeLookup:h,parentLookup:g,nodeOrigin:p,elevateNodesOnSelect:y,nodeExtent:m}=u();d[0][0]===m[0][0]&&d[0][1]===m[0][1]&&d[1][0]===m[1][0]&&d[1][1]===m[1][1]||(lr(f,h,g,{nodeOrigin:p,nodeExtent:d,elevateNodesOnSelect:y,checkEquality:!1}),l({nodeExtent:d}))},panBy:d=>{const{transform:f,width:h,height:g,panZoom:p,translateExtent:y}=u();return Kf({delta:d,panZoom:p,transform:f,translateExtent:y,width:h,height:g})},fitView:d=>{const{panZoom:f,width:h,height:g,minZoom:p,maxZoom:y,nodeLookup:m}=u();if(!f)return Promise.resolve(!1);const E=rr(m,d);return or({nodes:E,width:h,height:g,panZoom:f,minZoom:p,maxZoom:y},d)},fitViewSync:d=>{const{panZoom:f,width:h,height:g,minZoom:p,maxZoom:y,nodeLookup:m}=u();if(!f)return!1;const E=rr(m,d);return or({nodes:E,width:h,height:g,panZoom:f,minZoom:p,maxZoom:y},d),E.size>0},cancelConnection:()=>{l({connection:{...Qi}})},updateConnection:d=>{l({connection:d})},reset:()=>l({...Go()})}),Object.is);function sa({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:o,initialHeight:i,fitView:s,nodeOrigin:a,nodeExtent:c,children:l}){const[u]=A.useState(()=>_p({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:i,fitView:s,nodeOrigin:a,nodeExtent:c}));return b.jsx(Yh,{value:u,children:b.jsx(hg,{children:l})})}function Np({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:o,width:i,height:s,fitView:a,nodeOrigin:c,nodeExtent:l}){return A.useContext(xn)?b.jsx(b.Fragment,{children:e}):b.jsx(sa,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:o,initialWidth:i,initialHeight:s,fitView:a,nodeOrigin:c,nodeExtent:l,children:e})}const Cp={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function Sp({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:o,nodeTypes:i,edgeTypes:s,onNodeClick:a,onEdgeClick:c,onInit:l,onMove:u,onMoveStart:d,onMoveEnd:f,onConnect:h,onConnectStart:g,onConnectEnd:p,onClickConnectStart:y,onClickConnectEnd:m,onNodeMouseEnter:E,onNodeMouseMove:x,onNodeMouseLeave:w,onNodeContextMenu:C,onNodeDoubleClick:I,onNodeDragStart:N,onNodeDrag:T,onNodeDragStop:O,onNodesDelete:j,onEdgesDelete:z,onDelete:R,onSelectionChange:L,onSelectionDragStart:v,onSelectionDrag:S,onSelectionDragStop:_,onSelectionContextMenu:P,onSelectionStart:k,onSelectionEnd:$,onBeforeDelete:M,connectionMode:D,connectionLineType:B=Pe.Bezier,connectionLineStyle:X,connectionLineComponent:F,connectionLineContainerStyle:H,deleteKeyCode:G="Backspace",selectionKeyCode:V="Shift",selectionOnDrag:W=!1,selectionMode:K=Et.Full,panActivationKeyCode:J="Space",multiSelectionKeyCode:U=rn()?"Meta":"Control",zoomActivationKeyCode:q=rn()?"Meta":"Control",snapToGrid:Q,snapGrid:ee,onlyRenderVisibleElements:se=!1,selectNodesOnDrag:he,nodesDraggable:Cn,nodesConnectable:Sn,nodesFocusable:kn,nodeOrigin:ot=Ps,edgesFocusable:Mn,edgesReconnectable:it,elementsSelectable:st=!0,defaultViewport:In=rg,minZoom:at=.5,maxZoom:ct=2,translateExtent:Pt=bt,preventScrolling:Ga=!0,nodeExtent:$n,defaultMarkerColor:Wa="#b1b1b7",zoomOnScroll:qa=!0,zoomOnPinch:Ka=!0,panOnScroll:Ua=!1,panOnScrollSpeed:Za=.5,panOnScrollMode:Qa=Be.Free,zoomOnDoubleClick:Ja=!0,panOnDrag:ec=!0,onPaneClick:tc,onPaneMouseEnter:nc,onPaneMouseMove:rc,onPaneMouseLeave:oc,onPaneScroll:ic,onPaneContextMenu:sc,paneClickDistance:Rr=0,nodeClickDistance:ac=0,children:cc,onReconnect:lc,onReconnectStart:uc,onReconnectEnd:dc,onEdgeContextMenu:fc,onEdgeDoubleClick:hc,onEdgeMouseEnter:gc,onEdgeMouseMove:pc,onEdgeMouseLeave:mc,reconnectRadius:yc=10,onNodesChange:xc,onEdgesChange:wc,noDragClassName:vc="nodrag",noWheelClassName:bc="nowheel",noPanClassName:Dr="nopan",fitView:zr,fitViewOptions:Ec,connectOnClick:_c,attributionPosition:Nc,proOptions:Cc,defaultEdgeOptions:Sc,elevateNodesOnSelect:kc,elevateEdgesOnSelect:Mc,disableKeyboardA11y:Br=!1,autoPanOnConnect:Ic,autoPanOnNodeDrag:$c,autoPanSpeed:Ac,connectionRadius:Pc,isValidConnection:Tc,onError:Oc,style:jc,id:Hr,nodeDragThreshold:Lc,viewport:Rc,onViewportChange:Dc,width:zc,height:Bc,colorMode:Hc="light",debug:Vc,onScroll:Tt,...Fc},Yc){const An=Hr||"1",Xc=ag(Hc),Gc=A.useCallback(Vr=>{Vr.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Tt==null||Tt(Vr)},[Tt]);return b.jsx("div",{"data-testid":"rf__wrapper",...Fc,onScroll:Gc,style:{...jc,...Cp},ref:Yc,className:ie(["react-flow",o,Xc]),id:Hr,children:b.jsxs(Np,{nodes:e,edges:t,width:zc,height:Bc,fitView:zr,nodeOrigin:ot,nodeExtent:$n,children:[b.jsx(Ep,{onInit:l,onNodeClick:a,onEdgeClick:c,onNodeMouseEnter:E,onNodeMouseMove:x,onNodeMouseLeave:w,onNodeContextMenu:C,onNodeDoubleClick:I,nodeTypes:i,edgeTypes:s,connectionLineType:B,connectionLineStyle:X,connectionLineComponent:F,connectionLineContainerStyle:H,selectionKeyCode:V,selectionOnDrag:W,selectionMode:K,deleteKeyCode:G,multiSelectionKeyCode:U,panActivationKeyCode:J,zoomActivationKeyCode:q,onlyRenderVisibleElements:se,defaultViewport:In,translateExtent:Pt,minZoom:at,maxZoom:ct,preventScrolling:Ga,zoomOnScroll:qa,zoomOnPinch:Ka,zoomOnDoubleClick:Ja,panOnScroll:Ua,panOnScrollSpeed:Za,panOnScrollMode:Qa,panOnDrag:ec,onPaneClick:tc,onPaneMouseEnter:nc,onPaneMouseMove:rc,onPaneMouseLeave:oc,onPaneScroll:ic,onPaneContextMenu:sc,paneClickDistance:Rr,nodeClickDistance:ac,onSelectionContextMenu:P,onSelectionStart:k,onSelectionEnd:$,onReconnect:lc,onReconnectStart:uc,onReconnectEnd:dc,onEdgeContextMenu:fc,onEdgeDoubleClick:hc,onEdgeMouseEnter:gc,onEdgeMouseMove:pc,onEdgeMouseLeave:mc,reconnectRadius:yc,defaultMarkerColor:Wa,noDragClassName:vc,noWheelClassName:bc,noPanClassName:Dr,rfId:An,disableKeyboardA11y:Br,nodeExtent:$n,viewport:Rc,onViewportChange:Dc}),b.jsx(sg,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:h,onConnectStart:g,onConnectEnd:p,onClickConnectStart:y,onClickConnectEnd:m,nodesDraggable:Cn,nodesConnectable:Sn,nodesFocusable:kn,edgesFocusable:Mn,edgesReconnectable:it,elementsSelectable:st,elevateNodesOnSelect:kc,elevateEdgesOnSelect:Mc,minZoom:at,maxZoom:ct,nodeExtent:$n,onNodesChange:xc,onEdgesChange:wc,snapToGrid:Q,snapGrid:ee,connectionMode:D,translateExtent:Pt,connectOnClick:_c,defaultEdgeOptions:Sc,fitView:zr,fitViewOptions:Ec,onNodesDelete:j,onEdgesDelete:z,onDelete:R,onNodeDragStart:N,onNodeDrag:T,onNodeDragStop:O,onSelectionDrag:S,onSelectionDragStart:v,onSelectionDragStop:_,onMove:u,onMoveStart:d,onMoveEnd:f,noPanClassName:Dr,nodeOrigin:ot,rfId:An,autoPanOnConnect:Ic,autoPanOnNodeDrag:$c,autoPanSpeed:Ac,onError:Oc,connectionRadius:Pc,isValidConnection:Tc,selectNodesOnDrag:he,nodeDragThreshold:Lc,onBeforeDelete:M,paneClickDistance:Rr,debug:Vc}),b.jsx(ng,{onSelectionChange:L}),cc,b.jsx(Zh,{proOptions:Cc,position:Nc}),b.jsx(Kh,{rfId:An,disableKeyboardA11y:Br})]})})}var kp=Ls(Sp);const Mp=e=>e.nodes;function Ip(){return Z(Mp,te)}const $p=e=>e.edges;function Ap(){return Z($p,te)}function Pp(e){const[t,n]=A.useState(e),r=A.useCallback(o=>n(i=>Os(o,i)),[]);return[t,n,r]}function Tp(e){const[t,n]=A.useState(e),r=A.useCallback(o=>n(i=>js(o,i)),[]);return[t,n,r]}function Op({onChange:e}){const t=ne();A.useEffect(()=>{const n=[...t.getState().onSelectionChangeHandlers,e];return t.setState({onSelectionChangeHandlers:n}),()=>{const r=t.getState().onSelectionChangeHandlers.filter(o=>o!==e);t.setState({onSelectionChangeHandlers:r})}},[e])}function rt(e){return Z(A.useCallback(n=>n.nodeLookup.get(e),[e]),te)}function jp({dimensions:e,lineWidth:t,variant:n,className:r}){return b.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:ie(["react-flow__background-pattern",n,r])})}function Lp({radius:e,className:t}){return b.jsx("circle",{cx:e,cy:e,r:e,className:ie(["react-flow__background-pattern","dots",t])})}var Oe;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Oe||(Oe={}));const Rp={[Oe.Dots]:1,[Oe.Lines]:1,[Oe.Cross]:6},Dp=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function aa({id:e,variant:t=Oe.Dots,gap:n=20,size:r,lineWidth:o=1,offset:i=0,color:s,bgColor:a,style:c,className:l,patternClassName:u}){const d=A.useRef(null),{transform:f,patternId:h}=Z(Dp,te),g=r||Rp[t],p=t===Oe.Dots,y=t===Oe.Cross,m=Array.isArray(n)?n:[n,n],E=[m[0]*f[2]||1,m[1]*f[2]||1],x=g*f[2],w=Array.isArray(i)?i:[i,i],C=y?[x,x]:E,I=[w[0]*f[2]||1+C[0]/2,w[1]*f[2]||1+C[1]/2],N=`${h}${e||""}`;return b.jsxs("svg",{className:ie(["react-flow__background",l]),style:{...c,...bn,"--xy-background-color-props":a,"--xy-background-pattern-color-props":s},ref:d,"data-testid":"rf__background",children:[b.jsx("pattern",{id:N,x:f[0]%E[0],y:f[1]%E[1],width:E[0],height:E[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${I[0]},-${I[1]})`,children:p?b.jsx(Lp,{radius:x/2,className:u}):b.jsx(jp,{dimensions:C,lineWidth:o,variant:t,className:u})}),b.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${N})`})]})}aa.displayName="Background";const zp=A.memo(aa);function Bp(){return b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:b.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function Hp(){return b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:b.jsx("path",{d:"M0 0h32v4.2H0z"})})}function Vp(){return b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:b.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function Fp(){return b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:b.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Yp(){return b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:b.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function Vt({children:e,className:t,...n}){return b.jsx("button",{type:"button",className:ie(["react-flow__controls-button",t]),...n,children:e})}const Xp=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom});function ca({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:o,onZoomIn:i,onZoomOut:s,onFitView:a,onInteractiveChange:c,className:l,children:u,position:d="bottom-left",orientation:f="vertical","aria-label":h="React Flow controls"}){const g=ne(),{isInteractive:p,minZoomReached:y,maxZoomReached:m}=Z(Xp,te),{zoomIn:E,zoomOut:x,fitView:w}=vn(),C=()=>{E(),i==null||i()},I=()=>{x(),s==null||s()},N=()=>{w(o),a==null||a()},T=()=>{g.setState({nodesDraggable:!p,nodesConnectable:!p,elementsSelectable:!p}),c==null||c(!p)},O=f==="horizontal"?"horizontal":"vertical";return b.jsxs(wn,{className:ie(["react-flow__controls",O,l]),position:d,style:e,"data-testid":"rf__controls","aria-label":h,children:[t&&b.jsxs(b.Fragment,{children:[b.jsx(Vt,{onClick:C,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:m,children:b.jsx(Bp,{})}),b.jsx(Vt,{onClick:I,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:y,children:b.jsx(Hp,{})})]}),n&&b.jsx(Vt,{className:"react-flow__controls-fitview",onClick:N,title:"fit view","aria-label":"fit view",children:b.jsx(Vp,{})}),r&&b.jsx(Vt,{className:"react-flow__controls-interactive",onClick:T,title:"toggle interactivity","aria-label":"toggle interactivity",children:p?b.jsx(Yp,{}):b.jsx(Fp,{})}),u]})}ca.displayName="Controls";const Gp=A.memo(ca);function Wp({id:e,x:t,y:n,width:r,height:o,style:i,color:s,strokeColor:a,strokeWidth:c,className:l,borderRadius:u,shapeRendering:d,selected:f,onClick:h}){const{background:g,backgroundColor:p}=i||{},y=s||g||p;return b.jsx("rect",{className:ie(["react-flow__minimap-node",{selected:f},l]),x:t,y:n,rx:u,ry:u,width:r,height:o,style:{fill:y,stroke:a,strokeWidth:c},shapeRendering:d,onClick:h?m=>h(m,e):void 0})}const qp=A.memo(Wp),Kp=e=>e.nodes.map(t=>t.id),Hn=e=>e instanceof Function?e:()=>e;function Up({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:o,nodeComponent:i=qp,onClick:s}){const a=Z(Kp,te),c=Hn(t),l=Hn(e),u=Hn(n),d=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return b.jsx(b.Fragment,{children:a.map(f=>b.jsx(Qp,{id:f,nodeColorFunc:c,nodeStrokeColorFunc:l,nodeClassNameFunc:u,nodeBorderRadius:r,nodeStrokeWidth:o,NodeComponent:i,onClick:s,shapeRendering:d},f))})}function Zp({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:o,nodeStrokeWidth:i,shapeRendering:s,NodeComponent:a,onClick:c}){const{node:l,x:u,y:d,width:f,height:h}=Z(g=>{const p=g.nodeLookup.get(e),{x:y,y:m}=p.internals.positionAbsolute,{width:E,height:x}=Me(p);return{node:p,x:y,y:m,width:E,height:x}},te);return!l||l.hidden||!as(l)?null:b.jsx(a,{x:u,y:d,width:f,height:h,style:l.style,selected:!!l.selected,className:r(l),color:t(l),borderRadius:o,strokeColor:n(l),strokeWidth:i,shapeRendering:s,onClick:c,id:l.id})}const Qp=A.memo(Zp);var Jp=A.memo(Up);const e0=200,t0=150,n0=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?is($t(e.nodeLookup),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height}},r0="react-flow__minimap-desc";function la({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:o="",nodeBorderRadius:i=5,nodeStrokeWidth:s,nodeComponent:a,bgColor:c,maskColor:l,maskStrokeColor:u,maskStrokeWidth:d,position:f="bottom-right",onClick:h,onNodeClick:g,pannable:p=!1,zoomable:y=!1,ariaLabel:m="React Flow mini map",inversePan:E,zoomStep:x=10,offsetScale:w=5}){const C=ne(),I=A.useRef(null),{boundingRect:N,viewBB:T,rfId:O,panZoom:j,translateExtent:z,flowWidth:R,flowHeight:L}=Z(n0,te),v=(e==null?void 0:e.width)??e0,S=(e==null?void 0:e.height)??t0,_=N.width/v,P=N.height/S,k=Math.max(_,P),$=k*v,M=k*S,D=w*k,B=N.x-($-N.width)/2-D,X=N.y-(M-N.height)/2-D,F=$+D*2,H=M+D*2,G=`${r0}-${O}`,V=A.useRef(0),W=A.useRef();V.current=k,A.useEffect(()=>{if(I.current&&j)return W.current=rh({domNode:I.current,panZoom:j,getTransform:()=>C.getState().transform,getViewScale:()=>V.current}),()=>{var U;(U=W.current)==null||U.destroy()}},[j]),A.useEffect(()=>{var U;(U=W.current)==null||U.update({translateExtent:z,width:R,height:L,inversePan:E,pannable:p,zoomStep:x,zoomable:y})},[p,y,E,x,z,R,L]);const K=h?U=>{var ee;const[q,Q]=((ee=W.current)==null?void 0:ee.pointer(U))||[0,0];h(U,{x:q,y:Q})}:void 0,J=g?A.useCallback((U,q)=>{const Q=C.getState().nodeLookup.get(q);g(U,Q)},[]):void 0;return b.jsx(wn,{position:f,style:{...e,"--xy-minimap-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-stroke-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-width-props":typeof d=="number"?d*k:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof s=="string"?s:void 0},className:ie(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:b.jsxs("svg",{width:v,height:S,viewBox:`${B} ${X} ${F} ${H}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":G,ref:I,onClick:K,children:[m&&b.jsx("title",{id:G,children:m}),b.jsx(Jp,{onClick:J,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:i,nodeClassName:o,nodeStrokeWidth:s,nodeComponent:a}),b.jsx("path",{className:"react-flow__minimap-mask",d:`M${B-D},${X-D}h${F+D*2}v${H+D*2}h${-F-D*2}z
        M${T.x},${T.y}h${T.width}v${T.height}h${-T.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}la.displayName="MiniMap";A.memo(la);function o0({nodeId:e,position:t,variant:n=pt.Handle,className:r,style:o={},children:i,color:s,minWidth:a=10,minHeight:c=10,maxWidth:l=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:d=!1,shouldResize:f,onResizeStart:h,onResize:g,onResizeEnd:p}){const y=Bs(),m=typeof e=="string"?e:y,E=ne(),x=A.useRef(null),w=n===pt.Line?"right":"bottom-right",C=t??w,I=A.useRef(null);A.useEffect(()=>{if(!(!x.current||!m))return I.current||(I.current=xh({domNode:x.current,nodeId:m,getStoreItems:()=>{const{nodeLookup:j,transform:z,snapGrid:R,snapToGrid:L,nodeOrigin:v,domNode:S}=E.getState();return{nodeLookup:j,transform:z,snapGrid:R,snapToGrid:L,nodeOrigin:v,paneDomNode:S}},onChange:(j,z)=>{const{triggerNodeChanges:R,nodeLookup:L,parentLookup:v,nodeOrigin:S}=E.getState(),_=[],P={x:j.x,y:j.y},k=L.get(m);if(k&&k.expandParent&&k.parentId){const $=k.origin??S,M=j.width??k.measured.width,D=j.height??k.measured.height,B={id:k.id,parentId:k.parentId,rect:{width:M,height:D,...cs({x:j.x??k.position.x,y:j.y??k.position.y},{width:M,height:D},k.parentId,L,$)}},X=Mr([B],L,v,S);_.push(...X),P.x=j.x?Math.max($[0]*M,j.x):void 0,P.y=j.y?Math.max($[1]*D,j.y):void 0}if(P.x!==void 0&&P.y!==void 0){const $={id:m,type:"position",position:{...P}};_.push($)}if(j.width!==void 0&&j.height!==void 0){const $={id:m,type:"dimensions",resizing:!0,setAttributes:!0,dimensions:{width:j.width,height:j.height}};_.push($)}for(const $ of z){const M={...$,type:"position"};_.push(M)}R(_)},onEnd:()=>{const j={id:m,type:"dimensions",resizing:!1};E.getState().triggerNodeChanges([j])}})),I.current.update({controlPosition:C,boundaries:{minWidth:a,minHeight:c,maxWidth:l,maxHeight:u},keepAspectRatio:d,onResizeStart:h,onResize:g,onResizeEnd:p,shouldResize:f}),()=>{var j;(j=I.current)==null||j.destroy()}},[C,a,c,l,u,d,h,g,p,f]);const N=C.split("-"),T=n===pt.Line?"borderColor":"backgroundColor",O=s?{...o,[T]:s}:o;return b.jsx("div",{className:ie(["react-flow__resize-control","nodrag",...N,n,r]),ref:x,style:O,children:i})}A.memo(o0);const i0=()=>b.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:b.jsxs("g",{fill:"none",fillRule:"evenodd",children:[b.jsx("circle",{cx:"8",cy:"8",r:"6.5",fill:"#FAF5FF",stroke:"#834DF0"}),b.jsx("path",{d:"M8.57081 5C7.72702 5 7.06335 5.37098 6.68265 5.99832V5.12281H5.7002V12H6.70312V9.52032C7.08689 10.1272 7.74186 10.4854 8.57081 10.4854C10.0291 10.4854 11.0474 9.36988 11.0474 7.74269C11.0474 6.1155 10.0291 5 8.57081 5ZM8.36101 9.5848C7.38367 9.5848 6.70312 8.8326 6.70312 7.74269C6.70312 6.65278 7.38367 5.90058 8.36101 5.90058C9.33324 5.90058 10.0036 6.65278 10.0036 7.74269C10.0036 8.8326 9.33324 9.5848 8.36101 9.5848Z",fill:"#834DF0"})]})}),s0=()=>b.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:b.jsxs("g",{fill:"none",fillRule:"evenodd",children:[b.jsx("circle",{cx:"8",cy:"8",r:"6.5",fill:"#E7EFFD",stroke:"#3574F0"}),b.jsx("path",{d:"M7.92995 8.405H9.02495L10.925 11.5H9.77495L7.92995 8.405ZM5.69995 4.5H8.58495C9.04828 4.5 9.45328 4.58667 9.79995 4.76C10.15 4.93 10.42 5.17167 10.61 5.485C10.8 5.795 10.895 6.15833 10.895 6.575C10.895 6.98833 10.7983 7.35333 10.605 7.67C10.4116 7.98667 10.1383 8.23167 9.78495 8.405C9.43162 8.575 9.01828 8.66 8.54495 8.66H6.69995V11.5H5.69995V4.5ZM8.55995 7.77C8.81995 7.77 9.04662 7.72167 9.23995 7.625C9.43328 7.52833 9.58328 7.39 9.68995 7.21C9.79662 7.03 9.84995 6.81833 9.84995 6.575C9.84995 6.335 9.79662 6.12667 9.68995 5.95C9.58328 5.77 9.43328 5.63167 9.23995 5.535C9.04662 5.43833 8.81995 5.39 8.55995 5.39H6.69995V7.77H8.55995Z",fill:"#3574F0"})]})}),a0=()=>b.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:b.jsxs("g",{fill:"none",fillRule:"evenodd",children:[b.jsx("path",{fill:"#9AA7B0",fillOpacity:".9",d:"M7.9844,4 L6.6964,2.711 C6.3044,2.32 5.5324,2 4.9784,2 L1.0504,2 C1.0234,2 1.0004,2.022 1.0004,2.051 L1.0004,13 L8,13 L8,8 L15.0004,8 L15.0004,4 L7.9844,4 Z"}),b.jsx("polygon",{fill:"#40B6E0",points:"13 16 16 16 16 13 13 13"}),b.jsx("polygon",{fill:"#40B6E0",points:"13 12 16 12 16 9 13 9"}),b.jsx("polygon",{fill:"#40B6E0",points:"9 16 12 16 12 13 9 13"}),b.jsx("polygon",{fill:"#40B6E0",points:"9 12 12 12 12 9 9 9"})]})}),c0=()=>b.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:b.jsxs("g",{fill:"none",fillOpacity:".9",fillRule:"evenodd",children:[b.jsx("polygon",{fill:"#40B6E0",points:"2 14 11 14 11 5 2 5"}),b.jsx("polygon",{fill:"#40B6E0",points:"11.3 4 2 4 4 2 13.3 2"}),b.jsx("polygon",{fill:"#40B6E0",points:"14 2.8 14 12 12 14 12 4.8"})]})}),l0=()=>b.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:b.jsx("g",{fill:"none",fillRule:"evenodd",children:b.jsx("polygon",{fill:"#40B6E0",fillOpacity:".9",points:"7 16 10 10 2.5 10 10 1 8.5 7 14.5 7"})})}),u0=()=>b.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:b.jsx("g",{fill:"none",fillRule:"evenodd",transform:"translate(-4,-4) scale(1.5)",children:b.jsx("path",{fill:"#40B6E0",fillOpacity:".9",d:"M1,8 L2,8 L2,4 L3.5,4 L3.5,3 L2,3 C1.99687783,2.36169171 1.99509925,2.02835838 1.99466424,2 C1.98704681,1.50341351 2.13289549,1.0728225 2.43221029,0.972167969 C2.91964141,0.808253079 3.56884985,1.02114795 3.68984985,1.06414795 L3.98519897,0.226043701 C3.90948298,0.198825534 3.4559021,0 2.81140137,0 C2.16690063,1.40512602e-16 1.81677246,0.0614013672 1.4818929,0.388793945 C1.16513106,0.698473875 1.01614114,1.22015248 1.00124609,2 C1.00039414,2.04460465 0.999980878,2.95274463 1,3 C1.00000736,3.01819872 0.666674031,3.01819872 0,3 L0,3.972 L1,3.972 L1,8 Z",transform:"translate(6 4)"})})}),d0=()=>b.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:b.jsx("g",{fill:"none",fillRule:"evenodd",transform:"translate(-4,-4) scale(1.5)",children:b.jsx("polygon",{fill:"#40B6E0",fillOpacity:".9",points:"8.5 10 8.5 6 9.5 5.664 9.5 5 6.5 5 6.5 5.664 7.5 6 7.5 10 6.5 10.344 6.5 11 9.5 11 9.5 10.344"})})}),f0=()=>b.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:b.jsx("g",{fill:"none",fillRule:"evenodd",transform:"translate(-4,-4) scale(1.5)",children:b.jsx("path",{fill:"#40B6E0",fillOpacity:".9",d:"M3.15333333,6 C2.26166667,6 1.42,5.69166667 0.72,5.06666667 L1.33666667,4.33333333 C1.895,4.81666667 2.46166667,5.09166667 3.17833333,5.09166667 C3.81166667,5.09166667 4.21166667,4.79166667 4.21166667,4.35833333 L4.21166667,4.34166667 C4.21166667,3.925 3.97833333,3.7 2.895,3.45 C1.65333333,3.15 0.953333333,2.78333333 0.953333333,1.70833333 L0.953333333,1.69166667 C0.953333333,0.691666667 1.78666667,2.48689958e-14 2.945,2.48689958e-14 C3.795,2.48689958e-14 4.47,0.258333333 5.06166667,0.733333333 L4.51166667,1.50833333 C3.98666667,1.11666667 3.46166667,0.908333333 2.92833333,0.908333333 C2.32833333,0.908333333 1.97833333,1.21666667 1.97833333,1.6 L1.97833333,1.61666667 C1.97833333,2.06666667 2.245,2.26666667 3.37,2.53333333 C4.60333333,2.83333333 5.23666667,3.275 5.23666667,4.24166667 L5.23666667,4.25833333 C5.23666667,5.35 4.37833333,6 3.15333333,6 Z",transform:"translate(5 5)"})})}),ua={ConceptType:b.jsx(a0,{}),EntityType:b.jsx(c0,{}),EventType:b.jsx(l0,{}),Float:b.jsx(u0,{}),Integer:b.jsx(d0,{}),Text:b.jsx(f0,{})},Xe=e=>Object.keys(ua).includes(e),h0=A.memo(e=>{const{data:t={}}=e,{entity:n={}}=t,r=(n.types||[]).filter(a=>Xe(a)),o=a=>{Xe(a)||console.log(`${a} click`)},i=(n.properties||[]).filter(a=>(a.types||[]).filter(c=>Xe(c)).length>0),s=(n.relations||[]).filter(a=>(a.types||[]).filter(c=>Xe(c)).length>0);return b.jsxs(b.Fragment,{children:[b.jsx("div",{className:"turbo-clouds",children:r.map((a,c)=>b.jsx("div",{className:"turbo-cloud gradient",children:b.jsx("div",{children:ua[a]})},c))}),b.jsx("div",{className:"turbo-body-wrapper gradient",children:b.jsxs("div",{className:"inner",children:[b.jsxs("div",{className:"turbo-body",children:[b.jsxs("div",{className:"turbo-title-container",children:[b.jsx("div",{className:"turbo-title",children:n.name}),b.jsx("div",{className:"turbo-subtitle",children:n.aliasName})]}),i.length>0&&b.jsx("div",{className:"turbo-properties-container",children:i.map(a=>{const{id:c,name:l,aliasName:u,types:d}=a;return b.jsxs("div",{className:"turbo-property",children:[b.jsx("div",{className:"turbo-property-icon",children:b.jsx(i0,{})}),b.jsx("div",{className:"turbo-property-title",children:l}),b.jsx("div",{className:"turbo-property-subtitle",children:u}),b.jsx("div",{className:"turbo-property-types",children:d==null?void 0:d.map((f,h)=>b.jsx("div",{className:`turbo-property-type ${Xe(f)&&"builtin"}`,onClick:()=>o(f),children:f},h))})]},c)})}),s.length>0&&b.jsx("div",{className:"turbo-relations-container",children:s.map(a=>{const{id:c,name:l,aliasName:u,types:d}=a;return b.jsxs("div",{className:"turbo-property",children:[b.jsx("div",{className:"turbo-relation-icon",children:b.jsx(s0,{})}),b.jsx("div",{className:"turbo-relation-title",children:l}),b.jsx("div",{className:"turbo-relation-subtitle",children:u}),b.jsx("div",{className:"turbo-relation-types",children:d==null?void 0:d.map((f,h)=>b.jsx("div",{className:`turbo-property-type ${Xe(f)&&"builtin"}`,onClick:()=>o(f),children:f},h))})]},c)})})]}),b.jsx(nt,{type:"source",position:Y.Right}),b.jsx(nt,{type:"target",position:Y.Left})]})})]})}),Wo=(e,t)=>{const{x:n,y:r,width:o,height:i}=e;return{x:n-t,y:r-t,width:o+t*2,height:i+t*2}},qo=(e,t,n=0)=>{const r=Wo({...e.internals.positionAbsolute,width:e.measured.width||0,height:e.measured.height||0},n),o=Wo({...t.internals.positionAbsolute,width:e.measured.width||0,height:e.measured.height||0},n),i=r.width/2,s=r.height/2,a=r.x+i,c=r.y+s,l=o.x+o.width/2,u=o.y+o.height/2,d=(l-a)/(2*i)-(u-c)/(2*s),f=(l-a)/(2*i)+(u-c)/(2*s),h=1/(Math.abs(d)+Math.abs(f)),g=h*d,p=h*f,y=i*(g+p)+a,m=s*(-g+p)+c;return{x:y,y:m}},Ko=(e,t)=>{const n={...e.internals.positionAbsolute,...e},r=Math.round(n.x),o=Math.round(n.y),i=Math.round(t.x),s=Math.round(t.y);return i<=r+1?Y.Left:i>=r+(n.measured.width||0)-1?Y.Right:s<=o+1?Y.Top:s>=n.y+(n.measured.height||0)-1?Y.Bottom:Y.Top},g0=(e,t,n=0)=>{const r=qo(e,t,n),o=qo(t,e,n),i=Ko(e,r),s=Ko(t,o);return{sourceX:r.x,sourceY:r.y,targetX:o.x,targetY:o.y,sourcePos:i,targetPos:s}},p0=e=>{const{id:t,source:n,target:r,label:o,markerStart:i,markerEnd:s,style:a}=e,c=rt(n),l=rt(r);if(!c||!l)return null;const{sourceX:u,sourceY:d,targetX:f,targetY:h,sourcePos:g,targetPos:p}=g0(c,l,5);if(!u||!d||!f||!h)return null;const[y,m,E]=Nr({sourceX:u===f?u+1e-4:u,sourceY:d===h?d+1e-4:d,sourcePosition:g,targetX:f,targetY:h,targetPosition:p}),x=(o==null?void 0:o.toString())||"",w=(x.length+x.replaceAll(/[ -~]+/g,"").length)*6,C=m-w/2,I=E+6;return b.jsxs(b.Fragment,{children:[b.jsx("path",{id:t,style:a,className:"react-flow__edge-path",d:y,markerStart:i,markerEnd:s}),b.jsx("text",{fontSize:"12px",fill:"var(--entity-name-color)",transform:`translate(${C}, ${I})`,style:{textShadow:"0 0 20px var(--keyword-color)"},children:o})]})},Ft=Math.PI,je=2*Math.PI,m0=e=>{var _,P,k,$;const{source:t,label:n,markerStart:r,markerEnd:o,style:i}=e,s=rt(t);if(!s)return null;const a=((_=s.measured)==null?void 0:_.width)||.1,c=((P=s.measured)==null?void 0:P.height)||.1,l=M=>{var D,B;return{x:M.internals.positionAbsolute.x+(((D=M.measured)==null?void 0:D.width)||0)/2,y:M.internals.positionAbsolute.y+(((B=M.measured)==null?void 0:B.height)||0)/2}},u=(M,D)=>{const B=D.x-M.x,X=D.y-M.y,F=Math.sqrt(B**2+X**2);let H=Math.asin(Math.abs(X)/F);return H=B<0?Ft-H:H,H=X<0?-H:H,H=H<0?H+je:H,H},d=Ap().filter(M=>M.source==t||M.target==t).filter(M=>M.source!=t||M.target!=t),f=Ip().filter(M=>M.id!=t&&d.find(D=>D.source==M.id||D.target==M.id)).map(M=>rt(M.id)).filter(M=>!!M).map(M=>l(M)),h=l(s),g=Math.sqrt((((k=s.measured)==null?void 0:k.width)||0)**2+((($=s.measured)==null?void 0:$.height)||0)**2)/2,p=f.map((M,D)=>({index:D,alpha:u(h,M)})).sort((M,D)=>M.alpha-D.alpha);p.length==0?p.push({index:0,alpha:0}):p.push({index:0,alpha:p[0].alpha+je});const y={index:0,delta:0};for(let M=0;M<p.length-1;M++)if(p[M].alpha<p[M+1].alpha){const D=p[M+1].alpha-p[M].alpha;D>y.delta&&(y.index=M,y.delta=D)}const m=p[y.index].alpha+y.delta/2,E=(m-40/g+je)%je,x=(m+40/g+je)%je,w=(M,D,B)=>{const X=(B>Ft*.5&&B<Ft*1.5?-1:1)*M/2,F=X*Math.tan(B),H=(B>Ft&&B<je?-1:1)*D/2,G=H/Math.tan(B);return X**2+F**2<G**2+H**2?{x:X,y:F}:{x:G,y:H}},C=w(a,c,E),I=60,N={x:(g+I)*Math.cos(E),y:(g+I)*Math.sin(E)},T={x:(g+I)*Math.cos(x),y:(g+I)*Math.sin(x)},O=w(a,c,x),j=(g+I)*.85*Math.cos(m),z=(g+I)*.85*Math.sin(m),R=(n==null?void 0:n.toString())||"",L=(R.length+R.replaceAll(/[ -~]+/g,"").length)*6,v=j-L/2,S=z+6;return b.jsxs("g",{transform:`translate(${h.x}, ${h.y})`,children:[b.jsx("path",{style:i,className:"react-flow__edge-path",d:`M${C.x},${C.y} C${N.x},${N.y} ${T.x},${T.y} ${O.x},${O.y}`,markerStart:r,markerEnd:o}),b.jsx("text",{fontSize:"12px",fill:"var(--entity-name-color)",transform:`translate(${v}, ${S})`,style:{textShadow:"0 0 20px var(--keyword-color)"},children:n})]})},y0=e=>{const{source:t,target:n}=e,r=rt(t),o=rt(n);return!r||!o?null:t==n?b.jsx(m0,{...e}):b.jsx(p0,{...e})};var x0="\0",Le="\0",Uo="";let w0=class{constructor(t){re(this,"_isDirected",!0);re(this,"_isMultigraph",!1);re(this,"_isCompound",!1);re(this,"_label");re(this,"_defaultNodeLabelFn",()=>{});re(this,"_defaultEdgeLabelFn",()=>{});re(this,"_nodes",{});re(this,"_in",{});re(this,"_preds",{});re(this,"_out",{});re(this,"_sucs",{});re(this,"_edgeObjs",{});re(this,"_edgeLabels",{});re(this,"_nodeCount",0);re(this,"_edgeCount",0);re(this,"_parent");re(this,"_children");t&&(this._isDirected=Object.hasOwn(t,"directed")?t.directed:!0,this._isMultigraph=Object.hasOwn(t,"multigraph")?t.multigraph:!1,this._isCompound=Object.hasOwn(t,"compound")?t.compound:!1),this._isCompound&&(this._parent={},this._children={},this._children[Le]={})}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(t){return this._label=t,this}graph(){return this._label}setDefaultNodeLabel(t){return this._defaultNodeLabelFn=t,typeof t!="function"&&(this._defaultNodeLabelFn=()=>t),this}nodeCount(){return this._nodeCount}nodes(){return Object.keys(this._nodes)}sources(){var t=this;return this.nodes().filter(n=>Object.keys(t._in[n]).length===0)}sinks(){var t=this;return this.nodes().filter(n=>Object.keys(t._out[n]).length===0)}setNodes(t,n){var r=arguments,o=this;return t.forEach(function(i){r.length>1?o.setNode(i,n):o.setNode(i)}),this}setNode(t,n){return Object.hasOwn(this._nodes,t)?(arguments.length>1&&(this._nodes[t]=n),this):(this._nodes[t]=arguments.length>1?n:this._defaultNodeLabelFn(t),this._isCompound&&(this._parent[t]=Le,this._children[t]={},this._children[Le][t]=!0),this._in[t]={},this._preds[t]={},this._out[t]={},this._sucs[t]={},++this._nodeCount,this)}node(t){return this._nodes[t]}hasNode(t){return Object.hasOwn(this._nodes,t)}removeNode(t){var n=this;if(Object.hasOwn(this._nodes,t)){var r=o=>n.removeEdge(n._edgeObjs[o]);delete this._nodes[t],this._isCompound&&(this._removeFromParentsChildList(t),delete this._parent[t],this.children(t).forEach(function(o){n.setParent(o)}),delete this._children[t]),Object.keys(this._in[t]).forEach(r),delete this._in[t],delete this._preds[t],Object.keys(this._out[t]).forEach(r),delete this._out[t],delete this._sucs[t],--this._nodeCount}return this}setParent(t,n){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(n===void 0)n=Le;else{n+="";for(var r=n;r!==void 0;r=this.parent(r))if(r===t)throw new Error("Setting "+n+" as parent of "+t+" would create a cycle");this.setNode(n)}return this.setNode(t),this._removeFromParentsChildList(t),this._parent[t]=n,this._children[n][t]=!0,this}_removeFromParentsChildList(t){delete this._children[this._parent[t]][t]}parent(t){if(this._isCompound){var n=this._parent[t];if(n!==Le)return n}}children(t=Le){if(this._isCompound){var n=this._children[t];if(n)return Object.keys(n)}else{if(t===Le)return this.nodes();if(this.hasNode(t))return[]}}predecessors(t){var n=this._preds[t];if(n)return Object.keys(n)}successors(t){var n=this._sucs[t];if(n)return Object.keys(n)}neighbors(t){var n=this.predecessors(t);if(n){const o=new Set(n);for(var r of this.successors(t))o.add(r);return Array.from(o.values())}}isLeaf(t){var n;return this.isDirected()?n=this.successors(t):n=this.neighbors(t),n.length===0}filterNodes(t){var n=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});n.setGraph(this.graph());var r=this;Object.entries(this._nodes).forEach(function([s,a]){t(s)&&n.setNode(s,a)}),Object.values(this._edgeObjs).forEach(function(s){n.hasNode(s.v)&&n.hasNode(s.w)&&n.setEdge(s,r.edge(s))});var o={};function i(s){var a=r.parent(s);return a===void 0||n.hasNode(a)?(o[s]=a,a):a in o?o[a]:i(a)}return this._isCompound&&n.nodes().forEach(s=>n.setParent(s,i(s))),n}setDefaultEdgeLabel(t){return this._defaultEdgeLabelFn=t,typeof t!="function"&&(this._defaultEdgeLabelFn=()=>t),this}edgeCount(){return this._edgeCount}edges(){return Object.values(this._edgeObjs)}setPath(t,n){var r=this,o=arguments;return t.reduce(function(i,s){return o.length>1?r.setEdge(i,s,n):r.setEdge(i,s),s}),this}setEdge(){var t,n,r,o,i=!1,s=arguments[0];typeof s=="object"&&s!==null&&"v"in s?(t=s.v,n=s.w,r=s.name,arguments.length===2&&(o=arguments[1],i=!0)):(t=s,n=arguments[1],r=arguments[3],arguments.length>2&&(o=arguments[2],i=!0)),t=""+t,n=""+n,r!==void 0&&(r=""+r);var a=ht(this._isDirected,t,n,r);if(Object.hasOwn(this._edgeLabels,a))return i&&(this._edgeLabels[a]=o),this;if(r!==void 0&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(t),this.setNode(n),this._edgeLabels[a]=i?o:this._defaultEdgeLabelFn(t,n,r);var c=v0(this._isDirected,t,n,r);return t=c.v,n=c.w,Object.freeze(c),this._edgeObjs[a]=c,Zo(this._preds[n],t),Zo(this._sucs[t],n),this._in[n][a]=c,this._out[t][a]=c,this._edgeCount++,this}edge(t,n,r){var o=arguments.length===1?Vn(this._isDirected,arguments[0]):ht(this._isDirected,t,n,r);return this._edgeLabels[o]}edgeAsObj(){const t=this.edge(...arguments);return typeof t!="object"?{label:t}:t}hasEdge(t,n,r){var o=arguments.length===1?Vn(this._isDirected,arguments[0]):ht(this._isDirected,t,n,r);return Object.hasOwn(this._edgeLabels,o)}removeEdge(t,n,r){var o=arguments.length===1?Vn(this._isDirected,arguments[0]):ht(this._isDirected,t,n,r),i=this._edgeObjs[o];return i&&(t=i.v,n=i.w,delete this._edgeLabels[o],delete this._edgeObjs[o],Qo(this._preds[n],t),Qo(this._sucs[t],n),delete this._in[n][o],delete this._out[t][o],this._edgeCount--),this}inEdges(t,n){var r=this._in[t];if(r){var o=Object.values(r);return n?o.filter(i=>i.v===n):o}}outEdges(t,n){var r=this._out[t];if(r){var o=Object.values(r);return n?o.filter(i=>i.w===n):o}}nodeEdges(t,n){var r=this.inEdges(t,n);if(r)return r.concat(this.outEdges(t,n))}};function Zo(e,t){e[t]?e[t]++:e[t]=1}function Qo(e,t){--e[t]||delete e[t]}function ht(e,t,n,r){var o=""+t,i=""+n;if(!e&&o>i){var s=o;o=i,i=s}return o+Uo+i+Uo+(r===void 0?x0:r)}function v0(e,t,n,r){var o=""+t,i=""+n;if(!e&&o>i){var s=o;o=i,i=s}var a={v:o,w:i};return r&&(a.name=r),a}function Vn(e,t){return ht(e,t.v,t.w,t.name)}var $r=w0,b0="2.2.4",E0={Graph:$r,version:b0},_0=$r,N0={write:C0,read:M0};function C0(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:S0(e),edges:k0(e)};return e.graph()!==void 0&&(t.value=structuredClone(e.graph())),t}function S0(e){return e.nodes().map(function(t){var n=e.node(t),r=e.parent(t),o={v:t};return n!==void 0&&(o.value=n),r!==void 0&&(o.parent=r),o})}function k0(e){return e.edges().map(function(t){var n=e.edge(t),r={v:t.v,w:t.w};return t.name!==void 0&&(r.name=t.name),n!==void 0&&(r.value=n),r})}function M0(e){var t=new _0(e.options).setGraph(e.value);return e.nodes.forEach(function(n){t.setNode(n.v,n.value),n.parent&&t.setParent(n.v,n.parent)}),e.edges.forEach(function(n){t.setEdge({v:n.v,w:n.w,name:n.name},n.value)}),t}var I0=$0;function $0(e){var t={},n=[],r;function o(i){Object.hasOwn(t,i)||(t[i]=!0,r.push(i),e.successors(i).forEach(o),e.predecessors(i).forEach(o))}return e.nodes().forEach(function(i){r=[],o(i),r.length&&n.push(r)}),n}let A0=class{constructor(){re(this,"_arr",[]);re(this,"_keyIndices",{})}size(){return this._arr.length}keys(){return this._arr.map(function(t){return t.key})}has(t){return Object.hasOwn(this._keyIndices,t)}priority(t){var n=this._keyIndices[t];if(n!==void 0)return this._arr[n].priority}min(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key}add(t,n){var r=this._keyIndices;if(t=String(t),!Object.hasOwn(r,t)){var o=this._arr,i=o.length;return r[t]=i,o.push({key:t,priority:n}),this._decrease(i),!0}return!1}removeMin(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key}decrease(t,n){var r=this._keyIndices[t];if(n>this._arr[r].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[r].priority+" New: "+n);this._arr[r].priority=n,this._decrease(r)}_heapify(t){var n=this._arr,r=2*t,o=r+1,i=t;r<n.length&&(i=n[r].priority<n[i].priority?r:i,o<n.length&&(i=n[o].priority<n[i].priority?o:i),i!==t&&(this._swap(t,i),this._heapify(i)))}_decrease(t){for(var n=this._arr,r=n[t].priority,o;t!==0&&(o=t>>1,!(n[o].priority<r));)this._swap(t,o),t=o}_swap(t,n){var r=this._arr,o=this._keyIndices,i=r[t],s=r[n];r[t]=s,r[n]=i,o[s.key]=t,o[i.key]=n}};var da=A0,P0=da,fa=O0,T0=()=>1;function O0(e,t,n,r){return j0(e,String(t),n||T0,r||function(o){return e.outEdges(o)})}function j0(e,t,n,r){var o={},i=new P0,s,a,c=function(l){var u=l.v!==s?l.v:l.w,d=o[u],f=n(l),h=a.distance+f;if(f<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+l+" Weight: "+f);h<d.distance&&(d.distance=h,d.predecessor=s,i.decrease(u,h))};for(e.nodes().forEach(function(l){var u=l===t?0:Number.POSITIVE_INFINITY;o[l]={distance:u},i.add(l,u)});i.size()>0&&(s=i.removeMin(),a=o[s],a.distance!==Number.POSITIVE_INFINITY);)r(s).forEach(c);return o}var L0=fa,R0=D0;function D0(e,t,n){return e.nodes().reduce(function(r,o){return r[o]=L0(e,o,t,n),r},{})}var ha=z0;function z0(e){var t=0,n=[],r={},o=[];function i(s){var a=r[s]={onStack:!0,lowlink:t,index:t++};if(n.push(s),e.successors(s).forEach(function(u){Object.hasOwn(r,u)?r[u].onStack&&(a.lowlink=Math.min(a.lowlink,r[u].index)):(i(u),a.lowlink=Math.min(a.lowlink,r[u].lowlink))}),a.lowlink===a.index){var c=[],l;do l=n.pop(),r[l].onStack=!1,c.push(l);while(s!==l);o.push(c)}}return e.nodes().forEach(function(s){Object.hasOwn(r,s)||i(s)}),o}var B0=ha,H0=V0;function V0(e){return B0(e).filter(function(t){return t.length>1||t.length===1&&e.hasEdge(t[0],t[0])})}var F0=X0,Y0=()=>1;function X0(e,t,n){return G0(e,t||Y0,n||function(r){return e.outEdges(r)})}function G0(e,t,n){var r={},o=e.nodes();return o.forEach(function(i){r[i]={},r[i][i]={distance:0},o.forEach(function(s){i!==s&&(r[i][s]={distance:Number.POSITIVE_INFINITY})}),n(i).forEach(function(s){var a=s.v===i?s.w:s.v,c=t(s);r[i][a]={distance:c,predecessor:i}})}),o.forEach(function(i){var s=r[i];o.forEach(function(a){var c=r[a];o.forEach(function(l){var u=c[i],d=s[l],f=c[l],h=u.distance+d.distance;h<f.distance&&(f.distance=h,f.predecessor=d.predecessor)})})}),r}function ga(e){var t={},n={},r=[];function o(i){if(Object.hasOwn(n,i))throw new fr;Object.hasOwn(t,i)||(n[i]=!0,t[i]=!0,e.predecessors(i).forEach(o),delete n[i],r.push(i))}if(e.sinks().forEach(o),Object.keys(t).length!==e.nodeCount())throw new fr;return r}class fr extends Error{constructor(){super(...arguments)}}var pa=ga;ga.CycleException=fr;var Jo=pa,W0=q0;function q0(e){try{Jo(e)}catch(t){if(t instanceof Jo.CycleException)return!1;throw t}return!0}var ma=K0;function K0(e,t,n){Array.isArray(t)||(t=[t]);var r=e.isDirected()?a=>e.successors(a):a=>e.neighbors(a),o=n==="post"?U0:Z0,i=[],s={};return t.forEach(a=>{if(!e.hasNode(a))throw new Error("Graph does not have node: "+a);o(a,r,s,i)}),i}function U0(e,t,n,r){for(var o=[[e,!1]];o.length>0;){var i=o.pop();i[1]?r.push(i[0]):Object.hasOwn(n,i[0])||(n[i[0]]=!0,o.push([i[0],!0]),ya(t(i[0]),s=>o.push([s,!1])))}}function Z0(e,t,n,r){for(var o=[e];o.length>0;){var i=o.pop();Object.hasOwn(n,i)||(n[i]=!0,r.push(i),ya(t(i),s=>o.push(s)))}}function ya(e,t){for(var n=e.length;n--;)t(e[n],n,e);return e}var Q0=ma,J0=em;function em(e,t){return Q0(e,t,"post")}var tm=ma,nm=rm;function rm(e,t){return tm(e,t,"pre")}var om=$r,im=da,sm=am;function am(e,t){var n=new om,r={},o=new im,i;function s(c){var l=c.v===i?c.w:c.v,u=o.priority(l);if(u!==void 0){var d=t(c);d<u&&(r[l]=i,o.decrease(l,d))}}if(e.nodeCount()===0)return n;e.nodes().forEach(function(c){o.add(c,Number.POSITIVE_INFINITY),n.setNode(c)}),o.decrease(e.nodes()[0],0);for(var a=!1;o.size()>0;){if(i=o.removeMin(),Object.hasOwn(r,i))n.setEdge(i,r[i]);else{if(a)throw new Error("Input graph is not connected: "+e);a=!0}e.nodeEdges(i).forEach(s)}return n}var cm={components:I0,dijkstra:fa,dijkstraAll:R0,findCycles:H0,floydWarshall:F0,isAcyclic:W0,postorder:J0,preorder:nm,prim:sm,tarjan:ha,topsort:pa},ei=E0,we={Graph:ei.Graph,json:N0,alg:cm,version:ei.version};let lm=class{constructor(){let t={};t._next=t._prev=t,this._sentinel=t}dequeue(){let t=this._sentinel,n=t._prev;if(n!==t)return ti(n),n}enqueue(t){let n=this._sentinel;t._prev&&t._next&&ti(t),t._next=n._next,n._next._prev=t,n._next=t,t._prev=n}toString(){let t=[],n=this._sentinel,r=n._prev;for(;r!==n;)t.push(JSON.stringify(r,um)),r=r._prev;return"["+t.join(", ")+"]"}};function ti(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function um(e,t){if(e!=="_next"&&e!=="_prev")return t}var dm=lm;let fm=we.Graph,hm=dm;var gm=mm;let pm=()=>1;function mm(e,t){if(e.nodeCount()<=1)return[];let n=xm(e,t||pm);return ym(n.graph,n.buckets,n.zeroIdx).flatMap(o=>e.outEdges(o.v,o.w))}function ym(e,t,n){let r=[],o=t[t.length-1],i=t[0],s;for(;e.nodeCount();){for(;s=i.dequeue();)Fn(e,t,n,s);for(;s=o.dequeue();)Fn(e,t,n,s);if(e.nodeCount()){for(let a=t.length-2;a>0;--a)if(s=t[a].dequeue(),s){r=r.concat(Fn(e,t,n,s,!0));break}}}return r}function Fn(e,t,n,r,o){let i=o?[]:void 0;return e.inEdges(r.v).forEach(s=>{let a=e.edge(s),c=e.node(s.v);o&&i.push({v:s.v,w:s.w}),c.out-=a,hr(t,n,c)}),e.outEdges(r.v).forEach(s=>{let a=e.edge(s),c=s.w,l=e.node(c);l.in-=a,hr(t,n,l)}),e.removeNode(r.v),i}function xm(e,t){let n=new fm,r=0,o=0;e.nodes().forEach(a=>{n.setNode(a,{v:a,in:0,out:0})}),e.edges().forEach(a=>{let c=n.edge(a.v,a.w)||0,l=t(a),u=c+l;n.setEdge(a.v,a.w,u),o=Math.max(o,n.node(a.v).out+=l),r=Math.max(r,n.node(a.w).in+=l)});let i=wm(o+r+3).map(()=>new hm),s=r+1;return n.nodes().forEach(a=>{hr(i,s,n.node(a))}),{graph:n,buckets:i,zeroIdx:s}}function hr(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}function wm(e){const t=[];for(let n=0;n<e;n++)t.push(n);return t}let xa=we.Graph;var oe={addBorderNode:Mm,addDummyNode:wa,applyWithChunking:_n,asNonCompoundGraph:bm,buildLayerMatrix:Cm,intersectRect:Nm,mapValues:jm,maxRank:ba,normalizeRanks:Sm,notime:Pm,partition:$m,pick:Om,predecessorWeights:_m,range:_a,removeEmptyRanks:km,simplify:vm,successorWeights:Em,time:Am,uniqueId:Ea,zipObject:Ar};function wa(e,t,n,r){let o;do o=Ea(r);while(e.hasNode(o));return n.dummy=t,e.setNode(o,n),o}function vm(e){let t=new xa().setGraph(e.graph());return e.nodes().forEach(n=>t.setNode(n,e.node(n))),e.edges().forEach(n=>{let r=t.edge(n.v,n.w)||{weight:0,minlen:1},o=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+o.weight,minlen:Math.max(r.minlen,o.minlen)})}),t}function bm(e){let t=new xa({multigraph:e.isMultigraph()}).setGraph(e.graph());return e.nodes().forEach(n=>{e.children(n).length||t.setNode(n,e.node(n))}),e.edges().forEach(n=>{t.setEdge(n,e.edge(n))}),t}function Em(e){let t=e.nodes().map(n=>{let r={};return e.outEdges(n).forEach(o=>{r[o.w]=(r[o.w]||0)+e.edge(o).weight}),r});return Ar(e.nodes(),t)}function _m(e){let t=e.nodes().map(n=>{let r={};return e.inEdges(n).forEach(o=>{r[o.v]=(r[o.v]||0)+e.edge(o).weight}),r});return Ar(e.nodes(),t)}function Nm(e,t){let n=e.x,r=e.y,o=t.x-n,i=t.y-r,s=e.width/2,a=e.height/2;if(!o&&!i)throw new Error("Not possible to find intersection inside of the rectangle");let c,l;return Math.abs(i)*s>Math.abs(o)*a?(i<0&&(a=-a),c=a*o/i,l=a):(o<0&&(s=-s),c=s,l=s*i/o),{x:n+c,y:r+l}}function Cm(e){let t=_a(ba(e)+1).map(()=>[]);return e.nodes().forEach(n=>{let r=e.node(n),o=r.rank;o!==void 0&&(t[o][r.order]=n)}),t}function Sm(e){let t=e.nodes().map(r=>{let o=e.node(r).rank;return o===void 0?Number.MAX_VALUE:o}),n=_n(Math.min,t);e.nodes().forEach(r=>{let o=e.node(r);Object.hasOwn(o,"rank")&&(o.rank-=n)})}function km(e){let t=e.nodes().map(s=>e.node(s).rank),n=_n(Math.min,t),r=[];e.nodes().forEach(s=>{let a=e.node(s).rank-n;r[a]||(r[a]=[]),r[a].push(s)});let o=0,i=e.graph().nodeRankFactor;Array.from(r).forEach((s,a)=>{s===void 0&&a%i!==0?--o:s!==void 0&&o&&s.forEach(c=>e.node(c).rank+=o)})}function Mm(e,t,n,r){let o={width:0,height:0};return arguments.length>=4&&(o.rank=n,o.order=r),wa(e,"border",o,t)}function Im(e,t=va){const n=[];for(let r=0;r<e.length;r+=t){const o=e.slice(r,r+t);n.push(o)}return n}const va=65535;function _n(e,t){if(t.length>va){const n=Im(t);return e.apply(null,n.map(r=>e.apply(null,r)))}else return e.apply(null,t)}function ba(e){const n=e.nodes().map(r=>{let o=e.node(r).rank;return o===void 0?Number.MIN_VALUE:o});return _n(Math.max,n)}function $m(e,t){let n={lhs:[],rhs:[]};return e.forEach(r=>{t(r)?n.lhs.push(r):n.rhs.push(r)}),n}function Am(e,t){let n=Date.now();try{return t()}finally{console.log(e+" time: "+(Date.now()-n)+"ms")}}function Pm(e,t){return t()}let Tm=0;function Ea(e){var t=++Tm;return toString(e)+t}function _a(e,t,n=1){t==null&&(t=e,e=0);let r=i=>i<t;n<0&&(r=i=>t<i);const o=[];for(let i=e;r(i);i+=n)o.push(i);return o}function Om(e,t){const n={};for(const r of t)e[r]!==void 0&&(n[r]=e[r]);return n}function jm(e,t){let n=t;return typeof t=="string"&&(n=r=>r[t]),Object.entries(e).reduce((r,[o,i])=>(r[o]=n(i,o),r),{})}function Ar(e,t){return e.reduce((n,r,o)=>(n[r]=t[o],n),{})}let Lm=gm,Rm=oe.uniqueId;var Dm={run:zm,undo:Hm};function zm(e){(e.graph().acyclicer==="greedy"?Lm(e,n(e)):Bm(e)).forEach(r=>{let o=e.edge(r);e.removeEdge(r),o.forwardName=r.name,o.reversed=!0,e.setEdge(r.w,r.v,o,Rm("rev"))});function n(r){return o=>r.edge(o).weight}}function Bm(e){let t=[],n={},r={};function o(i){Object.hasOwn(r,i)||(r[i]=!0,n[i]=!0,e.outEdges(i).forEach(s=>{Object.hasOwn(n,s.w)?t.push(s):o(s.w)}),delete n[i])}return e.nodes().forEach(o),t}function Hm(e){e.edges().forEach(t=>{let n=e.edge(t);if(n.reversed){e.removeEdge(t);let r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}})}let Vm=oe;var Fm={run:Ym,undo:Gm};function Ym(e){e.graph().dummyChains=[],e.edges().forEach(t=>Xm(e,t))}function Xm(e,t){let n=t.v,r=e.node(n).rank,o=t.w,i=e.node(o).rank,s=t.name,a=e.edge(t),c=a.labelRank;if(i===r+1)return;e.removeEdge(t);let l,u,d;for(d=0,++r;r<i;++d,++r)a.points=[],u={width:0,height:0,edgeLabel:a,edgeObj:t,rank:r},l=Vm.addDummyNode(e,"edge",u,"_d"),r===c&&(u.width=a.width,u.height=a.height,u.dummy="edge-label",u.labelpos=a.labelpos),e.setEdge(n,l,{weight:a.weight},s),d===0&&e.graph().dummyChains.push(l),n=l;e.setEdge(n,o,{weight:a.weight},s)}function Gm(e){e.graph().dummyChains.forEach(t=>{let n=e.node(t),r=n.edgeLabel,o;for(e.setEdge(n.edgeObj,r);n.dummy;)o=e.successors(t)[0],e.removeNode(t),r.points.push({x:n.x,y:n.y}),n.dummy==="edge-label"&&(r.x=n.x,r.y=n.y,r.width=n.width,r.height=n.height),t=o,n=e.node(t)})}const{applyWithChunking:Wm}=oe;var Nn={longestPath:qm,slack:Km};function qm(e){var t={};function n(r){var o=e.node(r);if(Object.hasOwn(t,r))return o.rank;t[r]=!0;let i=e.outEdges(r).map(a=>a==null?Number.POSITIVE_INFINITY:n(a.w)-e.edge(a).minlen);var s=Wm(Math.min,i);return s===Number.POSITIVE_INFINITY&&(s=0),o.rank=s}e.sources().forEach(n)}function Km(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}var Um=we.Graph,sn=Nn.slack,Na=Zm;function Zm(e){var t=new Um({directed:!1}),n=e.nodes()[0],r=e.nodeCount();t.setNode(n,{});for(var o,i;Qm(t,e)<r;)o=Jm(t,e),i=t.hasNode(o.v)?sn(e,o):-sn(e,o),ey(t,e,i);return t}function Qm(e,t){function n(r){t.nodeEdges(r).forEach(o=>{var i=o.v,s=r===i?o.w:i;!e.hasNode(s)&&!sn(t,o)&&(e.setNode(s,{}),e.setEdge(r,s,{}),n(s))})}return e.nodes().forEach(n),e.nodeCount()}function Jm(e,t){return t.edges().reduce((r,o)=>{let i=Number.POSITIVE_INFINITY;return e.hasNode(o.v)!==e.hasNode(o.w)&&(i=sn(t,o)),i<r[0]?[i,o]:r},[Number.POSITIVE_INFINITY,null])[1]}function ey(e,t,n){e.nodes().forEach(r=>t.node(r).rank+=n)}var ty=Na,ni=Nn.slack,ny=Nn.longestPath,ry=we.alg.preorder,oy=we.alg.postorder,iy=oe.simplify,sy=Ye;Ye.initLowLimValues=Tr;Ye.initCutValues=Pr;Ye.calcCutValue=Ca;Ye.leaveEdge=ka;Ye.enterEdge=Ma;Ye.exchangeEdges=Ia;function Ye(e){e=iy(e),ny(e);var t=ty(e);Tr(t),Pr(t,e);for(var n,r;n=ka(t);)r=Ma(t,e,n),Ia(t,e,n,r)}function Pr(e,t){var n=oy(e,e.nodes());n=n.slice(0,n.length-1),n.forEach(r=>ay(e,t,r))}function ay(e,t,n){var r=e.node(n),o=r.parent;e.edge(n,o).cutvalue=Ca(e,t,n)}function Ca(e,t,n){var r=e.node(n),o=r.parent,i=!0,s=t.edge(n,o),a=0;return s||(i=!1,s=t.edge(o,n)),a=s.weight,t.nodeEdges(n).forEach(c=>{var l=c.v===n,u=l?c.w:c.v;if(u!==o){var d=l===i,f=t.edge(c).weight;if(a+=d?f:-f,ly(e,n,u)){var h=e.edge(n,u).cutvalue;a+=d?-h:h}}}),a}function Tr(e,t){arguments.length<2&&(t=e.nodes()[0]),Sa(e,{},1,t)}function Sa(e,t,n,r,o){var i=n,s=e.node(r);return t[r]=!0,e.neighbors(r).forEach(a=>{Object.hasOwn(t,a)||(n=Sa(e,t,n,a,r))}),s.low=i,s.lim=n++,o?s.parent=o:delete s.parent,n}function ka(e){return e.edges().find(t=>e.edge(t).cutvalue<0)}function Ma(e,t,n){var r=n.v,o=n.w;t.hasEdge(r,o)||(r=n.w,o=n.v);var i=e.node(r),s=e.node(o),a=i,c=!1;i.lim>s.lim&&(a=s,c=!0);var l=t.edges().filter(u=>c===ri(e,e.node(u.v),a)&&c!==ri(e,e.node(u.w),a));return l.reduce((u,d)=>ni(t,d)<ni(t,u)?d:u)}function Ia(e,t,n,r){var o=n.v,i=n.w;e.removeEdge(o,i),e.setEdge(r.v,r.w,{}),Tr(e),Pr(e,t),cy(e,t)}function cy(e,t){var n=e.nodes().find(o=>!t.node(o).parent),r=ry(e,n);r=r.slice(1),r.forEach(o=>{var i=e.node(o).parent,s=t.edge(o,i),a=!1;s||(s=t.edge(i,o),a=!0),t.node(o).rank=t.node(i).rank+(a?s.minlen:-s.minlen)})}function ly(e,t,n){return e.hasEdge(t,n)}function ri(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}var uy=Nn,$a=uy.longestPath,dy=Na,fy=sy,hy=gy;function gy(e){switch(e.graph().ranker){case"network-simplex":oi(e);break;case"tight-tree":my(e);break;case"longest-path":py(e);break;default:oi(e)}}var py=$a;function my(e){$a(e),dy(e)}function oi(e){fy(e)}var yy=xy;function xy(e){let t=vy(e);e.graph().dummyChains.forEach(n=>{let r=e.node(n),o=r.edgeObj,i=wy(e,t,o.v,o.w),s=i.path,a=i.lca,c=0,l=s[c],u=!0;for(;n!==o.w;){if(r=e.node(n),u){for(;(l=s[c])!==a&&e.node(l).maxRank<r.rank;)c++;l===a&&(u=!1)}if(!u){for(;c<s.length-1&&e.node(l=s[c+1]).minRank<=r.rank;)c++;l=s[c]}e.setParent(n,l),n=e.successors(n)[0]}})}function wy(e,t,n,r){let o=[],i=[],s=Math.min(t[n].low,t[r].low),a=Math.max(t[n].lim,t[r].lim),c,l;c=n;do c=e.parent(c),o.push(c);while(c&&(t[c].low>s||a>t[c].lim));for(l=c,c=r;(c=e.parent(c))!==l;)i.push(c);return{path:o.concat(i.reverse()),lca:l}}function vy(e){let t={},n=0;function r(o){let i=n;e.children(o).forEach(r),t[o]={low:i,lim:n++}}return e.children().forEach(r),t}let an=oe;var by={run:Ey,cleanup:Cy};function Ey(e){let t=an.addDummyNode(e,"root",{},"_root"),n=_y(e),r=Object.values(n),o=an.applyWithChunking(Math.max,r)-1,i=2*o+1;e.graph().nestingRoot=t,e.edges().forEach(a=>e.edge(a).minlen*=i);let s=Ny(e)+1;e.children().forEach(a=>Aa(e,t,i,s,o,n,a)),e.graph().nodeRankFactor=i}function Aa(e,t,n,r,o,i,s){let a=e.children(s);if(!a.length){s!==t&&e.setEdge(t,s,{weight:0,minlen:n});return}let c=an.addBorderNode(e,"_bt"),l=an.addBorderNode(e,"_bb"),u=e.node(s);e.setParent(c,s),u.borderTop=c,e.setParent(l,s),u.borderBottom=l,a.forEach(d=>{Aa(e,t,n,r,o,i,d);let f=e.node(d),h=f.borderTop?f.borderTop:d,g=f.borderBottom?f.borderBottom:d,p=f.borderTop?r:2*r,y=h!==g?1:o-i[s]+1;e.setEdge(c,h,{weight:p,minlen:y,nestingEdge:!0}),e.setEdge(g,l,{weight:p,minlen:y,nestingEdge:!0})}),e.parent(s)||e.setEdge(t,c,{weight:0,minlen:o+i[s]})}function _y(e){var t={};function n(r,o){var i=e.children(r);i&&i.length&&i.forEach(s=>n(s,o+1)),t[r]=o}return e.children().forEach(r=>n(r,1)),t}function Ny(e){return e.edges().reduce((t,n)=>t+e.edge(n).weight,0)}function Cy(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,e.edges().forEach(n=>{var r=e.edge(n);r.nestingEdge&&e.removeEdge(n)})}let Sy=oe;var ky=My;function My(e){function t(n){let r=e.children(n),o=e.node(n);if(r.length&&r.forEach(t),Object.hasOwn(o,"minRank")){o.borderLeft=[],o.borderRight=[];for(let i=o.minRank,s=o.maxRank+1;i<s;++i)ii(e,"borderLeft","_bl",n,o,i),ii(e,"borderRight","_br",n,o,i)}}e.children().forEach(t)}function ii(e,t,n,r,o,i){let s={width:0,height:0,rank:i,borderType:t},a=o[t][i-1],c=Sy.addDummyNode(e,"border",s,n);o[t][i]=c,e.setParent(c,r),a&&e.setEdge(a,c,{weight:1})}var Iy={adjust:$y,undo:Ay};function $y(e){let t=e.graph().rankdir.toLowerCase();(t==="lr"||t==="rl")&&Pa(e)}function Ay(e){let t=e.graph().rankdir.toLowerCase();(t==="bt"||t==="rl")&&Py(e),(t==="lr"||t==="rl")&&(Ty(e),Pa(e))}function Pa(e){e.nodes().forEach(t=>si(e.node(t))),e.edges().forEach(t=>si(e.edge(t)))}function si(e){let t=e.width;e.width=e.height,e.height=t}function Py(e){e.nodes().forEach(t=>Yn(e.node(t))),e.edges().forEach(t=>{let n=e.edge(t);n.points.forEach(Yn),Object.hasOwn(n,"y")&&Yn(n)})}function Yn(e){e.y=-e.y}function Ty(e){e.nodes().forEach(t=>Xn(e.node(t))),e.edges().forEach(t=>{let n=e.edge(t);n.points.forEach(Xn),Object.hasOwn(n,"x")&&Xn(n)})}function Xn(e){let t=e.x;e.x=e.y,e.y=t}let ai=oe;var Oy=jy;function jy(e){let t={},n=e.nodes().filter(c=>!e.children(c).length),r=n.map(c=>e.node(c).rank),o=ai.applyWithChunking(Math.max,r),i=ai.range(o+1).map(()=>[]);function s(c){if(t[c])return;t[c]=!0;let l=e.node(c);i[l.rank].push(c),e.successors(c).forEach(s)}return n.sort((c,l)=>e.node(c).rank-e.node(l).rank).forEach(s),i}let Ly=oe.zipObject;var Ry=Dy;function Dy(e,t){let n=0;for(let r=1;r<t.length;++r)n+=zy(e,t[r-1],t[r]);return n}function zy(e,t,n){let r=Ly(n,n.map((l,u)=>u)),o=t.flatMap(l=>e.outEdges(l).map(u=>({pos:r[u.w],weight:e.edge(u).weight})).sort((u,d)=>u.pos-d.pos)),i=1;for(;i<n.length;)i<<=1;let s=2*i-1;i-=1;let a=new Array(s).fill(0),c=0;return o.forEach(l=>{let u=l.pos+i;a[u]+=l.weight;let d=0;for(;u>0;)u%2&&(d+=a[u+1]),u=u-1>>1,a[u]+=l.weight;c+=l.weight*d}),c}var By=Hy;function Hy(e,t=[]){return t.map(n=>{let r=e.inEdges(n);if(r.length){let o=r.reduce((i,s)=>{let a=e.edge(s),c=e.node(s.v);return{sum:i.sum+a.weight*c.order,weight:i.weight+a.weight}},{sum:0,weight:0});return{v:n,barycenter:o.sum/o.weight,weight:o.weight}}else return{v:n}})}let Vy=oe;var Fy=Yy;function Yy(e,t){let n={};e.forEach((o,i)=>{let s=n[o.v]={indegree:0,in:[],out:[],vs:[o.v],i};o.barycenter!==void 0&&(s.barycenter=o.barycenter,s.weight=o.weight)}),t.edges().forEach(o=>{let i=n[o.v],s=n[o.w];i!==void 0&&s!==void 0&&(s.indegree++,i.out.push(n[o.w]))});let r=Object.values(n).filter(o=>!o.indegree);return Xy(r)}function Xy(e){let t=[];function n(o){return i=>{i.merged||(i.barycenter===void 0||o.barycenter===void 0||i.barycenter>=o.barycenter)&&Gy(o,i)}}function r(o){return i=>{i.in.push(o),--i.indegree===0&&e.push(i)}}for(;e.length;){let o=e.pop();t.push(o),o.in.reverse().forEach(n(o)),o.out.forEach(r(o))}return t.filter(o=>!o.merged).map(o=>Vy.pick(o,["vs","i","barycenter","weight"]))}function Gy(e,t){let n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight),t.weight&&(n+=t.barycenter*t.weight,r+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0}let Wy=oe;var qy=Ky;function Ky(e,t){let n=Wy.partition(e,u=>Object.hasOwn(u,"barycenter")),r=n.lhs,o=n.rhs.sort((u,d)=>d.i-u.i),i=[],s=0,a=0,c=0;r.sort(Uy(!!t)),c=ci(i,o,c),r.forEach(u=>{c+=u.vs.length,i.push(u.vs),s+=u.barycenter*u.weight,a+=u.weight,c=ci(i,o,c)});let l={vs:i.flat(!0)};return a&&(l.barycenter=s/a,l.weight=a),l}function ci(e,t,n){let r;for(;t.length&&(r=t[t.length-1]).i<=n;)t.pop(),e.push(r.vs),n++;return n}function Uy(e){return(t,n)=>t.barycenter<n.barycenter?-1:t.barycenter>n.barycenter?1:e?n.i-t.i:t.i-n.i}let Zy=By,Qy=Fy,Jy=qy;var ex=Ta;function Ta(e,t,n,r){let o=e.children(t),i=e.node(t),s=i?i.borderLeft:void 0,a=i?i.borderRight:void 0,c={};s&&(o=o.filter(f=>f!==s&&f!==a));let l=Zy(e,o);l.forEach(f=>{if(e.children(f.v).length){let h=Ta(e,f.v,n,r);c[f.v]=h,Object.hasOwn(h,"barycenter")&&nx(f,h)}});let u=Qy(l,n);tx(u,c);let d=Jy(u,r);if(s&&(d.vs=[s,d.vs,a].flat(!0),e.predecessors(s).length)){let f=e.node(e.predecessors(s)[0]),h=e.node(e.predecessors(a)[0]);Object.hasOwn(d,"barycenter")||(d.barycenter=0,d.weight=0),d.barycenter=(d.barycenter*d.weight+f.order+h.order)/(d.weight+2),d.weight+=2}return d}function tx(e,t){e.forEach(n=>{n.vs=n.vs.flatMap(r=>t[r]?t[r].vs:r)})}function nx(e,t){e.barycenter!==void 0?(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight):(e.barycenter=t.barycenter,e.weight=t.weight)}let rx=we.Graph,ox=oe;var ix=sx;function sx(e,t,n){let r=ax(e),o=new rx({compound:!0}).setGraph({root:r}).setDefaultNodeLabel(i=>e.node(i));return e.nodes().forEach(i=>{let s=e.node(i),a=e.parent(i);(s.rank===t||s.minRank<=t&&t<=s.maxRank)&&(o.setNode(i),o.setParent(i,a||r),e[n](i).forEach(c=>{let l=c.v===i?c.w:c.v,u=o.edge(l,i),d=u!==void 0?u.weight:0;o.setEdge(l,i,{weight:e.edge(c).weight+d})}),Object.hasOwn(s,"minRank")&&o.setNode(i,{borderLeft:s.borderLeft[t],borderRight:s.borderRight[t]}))}),o}function ax(e){for(var t;e.hasNode(t=ox.uniqueId("_root")););return t}var cx=lx;function lx(e,t,n){let r={},o;n.forEach(i=>{let s=e.parent(i),a,c;for(;s;){if(a=e.parent(s),a?(c=r[a],r[a]=s):(c=o,o=s),c&&c!==s){t.setEdge(c,s);return}s=a}})}let ux=Oy,dx=Ry,fx=ex,hx=ix,gx=cx,px=we.Graph,Yt=oe;var mx=Oa;function Oa(e,t){if(t&&typeof t.customOrder=="function"){t.customOrder(e,Oa);return}let n=Yt.maxRank(e),r=li(e,Yt.range(1,n+1),"inEdges"),o=li(e,Yt.range(n-1,-1,-1),"outEdges"),i=ux(e);if(ui(e,i),t&&t.disableOptimalOrderHeuristic)return;let s=Number.POSITIVE_INFINITY,a;for(let c=0,l=0;l<4;++c,++l){yx(c%2?r:o,c%4>=2),i=Yt.buildLayerMatrix(e);let u=dx(e,i);u<s&&(l=0,a=Object.assign({},i),s=u)}ui(e,a)}function li(e,t,n){return t.map(function(r){return hx(e,r,n)})}function yx(e,t){let n=new px;e.forEach(function(r){let o=r.graph().root,i=fx(r,o,n,t);i.vs.forEach((s,a)=>r.node(s).order=a),gx(r,n,i.vs)})}function ui(e,t){Object.values(t).forEach(n=>n.forEach((r,o)=>e.node(r).order=o))}let xx=we.Graph,_e=oe;var wx={positionX:Ex,findType1Conflicts:ja,findType2Conflicts:La,addConflict:Or,hasConflict:Ra,verticalAlignment:Da,horizontalCompaction:za,alignCoordinates:Ha,findSmallestWidthAlignment:Ba,balance:Va};function ja(e,t){let n={};function r(o,i){let s=0,a=0,c=o.length,l=i[i.length-1];return i.forEach((u,d)=>{let f=vx(e,u),h=f?e.node(f).order:c;(f||u===l)&&(i.slice(a,d+1).forEach(g=>{e.predecessors(g).forEach(p=>{let y=e.node(p),m=y.order;(m<s||h<m)&&!(y.dummy&&e.node(g).dummy)&&Or(n,p,g)})}),a=d+1,s=h)}),i}return t.length&&t.reduce(r),n}function La(e,t){let n={};function r(i,s,a,c,l){let u;_e.range(s,a).forEach(d=>{u=i[d],e.node(u).dummy&&e.predecessors(u).forEach(f=>{let h=e.node(f);h.dummy&&(h.order<c||h.order>l)&&Or(n,f,u)})})}function o(i,s){let a=-1,c,l=0;return s.forEach((u,d)=>{if(e.node(u).dummy==="border"){let f=e.predecessors(u);f.length&&(c=e.node(f[0]).order,r(s,l,d,a,c),l=d,a=c)}r(s,l,s.length,c,i.length)}),s}return t.length&&t.reduce(o),n}function vx(e,t){if(e.node(t).dummy)return e.predecessors(t).find(n=>e.node(n).dummy)}function Or(e,t,n){if(t>n){let o=t;t=n,n=o}let r=e[t];r||(e[t]=r={}),r[n]=!0}function Ra(e,t,n){if(t>n){let r=t;t=n,n=r}return!!e[t]&&Object.hasOwn(e[t],n)}function Da(e,t,n,r){let o={},i={},s={};return t.forEach(a=>{a.forEach((c,l)=>{o[c]=c,i[c]=c,s[c]=l})}),t.forEach(a=>{let c=-1;a.forEach(l=>{let u=r(l);if(u.length){u=u.sort((f,h)=>s[f]-s[h]);let d=(u.length-1)/2;for(let f=Math.floor(d),h=Math.ceil(d);f<=h;++f){let g=u[f];i[l]===l&&c<s[g]&&!Ra(n,l,g)&&(i[g]=l,i[l]=o[l]=o[g],c=s[g])}}})}),{root:o,align:i}}function za(e,t,n,r,o){let i={},s=bx(e,t,n,o),a=o?"borderLeft":"borderRight";function c(d,f){let h=s.nodes(),g=h.pop(),p={};for(;g;)p[g]?d(g):(p[g]=!0,h.push(g),h=h.concat(f(g))),g=h.pop()}function l(d){i[d]=s.inEdges(d).reduce((f,h)=>Math.max(f,i[h.v]+s.edge(h)),0)}function u(d){let f=s.outEdges(d).reduce((g,p)=>Math.min(g,i[p.w]-s.edge(p)),Number.POSITIVE_INFINITY),h=e.node(d);f!==Number.POSITIVE_INFINITY&&h.borderType!==a&&(i[d]=Math.max(i[d],f))}return c(l,s.predecessors.bind(s)),c(u,s.successors.bind(s)),Object.keys(r).forEach(d=>i[d]=i[n[d]]),i}function bx(e,t,n,r){let o=new xx,i=e.graph(),s=_x(i.nodesep,i.edgesep,r);return t.forEach(a=>{let c;a.forEach(l=>{let u=n[l];if(o.setNode(u),c){var d=n[c],f=o.edge(d,u);o.setEdge(d,u,Math.max(s(e,l,c),f||0))}c=l})}),o}function Ba(e,t){return Object.values(t).reduce((n,r)=>{let o=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;Object.entries(r).forEach(([a,c])=>{let l=Nx(e,a)/2;o=Math.max(c+l,o),i=Math.min(c-l,i)});const s=o-i;return s<n[0]&&(n=[s,r]),n},[Number.POSITIVE_INFINITY,null])[1]}function Ha(e,t){let n=Object.values(t),r=_e.applyWithChunking(Math.min,n),o=_e.applyWithChunking(Math.max,n);["u","d"].forEach(i=>{["l","r"].forEach(s=>{let a=i+s,c=e[a];if(c===t)return;let l=Object.values(c),u=r-_e.applyWithChunking(Math.min,l);s!=="l"&&(u=o-_e.applyWithChunking(Math.max,l)),u&&(e[a]=_e.mapValues(c,d=>d+u))})})}function Va(e,t){return _e.mapValues(e.ul,(n,r)=>{if(t)return e[t.toLowerCase()][r];{let o=Object.values(e).map(i=>i[r]).sort((i,s)=>i-s);return(o[1]+o[2])/2}})}function Ex(e){let t=_e.buildLayerMatrix(e),n=Object.assign(ja(e,t),La(e,t)),r={},o;["u","d"].forEach(s=>{o=s==="u"?t:Object.values(t).reverse(),["l","r"].forEach(a=>{a==="r"&&(o=o.map(d=>Object.values(d).reverse()));let c=(s==="u"?e.predecessors:e.successors).bind(e),l=Da(e,o,n,c),u=za(e,o,l.root,l.align,a==="r");a==="r"&&(u=_e.mapValues(u,d=>-d)),r[s+a]=u})});let i=Ba(e,r);return Ha(r,i),Va(r,e.graph().align)}function _x(e,t,n){return(r,o,i)=>{let s=r.node(o),a=r.node(i),c=0,l;if(c+=s.width/2,Object.hasOwn(s,"labelpos"))switch(s.labelpos.toLowerCase()){case"l":l=-s.width/2;break;case"r":l=s.width/2;break}if(l&&(c+=n?l:-l),l=0,c+=(s.dummy?t:e)/2,c+=(a.dummy?t:e)/2,c+=a.width/2,Object.hasOwn(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":l=a.width/2;break;case"r":l=-a.width/2;break}return l&&(c+=n?l:-l),l=0,c}}function Nx(e,t){return e.node(t).width}let Fa=oe,Cx=wx.positionX;var Sx=kx;function kx(e){e=Fa.asNonCompoundGraph(e),Mx(e),Object.entries(Cx(e)).forEach(([t,n])=>e.node(t).x=n)}function Mx(e){let t=Fa.buildLayerMatrix(e),n=e.graph().ranksep,r=0;t.forEach(o=>{const i=o.reduce((s,a)=>{const c=e.node(a).height;return s>c?s:c},0);o.forEach(s=>e.node(s).y=r+i/2),r+=i+n})}let di=Dm,fi=Fm,Ix=hy,$x=oe.normalizeRanks,Ax=yy,Px=oe.removeEmptyRanks,hi=by,Tx=ky,gi=Iy,Ox=mx,jx=Sx,fe=oe,Lx=we.Graph;var Rx=Dx;function Dx(e,t){let n=t&&t.debugTiming?fe.time:fe.notime;n("layout",()=>{let r=n("  buildLayoutGraph",()=>qx(e));n("  runLayout",()=>zx(r,n,t)),n("  updateInputGraph",()=>Bx(e,r))})}function zx(e,t,n){t("    makeSpaceForEdgeLabels",()=>Kx(e)),t("    removeSelfEdges",()=>ow(e)),t("    acyclic",()=>di.run(e)),t("    nestingGraph.run",()=>hi.run(e)),t("    rank",()=>Ix(fe.asNonCompoundGraph(e))),t("    injectEdgeLabelProxies",()=>Ux(e)),t("    removeEmptyRanks",()=>Px(e)),t("    nestingGraph.cleanup",()=>hi.cleanup(e)),t("    normalizeRanks",()=>$x(e)),t("    assignRankMinMax",()=>Zx(e)),t("    removeEdgeLabelProxies",()=>Qx(e)),t("    normalize.run",()=>fi.run(e)),t("    parentDummyChains",()=>Ax(e)),t("    addBorderSegments",()=>Tx(e)),t("    order",()=>Ox(e,n)),t("    insertSelfEdges",()=>iw(e)),t("    adjustCoordinateSystem",()=>gi.adjust(e)),t("    position",()=>jx(e)),t("    positionSelfEdges",()=>sw(e)),t("    removeBorderNodes",()=>rw(e)),t("    normalize.undo",()=>fi.undo(e)),t("    fixupEdgeLabelCoords",()=>tw(e)),t("    undoCoordinateSystem",()=>gi.undo(e)),t("    translateGraph",()=>Jx(e)),t("    assignNodeIntersects",()=>ew(e)),t("    reversePoints",()=>nw(e)),t("    acyclic.undo",()=>di.undo(e))}function Bx(e,t){e.nodes().forEach(n=>{let r=e.node(n),o=t.node(n);r&&(r.x=o.x,r.y=o.y,r.rank=o.rank,t.children(n).length&&(r.width=o.width,r.height=o.height))}),e.edges().forEach(n=>{let r=e.edge(n),o=t.edge(n);r.points=o.points,Object.hasOwn(o,"x")&&(r.x=o.x,r.y=o.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}let Hx=["nodesep","edgesep","ranksep","marginx","marginy"],Vx={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},Fx=["acyclicer","ranker","rankdir","align"],Yx=["width","height"],pi={width:0,height:0},Xx=["minlen","weight","width","height","labeloffset"],Gx={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Wx=["labelpos"];function qx(e){let t=new Lx({multigraph:!0,compound:!0}),n=Wn(e.graph());return t.setGraph(Object.assign({},Vx,Gn(n,Hx),fe.pick(n,Fx))),e.nodes().forEach(r=>{let o=Wn(e.node(r));const i=Gn(o,Yx);Object.keys(pi).forEach(s=>{i[s]===void 0&&(i[s]=pi[s])}),t.setNode(r,i),t.setParent(r,e.parent(r))}),e.edges().forEach(r=>{let o=Wn(e.edge(r));t.setEdge(r,Object.assign({},Gx,Gn(o,Xx),fe.pick(o,Wx)))}),t}function Kx(e){let t=e.graph();t.ranksep/=2,e.edges().forEach(n=>{let r=e.edge(n);r.minlen*=2,r.labelpos.toLowerCase()!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?r.width+=r.labeloffset:r.height+=r.labeloffset)})}function Ux(e){e.edges().forEach(t=>{let n=e.edge(t);if(n.width&&n.height){let r=e.node(t.v),i={rank:(e.node(t.w).rank-r.rank)/2+r.rank,e:t};fe.addDummyNode(e,"edge-proxy",i,"_ep")}})}function Zx(e){let t=0;e.nodes().forEach(n=>{let r=e.node(n);r.borderTop&&(r.minRank=e.node(r.borderTop).rank,r.maxRank=e.node(r.borderBottom).rank,t=Math.max(t,r.maxRank))}),e.graph().maxRank=t}function Qx(e){e.nodes().forEach(t=>{let n=e.node(t);n.dummy==="edge-proxy"&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))})}function Jx(e){let t=Number.POSITIVE_INFINITY,n=0,r=Number.POSITIVE_INFINITY,o=0,i=e.graph(),s=i.marginx||0,a=i.marginy||0;function c(l){let u=l.x,d=l.y,f=l.width,h=l.height;t=Math.min(t,u-f/2),n=Math.max(n,u+f/2),r=Math.min(r,d-h/2),o=Math.max(o,d+h/2)}e.nodes().forEach(l=>c(e.node(l))),e.edges().forEach(l=>{let u=e.edge(l);Object.hasOwn(u,"x")&&c(u)}),t-=s,r-=a,e.nodes().forEach(l=>{let u=e.node(l);u.x-=t,u.y-=r}),e.edges().forEach(l=>{let u=e.edge(l);u.points.forEach(d=>{d.x-=t,d.y-=r}),Object.hasOwn(u,"x")&&(u.x-=t),Object.hasOwn(u,"y")&&(u.y-=r)}),i.width=n-t+s,i.height=o-r+a}function ew(e){e.edges().forEach(t=>{let n=e.edge(t),r=e.node(t.v),o=e.node(t.w),i,s;n.points?(i=n.points[0],s=n.points[n.points.length-1]):(n.points=[],i=o,s=r),n.points.unshift(fe.intersectRect(r,i)),n.points.push(fe.intersectRect(o,s))})}function tw(e){e.edges().forEach(t=>{let n=e.edge(t);if(Object.hasOwn(n,"x"))switch((n.labelpos==="l"||n.labelpos==="r")&&(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset;break}})}function nw(e){e.edges().forEach(t=>{let n=e.edge(t);n.reversed&&n.points.reverse()})}function rw(e){e.nodes().forEach(t=>{if(e.children(t).length){let n=e.node(t),r=e.node(n.borderTop),o=e.node(n.borderBottom),i=e.node(n.borderLeft[n.borderLeft.length-1]),s=e.node(n.borderRight[n.borderRight.length-1]);n.width=Math.abs(s.x-i.x),n.height=Math.abs(o.y-r.y),n.x=i.x+n.width/2,n.y=r.y+n.height/2}}),e.nodes().forEach(t=>{e.node(t).dummy==="border"&&e.removeNode(t)})}function ow(e){e.edges().forEach(t=>{if(t.v===t.w){var n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function iw(e){var t=fe.buildLayerMatrix(e);t.forEach(n=>{var r=0;n.forEach((o,i)=>{var s=e.node(o);s.order=i+r,(s.selfEdges||[]).forEach(a=>{fe.addDummyNode(e,"selfedge",{width:a.label.width,height:a.label.height,rank:s.rank,order:i+ ++r,e:a.e,label:a.label},"_se")}),delete s.selfEdges})})}function sw(e){e.nodes().forEach(t=>{var n=e.node(t);if(n.dummy==="selfedge"){var r=e.node(n.e.v),o=r.x+r.width/2,i=r.y,s=n.x-o,a=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:o+2*s/3,y:i-a},{x:o+5*s/6,y:i-a},{x:o+s,y:i},{x:o+5*s/6,y:i+a},{x:o+2*s/3,y:i+a}],n.label.x=n.x,n.label.y=n.y}})}function Gn(e,t){return fe.mapValues(fe.pick(e,t),Number)}function Wn(e){var t={};return e&&Object.entries(e).forEach(([n,r])=>{typeof n=="string"&&(n=n.toLowerCase()),t[n]=r}),t}let aw=oe,cw=we.Graph;var lw={debugOrdering:uw};function uw(e){let t=aw.buildLayerMatrix(e),n=new cw({compound:!0,multigraph:!0}).setGraph({});return e.nodes().forEach(r=>{n.setNode(r,{label:r}),n.setParent(r,"layer"+e.node(r).rank)}),e.edges().forEach(r=>n.setEdge(r.v,r.w,{},r.name)),t.forEach((r,o)=>{let i="layer"+o;n.setNode(i,{rank:"same"}),r.reduce((s,a)=>(n.setEdge(s,a,{style:"invis"}),a))}),n}var dw="1.1.4",fw={graphlib:we,layout:Rx,debug:lw,util:{time:oe.time,notime:oe.notime},version:dw};const mi=bi(fw),hw=150,gw=20,pw=32,mw=e=>{const{direction:t="LR",maxFreeNodeCount:n=3}=e||{};return{name:"DagreLayout",layout:o=>{const{nodes:i,edges:s}=o;if(i.length==0)return[];const a=t==="LR",c=new mi.graphlib.Graph({directed:!1}).setDefaultEdgeLabel(()=>({}));c.setGraph({rankdir:t}),i.forEach(d=>{const{width:f=hw,height:h=gw}=d;c.setNode(d.id,{width:f+pw,height:h})}),s.forEach(d=>{c.setEdge(d.source.id,d.target.id)});const l=[],u=()=>{for(let d=0;d<l.length-1;d+=1)c.setEdge(l[d].id,l[d+1].id);l.splice(0,l.length)};return i.forEach(d=>{s.find(f=>f.source.id===d.id||f.target.id===d.id)?u():(l.push(d),l.length>=n&&u())}),u(),mi.layout(c),i.map(d=>{const f=c.node(d.id),{width:h=0,height:g=0}=d;return{...d,x:f.x-(a?0:h/2),y:f.y-(a?g/2:0)}})}}};function yw(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function o(){var i,s=n.length,a,c=0,l=0;for(i=0;i<s;++i)a=n[i],c+=a.x,l+=a.y;for(c=(c/s-e)*r,l=(l/s-t)*r,i=0;i<s;++i)a=n[i],a.x-=c,a.y-=l}return o.initialize=function(i){n=i},o.x=function(i){return arguments.length?(e=+i,o):e},o.y=function(i){return arguments.length?(t=+i,o):t},o.strength=function(i){return arguments.length?(r=+i,o):r},o}function xw(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return Ya(this.cover(t,n),t,n,e)}function Ya(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var o,i=e._root,s={data:r},a=e._x0,c=e._y0,l=e._x1,u=e._y1,d,f,h,g,p,y,m,E;if(!i)return e._root=s,e;for(;i.length;)if((p=t>=(d=(a+l)/2))?a=d:l=d,(y=n>=(f=(c+u)/2))?c=f:u=f,o=i,!(i=i[m=y<<1|p]))return o[m]=s,e;if(h=+e._x.call(null,i.data),g=+e._y.call(null,i.data),t===h&&n===g)return s.next=i,o?o[m]=s:e._root=s,e;do o=o?o[m]=new Array(4):e._root=new Array(4),(p=t>=(d=(a+l)/2))?a=d:l=d,(y=n>=(f=(c+u)/2))?c=f:u=f;while((m=y<<1|p)===(E=(g>=f)<<1|h>=d));return o[E]=i,o[m]=s,e}function ww(e){var t,n,r=e.length,o,i,s=new Array(r),a=new Array(r),c=1/0,l=1/0,u=-1/0,d=-1/0;for(n=0;n<r;++n)isNaN(o=+this._x.call(null,t=e[n]))||isNaN(i=+this._y.call(null,t))||(s[n]=o,a[n]=i,o<c&&(c=o),o>u&&(u=o),i<l&&(l=i),i>d&&(d=i));if(c>u||l>d)return this;for(this.cover(c,l).cover(u,d),n=0;n<r;++n)Ya(this,s[n],a[n],e[n]);return this}function vw(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,o=this._x1,i=this._y1;if(isNaN(n))o=(n=Math.floor(e))+1,i=(r=Math.floor(t))+1;else{for(var s=o-n||1,a=this._root,c,l;n>e||e>=o||r>t||t>=i;)switch(l=(t<r)<<1|e<n,c=new Array(4),c[l]=a,a=c,s*=2,l){case 0:o=n+s,i=r+s;break;case 1:n=o-s,i=r+s;break;case 2:o=n+s,r=i-s;break;case 3:n=o-s,r=i-s;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=r,this._x1=o,this._y1=i,this}function bw(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function Ew(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function ae(e,t,n,r,o){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=o}function _w(e,t,n){var r,o=this._x0,i=this._y0,s,a,c,l,u=this._x1,d=this._y1,f=[],h=this._root,g,p;for(h&&f.push(new ae(h,o,i,u,d)),n==null?n=1/0:(o=e-n,i=t-n,u=e+n,d=t+n,n*=n);g=f.pop();)if(!(!(h=g.node)||(s=g.x0)>u||(a=g.y0)>d||(c=g.x1)<o||(l=g.y1)<i))if(h.length){var y=(s+c)/2,m=(a+l)/2;f.push(new ae(h[3],y,m,c,l),new ae(h[2],s,m,y,l),new ae(h[1],y,a,c,m),new ae(h[0],s,a,y,m)),(p=(t>=m)<<1|e>=y)&&(g=f[f.length-1],f[f.length-1]=f[f.length-1-p],f[f.length-1-p]=g)}else{var E=e-+this._x.call(null,h.data),x=t-+this._y.call(null,h.data),w=E*E+x*x;if(w<n){var C=Math.sqrt(n=w);o=e-C,i=t-C,u=e+C,d=t+C,r=h.data}}return r}function Nw(e){if(isNaN(u=+this._x.call(null,e))||isNaN(d=+this._y.call(null,e)))return this;var t,n=this._root,r,o,i,s=this._x0,a=this._y0,c=this._x1,l=this._y1,u,d,f,h,g,p,y,m;if(!n)return this;if(n.length)for(;;){if((g=u>=(f=(s+c)/2))?s=f:c=f,(p=d>=(h=(a+l)/2))?a=h:l=h,t=n,!(n=n[y=p<<1|g]))return this;if(!n.length)break;(t[y+1&3]||t[y+2&3]||t[y+3&3])&&(r=t,m=y)}for(;n.data!==e;)if(o=n,!(n=n.next))return this;return(i=n.next)&&delete n.next,o?(i?o.next=i:delete o.next,this):t?(i?t[y]=i:delete t[y],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[m]=n:this._root=n),this):(this._root=i,this)}function Cw(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function Sw(){return this._root}function kw(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function Mw(e){var t=[],n,r=this._root,o,i,s,a,c;for(r&&t.push(new ae(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,i=n.x0,s=n.y0,a=n.x1,c=n.y1)&&r.length){var l=(i+a)/2,u=(s+c)/2;(o=r[3])&&t.push(new ae(o,l,u,a,c)),(o=r[2])&&t.push(new ae(o,i,u,l,c)),(o=r[1])&&t.push(new ae(o,l,s,a,u)),(o=r[0])&&t.push(new ae(o,i,s,l,u))}return this}function Iw(e){var t=[],n=[],r;for(this._root&&t.push(new ae(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var o=r.node;if(o.length){var i,s=r.x0,a=r.y0,c=r.x1,l=r.y1,u=(s+c)/2,d=(a+l)/2;(i=o[0])&&t.push(new ae(i,s,a,u,d)),(i=o[1])&&t.push(new ae(i,u,a,c,d)),(i=o[2])&&t.push(new ae(i,s,d,u,l)),(i=o[3])&&t.push(new ae(i,u,d,c,l))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function $w(e){return e[0]}function Aw(e){return arguments.length?(this._x=e,this):this._x}function Pw(e){return e[1]}function Tw(e){return arguments.length?(this._y=e,this):this._y}function jr(e,t,n){var r=new Lr(t??$w,n??Pw,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function Lr(e,t,n,r,o,i){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=o,this._y1=i,this._root=void 0}function yi(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var ce=jr.prototype=Lr.prototype;ce.copy=function(){var e=new Lr(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=yi(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var o=0;o<4;++o)(r=t.source[o])&&(r.length?n.push({source:r,target:t.target[o]=new Array(4)}):t.target[o]=yi(r));return e};ce.add=xw;ce.addAll=ww;ce.cover=vw;ce.data=bw;ce.extent=Ew;ce.find=_w;ce.remove=Nw;ce.removeAll=Cw;ce.root=Sw;ce.size=kw;ce.visit=Mw;ce.visitAfter=Iw;ce.x=Aw;ce.y=Tw;function ye(e){return function(){return e}}function Te(e){return(e()-.5)*1e-6}function Ow(e){return e.x+e.vx}function jw(e){return e.y+e.vy}function Lw(e){var t,n,r,o=1,i=1;typeof e!="function"&&(e=ye(e==null?1:+e));function s(){for(var l,u=t.length,d,f,h,g,p,y,m=0;m<i;++m)for(d=jr(t,Ow,jw).visitAfter(a),l=0;l<u;++l)f=t[l],p=n[f.index],y=p*p,h=f.x+f.vx,g=f.y+f.vy,d.visit(E);function E(x,w,C,I,N){var T=x.data,O=x.r,j=p+O;if(T){if(T.index>f.index){var z=h-T.x-T.vx,R=g-T.y-T.vy,L=z*z+R*R;L<j*j&&(z===0&&(z=Te(r),L+=z*z),R===0&&(R=Te(r),L+=R*R),L=(j-(L=Math.sqrt(L)))/L*o,f.vx+=(z*=L)*(j=(O*=O)/(y+O)),f.vy+=(R*=L)*j,T.vx-=z*(j=1-j),T.vy-=R*j)}return}return w>h+j||I<h-j||C>g+j||N<g-j}}function a(l){if(l.data)return l.r=n[l.data.index];for(var u=l.r=0;u<4;++u)l[u]&&l[u].r>l.r&&(l.r=l[u].r)}function c(){if(t){var l,u=t.length,d;for(n=new Array(u),l=0;l<u;++l)d=t[l],n[d.index]=+e(d,l,t)}}return s.initialize=function(l,u){t=l,r=u,c()},s.iterations=function(l){return arguments.length?(i=+l,s):i},s.strength=function(l){return arguments.length?(o=+l,s):o},s.radius=function(l){return arguments.length?(e=typeof l=="function"?l:ye(+l),c(),s):e},s}function Rw(e){return e.index}function xi(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function Dw(e){var t=Rw,n=d,r,o=ye(30),i,s,a,c,l,u=1;e==null&&(e=[]);function d(y){return 1/Math.min(a[y.source.index],a[y.target.index])}function f(y){for(var m=0,E=e.length;m<u;++m)for(var x=0,w,C,I,N,T,O,j;x<E;++x)w=e[x],C=w.source,I=w.target,N=I.x+I.vx-C.x-C.vx||Te(l),T=I.y+I.vy-C.y-C.vy||Te(l),O=Math.sqrt(N*N+T*T),O=(O-i[x])/O*y*r[x],N*=O,T*=O,I.vx-=N*(j=c[x]),I.vy-=T*j,C.vx+=N*(j=1-j),C.vy+=T*j}function h(){if(s){var y,m=s.length,E=e.length,x=new Map(s.map((C,I)=>[t(C,I,s),C])),w;for(y=0,a=new Array(m);y<E;++y)w=e[y],w.index=y,typeof w.source!="object"&&(w.source=xi(x,w.source)),typeof w.target!="object"&&(w.target=xi(x,w.target)),a[w.source.index]=(a[w.source.index]||0)+1,a[w.target.index]=(a[w.target.index]||0)+1;for(y=0,c=new Array(E);y<E;++y)w=e[y],c[y]=a[w.source.index]/(a[w.source.index]+a[w.target.index]);r=new Array(E),g(),i=new Array(E),p()}}function g(){if(s)for(var y=0,m=e.length;y<m;++y)r[y]=+n(e[y],y,e)}function p(){if(s)for(var y=0,m=e.length;y<m;++y)i[y]=+o(e[y],y,e)}return f.initialize=function(y,m){s=y,l=m,h()},f.links=function(y){return arguments.length?(e=y,h(),f):e},f.id=function(y){return arguments.length?(t=y,f):t},f.iterations=function(y){return arguments.length?(u=+y,f):u},f.strength=function(y){return arguments.length?(n=typeof y=="function"?y:ye(+y),g(),f):n},f.distance=function(y){return arguments.length?(o=typeof y=="function"?y:ye(+y),p(),f):o},f}const zw=1664525,Bw=1013904223,wi=4294967296;function Hw(){let e=1;return()=>(e=(zw*e+Bw)%wi)/wi}function Vw(e){return e.x}function Fw(e){return e.y}var Yw=10,Xw=Math.PI*(3-Math.sqrt(5));function Gw(e){var t,n=1,r=.001,o=1-Math.pow(r,1/300),i=0,s=.6,a=new Map,c=wr(d),l=St("tick","end"),u=Hw();e==null&&(e=[]);function d(){f(),l.call("tick",t),n<r&&(c.stop(),l.call("end",t))}function f(p){var y,m=e.length,E;p===void 0&&(p=1);for(var x=0;x<p;++x)for(n+=(i-n)*o,a.forEach(function(w){w(n)}),y=0;y<m;++y)E=e[y],E.fx==null?E.x+=E.vx*=s:(E.x=E.fx,E.vx=0),E.fy==null?E.y+=E.vy*=s:(E.y=E.fy,E.vy=0);return t}function h(){for(var p=0,y=e.length,m;p<y;++p){if(m=e[p],m.index=p,m.fx!=null&&(m.x=m.fx),m.fy!=null&&(m.y=m.fy),isNaN(m.x)||isNaN(m.y)){var E=Yw*Math.sqrt(.5+p),x=p*Xw;m.x=E*Math.cos(x),m.y=E*Math.sin(x)}(isNaN(m.vx)||isNaN(m.vy))&&(m.vx=m.vy=0)}}function g(p){return p.initialize&&p.initialize(e,u),p}return h(),t={tick:f,restart:function(){return c.restart(d),t},stop:function(){return c.stop(),t},nodes:function(p){return arguments.length?(e=p,h(),a.forEach(g),t):e},alpha:function(p){return arguments.length?(n=+p,t):n},alphaMin:function(p){return arguments.length?(r=+p,t):r},alphaDecay:function(p){return arguments.length?(o=+p,t):+o},alphaTarget:function(p){return arguments.length?(i=+p,t):i},velocityDecay:function(p){return arguments.length?(s=1-p,t):1-s},randomSource:function(p){return arguments.length?(u=p,a.forEach(g),t):u},force:function(p,y){return arguments.length>1?(y==null?a.delete(p):a.set(p,g(y)),t):a.get(p)},find:function(p,y,m){var E=0,x=e.length,w,C,I,N,T;for(m==null?m=1/0:m*=m,E=0;E<x;++E)N=e[E],w=p-N.x,C=y-N.y,I=w*w+C*C,I<m&&(T=N,m=I);return T},on:function(p,y){return arguments.length>1?(l.on(p,y),t):l.on(p)}}}function Ww(){var e,t,n,r,o=ye(-30),i,s=1,a=1/0,c=.81;function l(h){var g,p=e.length,y=jr(e,Vw,Fw).visitAfter(d);for(r=h,g=0;g<p;++g)t=e[g],y.visit(f)}function u(){if(e){var h,g=e.length,p;for(i=new Array(g),h=0;h<g;++h)p=e[h],i[p.index]=+o(p,h,e)}}function d(h){var g=0,p,y,m=0,E,x,w;if(h.length){for(E=x=w=0;w<4;++w)(p=h[w])&&(y=Math.abs(p.value))&&(g+=p.value,m+=y,E+=y*p.x,x+=y*p.y);h.x=E/m,h.y=x/m}else{p=h,p.x=p.data.x,p.y=p.data.y;do g+=i[p.data.index];while(p=p.next)}h.value=g}function f(h,g,p,y){if(!h.value)return!0;var m=h.x-t.x,E=h.y-t.y,x=y-g,w=m*m+E*E;if(x*x/c<w)return w<a&&(m===0&&(m=Te(n),w+=m*m),E===0&&(E=Te(n),w+=E*E),w<s&&(w=Math.sqrt(s*w)),t.vx+=m*h.value*r/w,t.vy+=E*h.value*r/w),!0;if(h.length||w>=a)return;(h.data!==t||h.next)&&(m===0&&(m=Te(n),w+=m*m),E===0&&(E=Te(n),w+=E*E),w<s&&(w=Math.sqrt(s*w)));do h.data!==t&&(x=i[h.data.index]*r/w,t.vx+=m*x,t.vy+=E*x);while(h=h.next)}return l.initialize=function(h,g){e=h,n=g,u()},l.strength=function(h){return arguments.length?(o=typeof h=="function"?h:ye(+h),u(),l):o},l.distanceMin=function(h){return arguments.length?(s=h*h,l):Math.sqrt(s)},l.distanceMax=function(h){return arguments.length?(a=h*h,l):Math.sqrt(a)},l.theta=function(h){return arguments.length?(c=h*h,l):Math.sqrt(c)},l}function qw(e){var t=ye(.1),n,r,o;typeof e!="function"&&(e=ye(e==null?0:+e));function i(a){for(var c=0,l=n.length,u;c<l;++c)u=n[c],u.vy+=(o[c]-u.y)*r[c]*a}function s(){if(n){var a,c=n.length;for(r=new Array(c),o=new Array(c),a=0;a<c;++a)r[a]=isNaN(o[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return i.initialize=function(a){n=a,s()},i.strength=function(a){return arguments.length?(t=typeof a=="function"?a:ye(+a),s(),i):t},i.y=function(a){return arguments.length?(e=typeof a=="function"?a:ye(+a),s(),i):e},i}const Kw=-80,Uw=80,Zw=40,Qw=e=>{const{manyBodyStrength:t=Kw,linkDistance:n=Uw,collisionOffset:r=Zw}=e||{},o=(s,a)=>{const c=s.map(({id:u,x:d=0,y:f=0})=>({id:u,x:d,y:f})),l=a.filter(({source:u,target:d})=>u.id!=d.id).map(({source:u,target:d})=>({source:s.findIndex(f=>f.id==u.id),target:s.findIndex(f=>f.id==d.id)})).filter(({source:u,target:d})=>u>=0&&d>=0);return[c,l]};return{name:"ForceLayout",layout:s=>{const{nodes:a,edges:c}=s;if(a.length==0)return[];const[l,u]=o(a,c),d=Gw(l).force("charge",Ww().strength(t)).force("center",yw(300,300)).force("collision",Lw(({id:f})=>{const h=a.find(y=>y.id==f),{width:g=0,height:p=0}=h||{};return Math.sqrt(g**2+p**2)/2+r})).force("link",Dw(u).distance(n)).force("y",qw(60));return d.tick(100),d.nodes().map(({id:f,x:h,y:g})=>{const p=a.find(y=>y.id==f);return p&&{...p,x:(h||0)-(p.width||0)/2,y:(g||0)-(p.height||0)/2}}).filter(f=>!!f)}}},Jw=e=>{const t=[];e.forEach(n=>{const r=t.find(o=>o.has(n.source.id)||o.has(n.target.id));r?(r.add(n.source.id),r.add(n.target.id)):t.push(new Set([n.source.id,n.target.id]))});for(let n=t.length-1;n>0;n-=1){const r=t[n];for(let o=0;o<n;o+=1){const i=t[o];if([...r].some(s=>i.has(s))){r.forEach(s=>i.add(s)),t.splice(n,1);break}}}return t.map(n=>[...e.filter(r=>n.has(r.source.id)||n.has(r.target.id))])},vi=e=>{const{nodes:t,edges:n}=e,r=t.map(c=>{const{id:l,position:u,data:d}=c;return{id:l,x:u.x,y:u.y,width:d.width,height:d.height}}),o=n.map(c=>({source:{id:c.source},target:{id:c.target}})),i=c=>!!o.find(l=>l.source.id==c.id||l.target.id==c.id),s=Jw(o).map(c=>({nodes:r.filter(l=>c.some(u=>u.source.id==l.id||u.target.id==l.id)),edges:c})).map(({nodes:c,edges:l})=>({nodes:Qw().layout({nodes:c,edges:l}),edges:l}));s.push({nodes:mw({direction:"LR"}).layout({nodes:r.filter(c=>!i(c)),edges:[]}),edges:[]});let a=0;return s.forEach(({nodes:c})=>{const l=Math.min(...c.map(({x:f=0})=>f)),u=Math.min(...c.map(({y:f=0})=>f)),d=Math.max(...c.map(({y:f=0,height:h=0})=>f+h));c.forEach(f=>{f.x=(f.x||0)-l,f.y=(f.y||0)-u+a}),a=a+(d-u)+80}),s.flatMap(c=>c.nodes.map(l=>{const u=t.find(d=>d.id==l.id);return u&&(u.position={x:l.x||0,y:l.y||0}),u}).filter(l=>!!l))};const e1=e=>{const{initialEntities:t=[],selection:n=[],onSelectionChange:r}=e,o=vn(),[i,s,a]=Pp([]),[c,l,u]=Tp([]),[d,f]=A.useState(!1);return Op({onChange:A.useCallback(({nodes:h})=>{r==null||r(h.map(g=>g.data.entity))},[])}),A.useEffect(()=>{const h=[],g=[];t.forEach(p=>{const{id:y=""}=p;if(!h.find(m=>m.id===y)){const m={id:y,position:{x:0,y:0},type:"turbo",data:{entity:p}},E=i.find(x=>x.id===y);E&&(m.position=E.position,m.data.width=E.data.width,m.data.height=E.data.height),h.push(m)}}),t.forEach(p=>{const{id:y="",properties:m=[],relations:E=[]}=p;[...m,...E].forEach(({aliasName:w,types:C})=>{C==null||C.forEach(I=>{const N=t.find(T=>T.name==I);if(N!=null&&N.id){const T=`edge__${y}__${N.id}`,O=g.find(j=>j.id==T);O?O.label=`${O.label}、${w}`:g.push({id:`edge__${y}__${N.id}`,source:`${y}`,target:N.id,label:`${w}`})}})})}),s(vi({nodes:h,edges:g})),l([...g])},[t]),A.useEffect(()=>{let h=!1;const g=i.map(p=>p.measured&&(p.measured.width!=p.data.width||p.measured.height!=p.data.height)?(h=!0,{...p,data:{...p.data,width:p.measured.width,height:p.measured.height}}):p);h&&(s(vi({nodes:g,edges:c})),f(!0))},[i]),A.useEffect(()=>{d&&o&&i.forEach(h=>{const g=!!n.find(p=>p.id===h.id);h.selected!==g&&o.updateNode(h.id,{selected:g})})},[d,o,n]),A.useEffect(()=>{d&&o&&o.fitView({nodes:i.map(({id:h})=>({id:h}))}).then(h=>h)},[d,o]),b.jsx("div",{className:"schema-diagram",children:b.jsx("div",{className:"turbo-container",children:b.jsxs(kp,{nodes:i,edges:c,onNodesChange:a,onEdgesChange:u,connectionMode:Ve.Loose,fitView:!1,nodeTypes:{turbo:h0},edgeTypes:{turbo:y0},defaultEdgeOptions:{type:"turbo",markerStart:"edge-circle",markerEnd:"edge-arrowhead"},children:[b.jsx(zp,{}),b.jsx(Gp,{showInteractive:!0,position:"top-left"}),b.jsx("svg",{children:b.jsxs("defs",{children:[b.jsxs("linearGradient",{id:"edge-gradient",children:[b.jsx("stop",{offset:"0%",stopColor:"#ae53ba"}),b.jsx("stop",{offset:"100%",stopColor:"#2a8af6"})]}),b.jsx("marker",{id:"edge-circle",viewBox:"-5 -5 10 10",refX:"0",refY:"0",markerUnits:"strokeWidth",markerWidth:"10",markerHeight:"10",orient:"auto",children:b.jsx("circle",{stroke:"#2a8af6",strokeOpacity:"0.75",r:"2",cx:"0",cy:"0"})}),b.jsx("marker",{id:"edge-arrowhead",className:"react-flow__arrowhead",markerWidth:"16",markerHeight:"16",viewBox:"-10 -10 20 20",markerUnits:"strokeWidth",orient:"auto-start-reverse",refX:"0",refY:"0",children:b.jsx("polyline",{strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4",style:{stroke:"#a853ba",strokeWidth:1}})})]})})]})})})},t1=e=>b.jsx(sa,{children:b.jsx(e1,{...e})}),Xa="/openspg/api",gr=({name:e,aliasName:t,types:n,properties:r},o,i="")=>{const s={id:`${i}${o}`,name:e,aliasName:t,types:n};return r==null||r.forEach(({name:a,value:c,children:l=[]})=>{a==="desc"&&c?s.desc=c.trim():a==="index"&&c?s.index=c.trim():a==="hypernymPredicate"&&c?s.hypernymPredicate=c.trim():a==="regular"&&c?s.regular=c.trim():a==="spreadable"&&typeof c<"u"?s.spreadable=c.trim():a==="autoRelate"&&c?s.autoRelate=c.trim():a==="properties"&&(l==null?void 0:l.length)>0?s.properties=l.map((u,d)=>gr(u,d,`${s.id}_`)):a==="relations"&&(l==null?void 0:l.length)>0&&(s.relations=l.map((u,d)=>gr(u,d,`${s.id}_`)))}),s},n1=async()=>{const t=await(await fetch(`${Xa}/schema/fetch`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})})).json(),{namespace:n={},entities:r=[]}=(t==null?void 0:t.data)||{};return Promise.resolve({namespace:{value:n.value},entities:r.map((o,i)=>gr(o,i,"schema-")).filter(o=>o)})},r1=async e=>{const n=await(await fetch(`${Xa}/schema/focus`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e.map(({id:r})=>({id:r})))})).json();return Promise.resolve(n.code===0)},o1=async()=>{const t=await(await fetch("/schema-theme.css")).text();return Promise.resolve(t)},qn={requestSchema:n1,activateEntities:r1,requestCss:o1},i1={"diagram-container":"_diagram-container_k23br_1"},d1=()=>{const[e,t]=A.useState([]),[n,r]=A.useState(),[o,i]=A.useState(0),s=Uc(o,500),[a,c]=A.useState(""),l=()=>{qn.requestSchema().then(({entities:h=[]})=>{t([...h])})},u=A.useCallback(()=>{qn.requestCss().then(h=>{c(h)})},[]),d=A.useCallback(()=>{i(new Date().getTime())},[]),f=A.useCallback(()=>{const h=e.filter(g=>g.name===window.activeEntityName);r([...h])},[e]);return A.useEffect(()=>{s>0&&l()},[s]),A.useEffect(()=>{l()},[]),b.jsxs(b.Fragment,{children:[b.jsxs("div",{style:{display:"none"},"aria-label":"toolbar for interactive",children:[b.jsx("a",{id:"schema-diagram-refresh-css-button",onClick:()=>u,children:"refresh css"}),b.jsx("a",{id:"schema-diagram-refresh-button",onClick:()=>d(),children:"refresh schema"}),b.jsx("a",{id:"schema-diagram-active-entity-button",onClick:()=>f(),children:"activate entity"})]}),b.jsx("div",{className:i1.diagramContainer,children:b.jsx(t1,{initialEntities:e,selection:n,onSelectionChange:h=>{r(h),qn.activateEntities(h).then(()=>{console.log("activate entities success")})}})}),b.jsx("style",{children:a})]})};export{d1 as default};
